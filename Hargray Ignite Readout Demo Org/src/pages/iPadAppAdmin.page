<apex:page standardController="iPadAppMaker__c" extensions="iPadAppAdminExt" standardStylesheets="false" sidebar="false" cache="false">
  <head>
      <title>iPad App Admin</title>
      <script src="../../soap/ajax/20.0/connection.js" type="text/javascript"></script>
      <script type="text/javascript" src="{!$Resource.jsLibs}/jquery-1.5.2.min.js"></script>
      
      <script type="text/javascript" src="{!$Resource.jsLibs}/farbtastic/farbtastic.js"></script>
      <link rel="stylesheet" href="{!$Resource.jsLibs}/farbtastic/farbtastic.css" type="text/css" />

      <script type='text/javascript'>
          //var base64content;
          
          var base64content_11;
          var base64content_12;
          var base64content_21;
          var base64content_22;
          var base64content_31;
          var base64content_32;
          var base64content_41;
          var base64content_42;
          var base64content_51;
          var base64content_52;
          
          sforce.connection.sessionId = "{!$Api.Session_ID}";
          
          
          var colorPicker1;
          var colorPicker2;
          var colorPicker3;
          var colorPicker4;
          var color1 = '#{!header_color_start}';
          var color2 ='#{!header_color_end}';
            
          $(document).ready(function(){
              /*
              var dropbox = document.getElementById("dropbox");
     
              // init event handlers
              dropbox.addEventListener("dragenter", dragEnter, false);
              dropbox.addEventListener("dragleave", dragLeave, false);
              dropbox.addEventListener("dragover", dragOver, false);
              dropbox.addEventListener("drop", drop, false);
              */
              
              
              window.addEventListener('dragover', function(evt){
                  evt.stopPropagation();
                  evt.preventDefault();
              }, false);
              
              
              /* dropbox_icon init */
              var dropbox_icon = document.getElementById("dropbox_icon");
     
              // init event handlers
              dropbox_icon.addEventListener("dragenter", function(e){dragEnter(e, 'icon');}, false);
              dropbox_icon.addEventListener("dragleave", function(e){dragLeave(e, 'icon');}, false);
              dropbox_icon.addEventListener("dragover", function(e){dragOver(e, 'icon');}, false);
              dropbox_icon.addEventListener("drop", function(e){drop(e, 'icon');}, false);
              
              /* dropbox_logo init */
              var dropbox_logo = document.getElementById("dropbox_logo");
     
              // init event handlers
              dropbox_logo.addEventListener("dragenter", function(e){dragEnter(e, 'logo');}, false);
              dropbox_logo.addEventListener("dragleave", function(e){dragLeave(e, 'logo');}, false);
              dropbox_logo.addEventListener("dragover", function(e){dragOver(e, 'logo');}, false);
              dropbox_logo.addEventListener("drop", function(e){drop(e, 'logo');}, false);
              
              
              /* dropbox_11 init */
              var dropbox_11 = document.getElementById("dropbox_11");
     
              // init event handlers
              dropbox_11.addEventListener("dragenter", function(e){dragEnter(e, 11);}, false);
              dropbox_11.addEventListener("dragleave", function(e){dragLeave(e,11);}, false);
              dropbox_11.addEventListener("dragover", function(e){dragOver(e,11);}, false);
              dropbox_11.addEventListener("drop", function(e){drop(e,11);}, false);
              
              /* dropbox_12 init */
              var dropbox_12 = document.getElementById("dropbox_12");
     
              // init event handlers
              dropbox_12.addEventListener("dragenter", function(e){dragEnter(e, 12);}, false);
              dropbox_12.addEventListener("dragleave", function(e){dragLeave(e,12);}, false);
              dropbox_12.addEventListener("dragover", function(e){dragOver(e,12);}, false);
              dropbox_12.addEventListener("drop", function(e){drop(e,12);}, false);
              
              /* dropbox_13 init */
              var dropbox_13 = document.getElementById("dropbox_13");
     
              // init event handlers
              dropbox_13.addEventListener("dragenter", function(e){dragEnter(e, 13);}, false);
              dropbox_13.addEventListener("dragleave", function(e){dragLeave(e,13);}, false);
              dropbox_13.addEventListener("dragover", function(e){dragOver(e,13);}, false);
              dropbox_13.addEventListener("drop", function(e){drop(e,13);}, false);              
              
              /* dropbox_21 init */
              var dropbox_21 = document.getElementById("dropbox_21");
     
              // init event handlers
              dropbox_21.addEventListener("dragenter", function(e){dragEnter(e, 21);}, false);
              dropbox_21.addEventListener("dragleave", function(e){dragLeave(e,21);}, false);
              dropbox_21.addEventListener("dragover", function(e){dragOver(e,21);}, false);
              dropbox_21.addEventListener("drop", function(e){drop(e,21);}, false);
              
              /* dropbox_22 init */
              var dropbox_22 = document.getElementById("dropbox_22");
     
              // init event handlers
              dropbox_22.addEventListener("dragenter", function(e){dragEnter(e, 22);}, false);
              dropbox_22.addEventListener("dragleave", function(e){dragLeave(e,22);}, false);
              dropbox_22.addEventListener("dragover", function(e){dragOver(e,22);}, false);
              dropbox_22.addEventListener("drop", function(e){drop(e,22);}, false);
              
              /* dropbox_23 init */
              var dropbox_23 = document.getElementById("dropbox_23");
     
              // init event handlers
              dropbox_23.addEventListener("dragenter", function(e){dragEnter(e, 23);}, false);
              dropbox_23.addEventListener("dragleave", function(e){dragLeave(e,23);}, false);
              dropbox_23.addEventListener("dragover", function(e){dragOver(e,23);}, false);
              dropbox_23.addEventListener("drop", function(e){drop(e,23);}, false);
              
              /* dropbox_31 init */
              var dropbox_31 = document.getElementById("dropbox_31");
     
              // init event handlers
              dropbox_31.addEventListener("dragenter", function(e){dragEnter(e, 31);}, false);
              dropbox_31.addEventListener("dragleave", function(e){dragLeave(e,31);}, false);
              dropbox_31.addEventListener("dragover", function(e){dragOver(e,31);}, false);
              dropbox_31.addEventListener("drop", function(e){drop(e,31);}, false);
              
              /* dropbox_32 init */
              var dropbox_32 = document.getElementById("dropbox_32");
     
              // init event handlers
              dropbox_32.addEventListener("dragenter", function(e){dragEnter(e, 32);}, false);
              dropbox_32.addEventListener("dragleave", function(e){dragLeave(e,32);}, false);
              dropbox_32.addEventListener("dragover", function(e){dragOver(e,32);}, false);
              dropbox_32.addEventListener("drop", function(e){drop(e,32);}, false);
              
              /* dropbox_33 init */
              var dropbox_33 = document.getElementById("dropbox_33");
     
              // init event handlers
              dropbox_33.addEventListener("dragenter", function(e){dragEnter(e, 33);}, false);
              dropbox_33.addEventListener("dragleave", function(e){dragLeave(e,33);}, false);
              dropbox_33.addEventListener("dragover", function(e){dragOver(e,33);}, false);
              dropbox_33.addEventListener("drop", function(e){drop(e,33);}, false);
              
              /* dropbox_41 init */
              var dropbox_41 = document.getElementById("dropbox_41");
     
              // init event handlers
              dropbox_41.addEventListener("dragenter", function(e){dragEnter(e, 41);}, false);
              dropbox_41.addEventListener("dragleave", function(e){dragLeave(e,41);}, false);
              dropbox_41.addEventListener("dragover", function(e){dragOver(e,41);}, false);
              dropbox_41.addEventListener("drop", function(e){drop(e,41);}, false);
              
              /* dropbox_42 init */
              var dropbox_42 = document.getElementById("dropbox_42");
     
              // init event handlers
              dropbox_42.addEventListener("dragenter", function(e){dragEnter(e, 42);}, false);
              dropbox_42.addEventListener("dragleave", function(e){dragLeave(e,42);}, false);
              dropbox_42.addEventListener("dragover", function(e){dragOver(e,42);}, false);
              dropbox_42.addEventListener("drop", function(e){drop(e,42);}, false);
              
              /* dropbox_43 init */
              var dropbox_43 = document.getElementById("dropbox_43");
     
              // init event handlers
              dropbox_43.addEventListener("dragenter", function(e){dragEnter(e, 43);}, false);
              dropbox_43.addEventListener("dragleave", function(e){dragLeave(e,43);}, false);
              dropbox_43.addEventListener("dragover", function(e){dragOver(e,43);}, false);
              dropbox_43.addEventListener("drop", function(e){drop(e,43);}, false);
              
              /* dropbox_51 init */
              var dropbox_51 = document.getElementById("dropbox_51");
     
              // init event handlers
              dropbox_51.addEventListener("dragenter", function(e){dragEnter(e, 51);}, false);
              dropbox_51.addEventListener("dragleave", function(e){dragLeave(e,51);}, false);
              dropbox_51.addEventListener("dragover", function(e){dragOver(e,51);}, false);
              dropbox_51.addEventListener("drop", function(e){drop(e,51);}, false);
              
              /* dropbox_52 init */
              var dropbox_52 = document.getElementById("dropbox_52");
     
              // init event handlers
              dropbox_52.addEventListener("dragenter", function(e){dragEnter(e, 52);}, false);
              dropbox_52.addEventListener("dragleave", function(e){dragLeave(e,52);}, false);
              dropbox_52.addEventListener("dragover", function(e){dragOver(e,52);}, false);
              dropbox_52.addEventListener("drop", function(e){drop(e,52);}, false);
              
              /* dropbox_53 init */
              var dropbox_53 = document.getElementById("dropbox_53");
     
              // init event handlers
              dropbox_53.addEventListener("dragenter", function(e){dragEnter(e, 53);}, false);
              dropbox_53.addEventListener("dragleave", function(e){dragLeave(e,53);}, false);
              dropbox_53.addEventListener("dragover", function(e){dragOver(e,53);}, false);
              dropbox_53.addEventListener("drop", function(e){drop(e,53);}, false);
              
              $(document).find('img').mousedown(function(e){
                  return false;
              });
              
              colorPicker1 = $.farbtastic('#picker1','#color1');
              $('#picker1').mouseup(function(){updateGradient();});
              $('#color1').change(function(){updateGradient();});
			  $('#picker1').hide();
			  $('#color1').blur(function(){$('#picker1').hide();});
			  $('#color1').focus(function(){$('#picker1').show();});
			  
			  colorPicker2 = $.farbtastic('#picker2','#color2');
			  $('#picker2').mouseup(function(){updateGradient();});
			  $('#color2').change(function(){updateGradient();});
			  $('#picker2').hide();
			  $('#color2').blur(function(){$('#picker2').hide();});
			  $('#color2').focus(function(){$('#picker2').show();});
			  
			  colorPicker3 = $.farbtastic('#picker3','#color3');
			  $('#picker3').mouseup(function(){updateSidebarBg()});
			  $('#color3').change(function(){updateSidebarBg()});
			  $('#picker3').hide();
			  $('#color3').blur(function(){$('#picker3').hide();});
			  $('#color3').focus(function(){$('#picker3').show();});
			  
			  colorPicker4 = $.farbtastic('#picker4','#color4');
			  $('#picker4').mouseup(function(){updateContentBg()});
			  $('#color4').change(function(){updateContentBg()});
			  $('#picker4').hide();
			  $('#color4').blur(function(){$('#picker4').hide();});
			  $('#color4').focus(function(){$('#picker4').show();});
              
              updateGradient();
              $("#logo_label").focus();
              
              if( $('.youtube_enabled_checkbox')[0].checked ){
              	$('#youtube_config').show();
              	manageYoutubeSubContent();
              }
          });
          
          function dragEnter(evt, id){
              evt.stopPropagation();
              evt.preventDefault();
              
              document.getElementById("dropbox_" + id).style.backgroundColor = '#595959';
              
              
          }
          function dragLeave(evt, id){
              evt.stopPropagation();
              evt.preventDefault();
              
              document.getElementById("dropbox_" + id).style.backgroundColor = '#c1c1c1';
          }
          function dragOver(evt, id){
              evt.stopPropagation();
              evt.preventDefault();
          }
          function drop(evt, id){
              evt.stopPropagation();
              evt.preventDefault();
              
              document.getElementById("dropbox_" + id).style.backgroundColor = '#56c1ff';
              document.getElementById("dropbox_" + id).innerHTML = "Uploading document...";
              
              var files = evt.dataTransfer.files;
              var count = files.length;
                 
              // Only call the handler if 1 or more files was dropped.
              if (count > 0)
                  handleFiles(files, id);
          }
          
          function handleFiles(files, id){
              var file = files[0];            
              var reader = new FileReader();
             
              // init the reader event handlers
              reader.onloadend = function(e){handleReaderLoadEnd(e, id, file.name);};
             
              // begin the read operation
              reader.readAsDataURL(file);
              
              
          }
          
          function handleReaderLoadEnd(evt, id, fileName){
              var img = document.getElementById("preview_" + id);
              img.src = evt.target.result;
              
              uploadDocAndUpdate(id, evt.target.result, fileName);           
              //base64content.value = evt.target.result.split(',')[1];
          }
          
          
          function uploadDocAndUpdate(tagId, content, fileName){
            var newRecords = [];

            var newDocument = new sforce.SObject("Document");
            newDocument.Body = content.split(',')[1];
            newDocument.Name = fileName;                 
            newDocument.FolderId = '{!$User.Id}';
            newDocument.IsPublic = 'true';
            newDocument.ContentType = content.split(',')[0].split(';')[0].split(':')[1];
            
            newRecords.push(newDocument);
            
            sforce.connection.create(newRecords, {onSuccess: function(res){creaSuccess(res, tagId)}, onFailure: handleFailure});        
         }
         
         
         function creaSuccess(result, tagId){
             //alert('Creation Successful!');
             
             document.getElementById("dropbox_" + tagId).innerHTML = "Updating iPad App...";
                                       
             var docUrl = "https://" + window.location.hostname + "/servlet/servlet.ImageServer?id=" + result[0].id + "&oid={!$Organization.id}";
             sforce.connection.query(
                 "SELECT Id, content_1__c, content_2__c, content_3__c, content_4__c, content_5__c, content_bg_color__c, hd_bg_color_end__c, hd_text_color__c, hd_bg_color_start__c, Name, logo_url__c, sidebar_bg_color__c, sidebar_button_1__c, sidebar_button_2__c, sidebar_button_4__c, sidebar_button_3__c, sidebar_button_5__c, sidebar_position__c FROM iPadAppMaker__c WHERE Id = '{!$CurrentPage.parameters.Id}'",
                 {onSuccess: function(res){querySuccess(res, tagId, docUrl)}, onFailure: queryFailure});
         }
         
         
         function querySuccess(queryResult, tagId, docUrl){
             var records = queryResult.getArray('records');
             for(i in records){
                 switch(tagId){
                 case 11:
                    records[i].sidebar_button_1__c = docUrl;
                    break;
                 case 12:
                     records[i].content_1__c = docUrl;
                     break;
                 case 13:
                 	records[i].sub_content_1__c = docUrl;
                 	break;
                 case 21:
                     records[i].sidebar_button_2__c = docUrl;
                     break;
                 case 22:
                     records[i].content_2__c = docUrl;
                     break;
                 case 23:
                     records[i].sub_content_2__c = docUrl;
                     break;
                 case 31:
                     records[i].sidebar_button_3__c = docUrl;
                     break;
                 case 32:
                     records[i].content_3__c = docUrl;
                     break;
                 case 33:
                     records[i].sub_content_3__c = docUrl;
                     break;
                 case 41:
                     records[i].sidebar_button_4__c = docUrl;
                     break;
                 case 42:
                     records[i].content_4__c = docUrl;
                     break;
                 case 43:
                     records[i].sub_content_4__c = docUrl;
                     break;
                 case 51:
                     records[i].sidebar_button_5__c = docUrl;
                     break;
                 case 52:
                     records[i].content_5__c = docUrl;
                     break;
                 case 53:
                     records[i].sub_content_5__c = docUrl;
                     break;
                 case 'logo':
                     records[i].logo_url__c = docUrl;
                     break;
                 case 'icon':
                     records[i].app_icon__c = docUrl;
                     break;
                 default:
                     alert('An Error Occurred. Please contact the SSE team to help resolving the issue.');
                     document.getElementById("dropbox_" + id).innerHTML = "Error";
                     document.getElementById("dropbox_" + id).style.backgroundColor = '#ff0000';
                }
             }
             sforce.connection.update(records, {onSuccess: function(e){ updSuccess(e, tagId); }, onFailure: handleFailure});
         }
         
         function queryFailure(error){
             alert('An error occurred during the app update: ' + error);
             document.getElementById("dropbox_" + id).innerHTML = "Error";
                     document.getElementById("dropbox_" + id).style.backgroundColor = '#ff0000';
         }
         
         function updSuccess(result, id){
             document.getElementById("dropbox_" + id).innerHTML = "Success";
             document.getElementById("dropbox_" + id).style.backgroundColor = '#52ce5f';
         }
         
         function handleFailure(error){
             alert('An Error Occured: ' + error);
             document.getElementById("dropbox_" + id).innerHTML = "Error";
             document.getElementById("dropbox_" + id).style.backgroundColor = '#ff0000';
         }
         
         
         function updateGradient() {
         	color1 = colorPicker1.color;
         	color2 = colorPicker2.color;
             $('#gradient').css("background-image", "-moz-linear-gradient(top, " + color1 + ", " + color2 + ")");
             if ($.browser.webkit)
                 document.getElementById('gradient').style.background = "-webkit-gradient(linear, left top, left bottom, from(" + color1 + "), to(" + color2 + "))";
                 
             sforce.connection.query(
                 "SELECT Id, hd_bg_color_end__c, hd_bg_color_start__c FROM iPadAppMaker__c WHERE Id = '{!$CurrentPage.parameters.Id}'",
                 {onSuccess: function(qResult){
                                 var records = qResult.getArray('records');
                                 for(i in records){
                                     records[i].hd_bg_color_start__c = color1.substring(1);
                                     records[i].hd_bg_color_end__c = color2.substring(1);
                                 }
                                 sforce.connection.update(records, {onSuccess: function(e){}, onFailure: handleFailure});
                             },
                  onFailure: queryFailure});
         }
         
         function updateSidebarBg(){
         	 var newColor = colorPicker3.color;
             $(".preview_cell.icon").css('background-color', newColor);
             sforce.connection.query(
                 "SELECT Id, sidebar_bg_color__c FROM iPadAppMaker__c WHERE Id = '{!$CurrentPage.parameters.Id}'",
                 {onSuccess: function(qResult){
                                 var records = qResult.getArray('records');
                                 for(i in records){
                                     records[i].sidebar_bg_color__c = newColor.substring(1);
                                 }
                                 sforce.connection.update(records, {onSuccess: function(e){}, onFailure: handleFailure});
                             },
                  onFailure: queryFailure});
         }
         
         function updateContentBg(){
         	 var newColor = colorPicker4.color;
             $(".preview_cell.content").css('background-color', newColor);
             sforce.connection.query(
                 "SELECT Id, content_bg_color__c FROM iPadAppMaker__c WHERE Id = '{!$CurrentPage.parameters.Id}'",
                 {onSuccess: function(qResult){
                                 var records = qResult.getArray('records');
                                 for(i in records){
                                     records[i].content_bg_color__c = newColor.substring(1);
                                 }
                                 sforce.connection.update(records, {onSuccess: function(e){}, onFailure: handleFailure});
                             },
                  onFailure: queryFailure});
         }
         
         function updateSidebarPosition(newPosition){
             sforce.connection.query(
                 "SELECT Id, sidebar_position__c FROM iPadAppMaker__c WHERE Id = '{!$CurrentPage.parameters.Id}'",
                 {onSuccess: function(qResult){
                                 var records = qResult.getArray('records');
                                 for(i in records){
                                     records[i].sidebar_position__c = newPosition;
                                 }
                                 sforce.connection.update(records, {onSuccess: function(e){}, onFailure: handleFailure});
                             },
                  onFailure: queryFailure});
              alert('Sidebar new position: ' + newPosition);
         }
         
         function enableDisableYoutubeContent(youtube_enabled){
         	sforce.connection.query(
                 "SELECT Id, youtube_enabled__c FROM iPadAppMaker__c WHERE Id = '{!$CurrentPage.parameters.Id}'",
                 {onSuccess: function(qResult){
                                 var records = qResult.getArray('records');
                                 for(i in records){
                                     records[i].youtube_enabled__c = youtube_enabled;
                                 }
                                 sforce.connection.update(records, {onSuccess: function(e){}, onFailure: handleFailure});
                             },
                  onFailure: queryFailure});
         	$('#youtube_config').fadeToggle();
         	manageYoutubeSubContent();
         }
         
         function manageYoutubeSubContent(){
         	if( $('.youtube_enabled_checkbox')[0].checked == false || $('.youtube_tab_number')[0].value == ''  ){
         		$('.dropbox.sub').fadeIn();
         		$('.preview.sub').fadeIn();
         	}else if( $('.youtube_tab_number')[0].value != '' ){
         		$('.dropbox.sub').fadeIn();
         		$('.preview.sub').fadeIn();
         		var tab_number = $('.youtube_tab_number')[0].value.split('#')[1];
         		$('#dropbox_' + tab_number + '3').fadeOut();
         		$('#preview_' + tab_number + '3').fadeOut();
         	}
         }
      </script>
      
      <style type="text/css">
          body{
              width: 895px;
          }
          
          .adminForm{
              width: 100%;
          }
          
          .adminForm td{
	          vertical-align: top;
	          padding-top: 10px;
          }
          
          .background_color_row td{
          	vertical-align: middle;
          	padding-top: 0px;
          	line-height: 55px;
          }
                    
          .dropCell{
              border-left: solid 2px #cccccc;
              padding: 0px 20px;
          }
          
          .dropbox{
              height: 100px;
              width: 200px;
              background-color: #c1c1c1;
              border: dashed 3px;
              border-radius: 8px;
              text-align: center;
              line-height: 100px;
              font-weight: bold;
              font-size: 15px;
              color: #ffffff;
          }
          
          .dropbox.icon{
          	height: auto;
			width: 100px;
			line-height: 25px;
			padding: 75px 20px;
          }
          
          .dropbox.content{
          	margin-top: 0px;
          }
          .dropbox.sub{
          	margin-top: 105px;
			line-height: 25px;
			padding: 20px 0px;
			height: auto;
			margin-left: 20px;
			margin-right: -20px;
          }
          
          .preview{
              height: 200px;
          }
          
          .preview.icon{
              height: 100px;
          }
          
          .preview.sub{
          	margin-top:5px;
          	margin-left: 20px;
          }
          
          .preview_cell{
              background-color: #{!content_bg_color};
          }
          
          .preview_cell.icon{
              text-align: center;
              background-color: #{!sidebar_bg_color};
          }
          
          .table_label, .table_header{
              font-size: 15px;
              font-weight: bold;
              line-height: 100px;
              text-align: center;
          }
          
          .logo_label{
              font-size: 15px;
              font-weight: bold;
              line-height: 100px;
              float: left;
              padding-left:10px;
              width: 88px;
          }
          #dropbox_logo{
              margin-left: 10px;
              float: left;
          }
          
          #preview_logo{
              margin-left: 25px;
          }
          
          #gradient {
              position: relative;
              width:560px; 
              height:110px; 
              border: 1px solid #000000;
              float: left;
              margin-left: 10px;
              background: #{!header_color_end};
              background-image: -moz-linear-gradient(top, #{!header_color_start}, #{!header_color_end});
          }
          
          input.color {
              width: 10em;
              padding: 3px 0;
              border: 1px solid black;
              text-align: center;
              cursor: pointer;
          }
          
          
          .appChooser, .youtube_form{
              padding: 30px 0px;
          }
          .appChooser td, .youtube_form td{
              vertical-align: middle;
              font-size: 15px;
              font-weight: bold;
          }
          
          #dropbox_icon{
              margin-left: 20px; 
          }
          
          #preview_icon{
              margin-left: 30px;
              width: 100px;
              height: 100px;
              -webkit-border-radius: 20px;
              -moz-border-radius: 20px;
              border-radius: 20px;
              background-color: #333;
              -moz-box-shadow: -3px 3px 10px #999;
              -webkit-box-shadow: -3px 3px 10px #999;
              box-shadow: -3px 3px 10px #999;
          }
                   
          .picker{
          	border: 1px solid #000;
          	-webkit-border-radius: 8px;
            -moz-border-radius: 8px;
            border-radius: 8px;
            background-color: #fff;
            width: 195px;
            -webkit-box-shadow: 0px 0px 10px 2px #888888;
			-moz-box-shadow: 0px 0px 10px 2px #888888;
			box-shadow: 0px 0px 10px 2px #888888;
          }
          
          .picker:before{
          	content: ' ';
			position: absolute;
			width: 0;
			height: 0;
			left: 90px;
			top: -20px;
			border: 10px solid;
			border-color: transparent transparent #000 transparent;
          }
          .picker:after{
          	content: ' ';
			position: absolute;
			width: 0;
			height: 0;
			left: 92px;
			top: -16px;
			border: 8px solid;
			border-color: transparent transparent #fff transparent;
          }
          
          #picker1{
          	position: absolute;
			top: 45px;
			right: -30px;
			z-index: 1;
          }
          #picker2{
          	position: absolute;
			top: 108px;
			right: -30px;
			z-index: 1;
          }
          #picker3{
          	position: absolute;
			top: 465px;
			left: 195px;
			z-index: 1;
          }
          #picker4{
          	position: absolute;
			top: 465px;
			left: 570px;
			z-index: 1;
          }
          
          .youtube_form_label{
          	text-align: right;
            font-size: 12px;
            font-weight: bold;
            padding-left: 30px;
          }
          .youtube_form_col1{
          	font-size: 15px;
            font-weight: bold;
          }
          #youtube_config{
          	-webkit-border-radius: 8px;
			-moz-border-radius: 8px;
			border-radius: 8px;
			-webkit-box-shadow: 0px 0px 10px 0px #000;
			-moz-box-shadow: 0px 0px 10px 0px #000;
			box-shadow: 0px 0px 10px 0px #000;
			padding: 20px;
			margin-left: 20px;
			width: 695px;
			display: none;
          }
          .save_youtube_button{ width: 100%; }
      </style>
      
  </head>
  <body>
      
      <apex:form >
          <table class="appChooser">
              <tr>
                  <td>Choose your App: </td>
                  <td>
                      <apex:selectList size="1" value="{!currentAppId}" >
                          <apex:actionSupport event="onchange" action="{!switchAppAdmin}"/>
                          <apex:selectOptions value="{!appsList}"/>
                      </apex:selectList>
                  </td>
                  <td><span style="padding-left: 30px;">iPad App Icon: </span></td>
                  <td><div id="dropbox_icon" class="dropbox">Drop the app icon here...</div></td>
                  <td><img id="preview_icon" src="{!fileUrl_icon}" class="preview icon" alt="preview"/></td>
              </tr>
          </table>
          
                    
          <table><tr><td>
              <div class='logo_label'>App Header: </div>
          </td><td>
              <div id="dropbox_logo" class="dropbox">Drop the app logo here...</div>
          </td><td>
          <div id="gradient"> 
              <img id="preview_logo" src="{!fileUrl_logo}" class="preview icon" alt="preview" /> 
              <input class="color" id="color1" name="color1" type="text" style="position:absolute; right:10px; top:10px" value="#{!header_color_start}" />
              <div id="picker1" class="picker"></div>
              <input class="color" id="color2" name="color2" type="text" style="position:absolute; right:10px; bottom:10px" value="#{!header_color_end}" /> 
              <div id="picker2" class="picker"></div>
          </div>
          </td></tr></table>
          
          <br/><br/>
          <table class="appChooser">
              <tr>
                  <td>Sidebar position: </td>
                  <td>
                      <apex:inputField value="{!instance.sidebar_position__c}" onChange="updateSidebarPosition(this.options[selectedIndex].value)" />
                  </td>
              </tr>
          </table>
                    
          <table class='adminForm' cellSpacing='0'>
              <tr class="background_color_row">
                  <td colspan='2' class='table_label' style="text-align: left;">Background Color</td>
                  <td>
                  	<input class="color" id="color3" value="#{!sidebar_bg_color}" />
                  	<div id="picker3" class="picker"></div>
                  </td>
                  <td></td>
                  <td>
                  	<input class="color" id="color4" value="#{!content_bg_color}" />
                    <div id="picker4" class="picker"></div>
                  </td>
              </tr>
              <tr>
                  <td class='table_label'>Tab#1</td>
                  <td class='dropCell'>
                      <div id="dropbox_11" class="dropbox icon">Drop icon for tab#1 here...</div>
                  </td>
                  <td class="preview_cell icon"><img id="preview_11" src="{!fileUrl_11}" class="preview icon" alt="preview" /></td>
                  <td class='dropCell'>
                      <div id="dropbox_12" class="dropbox content">Drop image content here...</div>
                      <div id="dropbox_13" class="dropbox sub">Drop image subcontent here...</div>
                  </td>
                  <td class="preview_cell content">
                  	<img id="preview_12" src="{!fileUrl_12}" class="preview content" alt="preview" /><br/>
                  	<img id="preview_13" src="{!fileUrl_13}" class="preview sub" alt="preview" />
                  </td>
              </tr>
              <tr>
                  <td class='table_label'>Tab#2</td>
                  <td class='dropCell'>
                      <div id="dropbox_21" class="dropbox icon">Drop icon for tab#2 here...</div>
                  </td>
                  <td class="preview_cell icon"><img id="preview_21" src="{!fileUrl_21}" class="preview icon" alt="preview" /></td>
                  <td class='dropCell'>
                      <div id="dropbox_22" class="dropbox content">Drop image content here...</div>
                      <div id="dropbox_23" class="dropbox sub">Drop image subcontent here...</div>
                  </td>
                  <td class="preview_cell content">
					<img id="preview_22" src="{!fileUrl_22}" class="preview content" alt="preview" /><br/>
                  	<img id="preview_23" src="{!fileUrl_23}" class="preview sub" alt="preview" />
				  </td>
              </tr>
              <tr>
                  <td class='table_label'>Tab#3</td>
                  <td class='dropCell'>
                      <div id="dropbox_31" class="dropbox icon">Drop icon for tab#3 here...</div>
                  </td>
                  <td class="preview_cell icon"><img id="preview_31" src="{!fileUrl_31}" class="preview icon" alt="preview" /></td>
                  <td class='dropCell'>
                      <div id="dropbox_32" class="dropbox content">Drop image content here...</div>
                      <div id="dropbox_33" class="dropbox sub">Drop image subcontent here...</div>
                  </td>
                  <td class="preview_cell content">
					<img id="preview_32" src="{!fileUrl_32}" class="preview content" alt="preview" /><br/>
                  	<img id="preview_33" src="{!fileUrl_33}" class="preview sub" alt="preview" />
				  </td>
              </tr>
              <tr>
                  <td class='table_label'>Tab#4</td>
                  <td class='dropCell'>
                      <div id="dropbox_41" class="dropbox icon">Drop icon for tab#4 here...</div>
                  </td>
                  <td class="preview_cell icon"><img id="preview_41" src="{!fileUrl_41}" class="preview icon" alt="preview" /></td>
                  <td class='dropCell'>
                      <div id="dropbox_42" class="dropbox content">Drop image content here...</div>
                      <div id="dropbox_43" class="dropbox sub">Drop image subcontent here...</div>
                  </td>
                  <td class="preview_cell content">
                    <img id="preview_42" src="{!fileUrl_42}" class="preview content" alt="preview" /><br/>
                  	<img id="preview_43" src="{!fileUrl_43}" class="preview sub" alt="preview" />
                  </td>
              </tr>
              <tr>
                  <td class='table_label'>Tab#5</td>
                  <td class='dropCell'>
                      <div id="dropbox_51" class="dropbox icon">Drop icon for tab#5 here...</div>
                  </td>
                  <td class="preview_cell icon"><img id="preview_51" src="{!fileUrl_51}" class="preview icon" alt="preview" /></td>
                  <td class='dropCell'>
                      <div id="dropbox_52" class="dropbox content">Drop image content here...</div>
                      <div id="dropbox_53" class="dropbox sub">Drop image subcontent here...</div>
                  </td>
                  <td class="preview_cell content">
					<img id="preview_52" src="{!fileUrl_52}" class="preview content" alt="preview" /><br/>
                  	<img id="preview_53" src="{!fileUrl_53}" class="preview sub" alt="preview" />
				  </td>
              </tr>
          </table>
          <br/>
          
          <table class="youtube_form">
              <tr>
                  <td>Enable Youtube content: </td>
                  <td>
                      <apex:inputField styleClass="youtube_enabled_checkbox" value="{!instance.youtube_enabled__c}" onChange="enableDisableYoutubeContent(this.checked);" />
                  </td>
              </tr>
          </table> 
          <div id="youtube_config">
          	<table>
              <tr>
              	  <td></td>
                  <td class="youtube_form_label">Select a Tab: </td>
                  <td>
                      <apex:inputField styleClass="youtube_tab_number" value="{!instance.youtube_tab_number__c}" onChange="manageYoutubeSubContent();" />
                  </td>
                  <td class="youtube_form_label">Youtube video URL: </td>
              	  <td>
              	  	<apex:inputField value="{!instance.youtube_url__c}" />
              	  </td>
              </tr>
              <tr>
              	<td class="youtube_form_col1">Youtube frame size: </td>
              	<td class="youtube_form_label">width: </td>
              	<td>
              		<apex:inputField value="{!instance.youtube_width__c}" />
              	</td>
              	<td class="youtube_form_label">height: </td>
              	<td>
              		<apex:inputField value="{!instance.youtube_height__c}" />
              	</td>
              </tr>
              <tr>
              	<td class="youtube_form_col1">Youtube frame position: </td>
              	<td class="youtube_form_label">top: </td>
              	<td>
              		<apex:inputField value="{!instance.youtube_top__c}" />
              	</td>
              	<td class="youtube_form_label">left: </td>
              	<td>
              		<apex:inputField value="{!instance.youtube_left__c}" />
              	</td>
              </tr>
              <tr>
              	<td colspan="3"></td>
              	<td colspan="2"><br/><apex:commandButton value="Save Youtube configuration" styleClass="save_youtube_button" action="{!saveYoutubeConfig}" /></td>
              </tr>
          	</table>
          </div>         
          
          <br/><br/><br/>
          <apex:commandButton value="Go To The App" action="{!goToTheApp}" style="width: 400px" />
          &nbsp;&nbsp;&nbsp;&nbsp;<a href="{!$Resource.iconSet}" >Download Salesforce icon set for your tabs</a><br/><br/>
          To bookmark this app to your iPad add  <b>?id=<apex:outputField value="{!iPadAppMaker__c.id}"/></B>  to the end of the <a href="/0DM/o?setupid=CustomDomain&retURL=%2Fui%2Fsetup%2FSetup%3Fsetupid%3DDevToolsIntegrate" target="_blank" >iPadApp Site URL.</a>

      </apex:form>
      
  </body>
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-46606102-1', 'salesforce.com');
  ga('send', 'pageview');

</script>
</apex:page>