/*! Skuid Banzai 7.24.0 30-10-2015 */
/*!
 * jQuery UI Touch Punch 0.2.3
 *
 * Copyright 2011â€“2014, Dave Furfero
 * Dual licensed under the MIT or GPL Version 2 licenses.
 *
 * Depends:
 *  jquery.ui.widget.js
 *  jquery.ui.mouse.js
 */
if(!function(a){function b(a,b){if(!(a.originalEvent.touches.length>1)){a.preventDefault();var c=a.originalEvent.changedTouches[0],d=document.createEvent("MouseEvents");d.initMouseEvent(b,!0,!0,window,1,c.screenX,c.screenY,c.clientX,c.clientY,!1,!1,!1,!1,0,null),a.target.dispatchEvent(d)}}if(a.support.touch="ontouchend"in document,a.support.touch){var c,d=a.ui.mouse.prototype,e=d._mouseInit,f=d._mouseDestroy;d._touchStart=function(a){var d=this;!c&&d._mouseCapture(a.originalEvent.changedTouches[0])&&(c=!0,d._touchMoved=!1,b(a,"mouseover"),b(a,"mousemove"),b(a,"mousedown"))},d._touchMove=function(a){c&&(this._touchMoved=!0,b(a,"mousemove"))},d._touchEnd=function(a){c&&(b(a,"mouseup"),b(a,"mouseout"),this._touchMoved||b(a,"click"),c=!1)},d._mouseInit=function(){var b=this;b.element.bind({touchstart:a.proxy(b,"_touchStart"),touchmove:a.proxy(b,"_touchMove"),touchend:a.proxy(b,"_touchEnd")}),e.call(b)},d._mouseDestroy=function(){var b=this;b.element.unbind({touchstart:a.proxy(b,"_touchStart"),touchmove:a.proxy(b,"_touchMove"),touchend:a.proxy(b,"_touchEnd")}),f.call(b)}}}(jQuery),/*! Hammer.JS - v1.1.3 - 2014-05-20
 * http://eightmedia.github.io/hammer.js
 *
 * Copyright (c) 2014 Jorik Tangelder <j.tangelder@gmail.com>;
 * Licensed under the MIT license */
!function(a,b){"use strict";function c(){d.READY||(s.determineEventTypes(),r.each(d.gestures,function(a){u.register(a)}),s.onTouch(d.DOCUMENT,n,u.detect),s.onTouch(d.DOCUMENT,o,u.detect),d.READY=!0)}var d=function v(a,b){return new v.Instance(a,b||{})};d.VERSION="1.1.3",d.defaults={behavior:{userSelect:"none",touchAction:"pan-y",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},d.DOCUMENT=document,d.HAS_POINTEREVENTS=navigator.pointerEnabled||navigator.msPointerEnabled,d.HAS_TOUCHEVENTS="ontouchstart"in a,d.IS_MOBILE=/mobile|tablet|ip(ad|hone|od)|android|silk/i.test(navigator.userAgent),d.NO_MOUSEEVENTS=d.HAS_TOUCHEVENTS&&d.IS_MOBILE||d.HAS_POINTEREVENTS,d.CALCULATE_INTERVAL=25;var e={},f=d.DIRECTION_DOWN="down",g=d.DIRECTION_LEFT="left",h=d.DIRECTION_UP="up",i=d.DIRECTION_RIGHT="right",j=d.POINTER_MOUSE="mouse",k=d.POINTER_TOUCH="touch",l=d.POINTER_PEN="pen",m=d.EVENT_START="start",n=d.EVENT_MOVE="move",o=d.EVENT_END="end",p=d.EVENT_RELEASE="release",q=d.EVENT_TOUCH="touch";d.READY=!1,d.plugins=d.plugins||{},d.gestures=d.gestures||{};var r=d.utils={extend:function(a,c,d){for(var e in c)!c.hasOwnProperty(e)||a[e]!==b&&d||(a[e]=c[e]);return a},on:function(a,b,c){a.addEventListener(b,c,!1)},off:function(a,b,c){a.removeEventListener(b,c,!1)},each:function(a,c,d){var e,f;if("forEach"in a)a.forEach(c,d);else if(a.length!==b){for(e=0,f=a.length;f>e;e++)if(c.call(d,a[e],e,a)===!1)return}else for(e in a)if(a.hasOwnProperty(e)&&c.call(d,a[e],e,a)===!1)return},inStr:function(a,b){return a.indexOf(b)>-1},inArray:function(a,b){if(a.indexOf){var c=a.indexOf(b);return-1===c?!1:c}for(var d=0,e=a.length;e>d;d++)if(a[d]===b)return d;return!1},toArray:function(a){return Array.prototype.slice.call(a,0)},hasParent:function(a,b){for(;a;){if(a==b)return!0;a=a.parentNode}return!1},getCenter:function(a){var b=[],c=[],d=[],e=[],f=Math.min,g=Math.max;return 1===a.length?{pageX:a[0].pageX,pageY:a[0].pageY,clientX:a[0].clientX,clientY:a[0].clientY}:(r.each(a,function(a){b.push(a.pageX),c.push(a.pageY),d.push(a.clientX),e.push(a.clientY)}),{pageX:(f.apply(Math,b)+g.apply(Math,b))/2,pageY:(f.apply(Math,c)+g.apply(Math,c))/2,clientX:(f.apply(Math,d)+g.apply(Math,d))/2,clientY:(f.apply(Math,e)+g.apply(Math,e))/2})},getVelocity:function(a,b,c){return{x:Math.abs(b/a)||0,y:Math.abs(c/a)||0}},getAngle:function(a,b){var c=b.clientX-a.clientX,d=b.clientY-a.clientY;return 180*Math.atan2(d,c)/Math.PI},getDirection:function(a,b){var c=Math.abs(a.clientX-b.clientX),d=Math.abs(a.clientY-b.clientY);return c>=d?a.clientX-b.clientX>0?g:i:a.clientY-b.clientY>0?h:f},getDistance:function(a,b){var c=b.clientX-a.clientX,d=b.clientY-a.clientY;return Math.sqrt(c*c+d*d)},getScale:function(a,b){return a.length>=2&&b.length>=2?this.getDistance(b[0],b[1])/this.getDistance(a[0],a[1]):1},getRotation:function(a,b){return a.length>=2&&b.length>=2?this.getAngle(b[1],b[0])-this.getAngle(a[1],a[0]):0},isVertical:function(a){return a==h||a==f},setPrefixedCss:function(a,b,c,d){var e=["","Webkit","Moz","O","ms"];b=r.toCamelCase(b);for(var f=0;f<e.length;f++){var g=b;if(e[f]&&(g=e[f]+g.slice(0,1).toUpperCase()+g.slice(1)),g in a.style){a.style[g]=(null==d||d)&&c||"";break}}},toggleBehavior:function(a,b,c){if(b&&a&&a.style){r.each(b,function(b,d){r.setPrefixedCss(a,d,b,c)});var d=c&&function(){return!1};"none"==b.userSelect&&(a.onselectstart=d),"none"==b.userDrag&&(a.ondragstart=d)}},toCamelCase:function(a){return a.replace(/[_-]([a-z])/g,function(a){return a[1].toUpperCase()})}},s=d.event={preventMouseEvents:!1,started:!1,shouldDetect:!1,on:function(a,b,c,d){var e=b.split(" ");r.each(e,function(b){r.on(a,b,c),d&&d(b)})},off:function(a,b,c,d){var e=b.split(" ");r.each(e,function(b){r.off(a,b,c),d&&d(b)})},onTouch:function(a,b,c){var f=this,g=function(e){var g,h=e.type.toLowerCase(),i=d.HAS_POINTEREVENTS,j=r.inStr(h,"mouse");j&&f.preventMouseEvents||(j&&b==m&&0===e.button?(f.preventMouseEvents=!1,f.shouldDetect=!0):i&&b==m?f.shouldDetect=1===e.buttons||t.matchType(k,e):j||b!=m||(f.preventMouseEvents=!0,f.shouldDetect=!0),i&&b!=o&&t.updatePointer(b,e),f.shouldDetect&&(g=f.doDetect.call(f,e,b,a,c)),g==o&&(f.preventMouseEvents=!1,f.shouldDetect=!1,t.reset()),i&&b==o&&t.updatePointer(b,e))};return this.on(a,e[b],g),g},doDetect:function(a,b,c,d){var e=this.getTouchList(a,b),f=e.length,g=b,h=e.trigger,i=f;b==m?h=q:b==o&&(h=p,i=e.length-(a.changedTouches?a.changedTouches.length:1)),i>0&&this.started&&(g=n),this.started=!0;var j=this.collectEventData(c,g,e,a);return b!=o&&d.call(u,j),h&&(j.changedLength=i,j.eventType=h,d.call(u,j),j.eventType=g,delete j.changedLength),g==o&&(d.call(u,j),this.started=!1),g},determineEventTypes:function(){var b;return b=d.HAS_POINTEREVENTS?a.PointerEvent?["pointerdown","pointermove","pointerup pointercancel lostpointercapture"]:["MSPointerDown","MSPointerMove","MSPointerUp MSPointerCancel MSLostPointerCapture"]:d.NO_MOUSEEVENTS?["touchstart","touchmove","touchend touchcancel"]:["touchstart mousedown","touchmove mousemove","touchend touchcancel mouseup"],e[m]=b[0],e[n]=b[1],e[o]=b[2],e},getTouchList:function(a,b){if(d.HAS_POINTEREVENTS)return t.getTouchList();if(a.touches){if(b==n)return a.touches;var c=[],e=[].concat(r.toArray(a.touches),r.toArray(a.changedTouches)),f=[];return r.each(e,function(a){r.inArray(c,a.identifier)===!1&&f.push(a),c.push(a.identifier)}),f}return a.identifier=1,[a]},collectEventData:function(a,b,c,d){var e=k;return r.inStr(d.type,"mouse")||t.matchType(j,d)?e=j:t.matchType(l,d)&&(e=l),{center:r.getCenter(c),timeStamp:Date.now(),target:d.target,touches:c,eventType:b,pointerType:e,srcEvent:d,preventDefault:function(){var a=this.srcEvent;a.preventManipulation&&a.preventManipulation(),a.preventDefault&&a.preventDefault()},stopPropagation:function(){this.srcEvent.stopPropagation()},stopDetect:function(){return u.stopDetect()}}}},t=d.PointerEvent={pointers:{},getTouchList:function(){var a=[];return r.each(this.pointers,function(b){a.push(b)}),a},updatePointer:function(a,b){a==o||a!=o&&1!==b.buttons?delete this.pointers[b.pointerId]:(b.identifier=b.pointerId,this.pointers[b.pointerId]=b)},matchType:function(a,b){if(!b.pointerType)return!1;var c=b.pointerType,d={};return d[j]=c===(b.MSPOINTER_TYPE_MOUSE||j),d[k]=c===(b.MSPOINTER_TYPE_TOUCH||k),d[l]=c===(b.MSPOINTER_TYPE_PEN||l),d[a]},reset:function(){this.pointers={}}},u=d.detection={gestures:[],current:null,previous:null,stopped:!1,startDetect:function(a,b){this.current||(this.stopped=!1,this.current={inst:a,startEvent:r.extend({},b),lastEvent:!1,lastCalcEvent:!1,futureCalcEvent:!1,lastCalcData:{},name:""},this.detect(b))},detect:function(a){if(this.current&&!this.stopped){a=this.extendEventData(a);var b=this.current.inst,c=b.options;return r.each(this.gestures,function(d){!this.stopped&&b.enabled&&c[d.name]&&d.handler.call(d,a,b)},this),this.current&&(this.current.lastEvent=a),a.eventType==o&&this.stopDetect(),a}},stopDetect:function(){this.previous=r.extend({},this.current),this.current=null,this.stopped=!0},getCalculatedData:function(a,b,c,e,f){var g=this.current,h=!1,i=g.lastCalcEvent,j=g.lastCalcData;i&&a.timeStamp-i.timeStamp>d.CALCULATE_INTERVAL&&(b=i.center,c=a.timeStamp-i.timeStamp,e=a.center.clientX-i.center.clientX,f=a.center.clientY-i.center.clientY,h=!0),(a.eventType==q||a.eventType==p)&&(g.futureCalcEvent=a),(!g.lastCalcEvent||h)&&(j.velocity=r.getVelocity(c,e,f),j.angle=r.getAngle(b,a.center),j.direction=r.getDirection(b,a.center),g.lastCalcEvent=g.futureCalcEvent||a,g.futureCalcEvent=a),a.velocityX=j.velocity.x,a.velocityY=j.velocity.y,a.interimAngle=j.angle,a.interimDirection=j.direction},extendEventData:function(a){var b=this.current,c=b.startEvent,d=b.lastEvent||c;(a.eventType==q||a.eventType==p)&&(c.touches=[],r.each(a.touches,function(a){c.touches.push({clientX:a.clientX,clientY:a.clientY})}));var e=a.timeStamp-c.timeStamp,f=a.center.clientX-c.center.clientX,g=a.center.clientY-c.center.clientY;return this.getCalculatedData(a,d.center,e,f,g),r.extend(a,{startEvent:c,deltaTime:e,deltaX:f,deltaY:g,distance:r.getDistance(c.center,a.center),angle:r.getAngle(c.center,a.center),direction:r.getDirection(c.center,a.center),scale:r.getScale(c.touches,a.touches),rotation:r.getRotation(c.touches,a.touches)}),a},register:function(a){var c=a.defaults||{};return c[a.name]===b&&(c[a.name]=!0),r.extend(d.defaults,c,!0),a.index=a.index||1e3,this.gestures.push(a),this.gestures.sort(function(a,b){return a.index<b.index?-1:a.index>b.index?1:0}),this.gestures}};d.Instance=function(a,b){var e=this;c(),this.element=a,this.enabled=!0,r.each(b,function(a,c){delete b[c],b[r.toCamelCase(c)]=a}),this.options=r.extend(r.extend({},d.defaults),b||{}),this.options.behavior&&r.toggleBehavior(this.element,this.options.behavior,!0),this.eventStartHandler=s.onTouch(a,m,function(a){e.enabled&&a.eventType==m?u.startDetect(e,a):a.eventType==q&&u.detect(a)}),this.eventHandlers=[]},d.Instance.prototype={on:function(a,b){var c=this;return s.on(c.element,a,b,function(a){c.eventHandlers.push({gesture:a,handler:b})}),c},off:function(a,b){var c=this;return s.off(c.element,a,b,function(a){var d=r.inArray({gesture:a,handler:b});d!==!1&&c.eventHandlers.splice(d,1)}),c},trigger:function(a,b){b||(b={});var c=d.DOCUMENT.createEvent("Event");c.initEvent(a,!0,!0),c.gesture=b;var e=this.element;return r.hasParent(b.target,e)&&(e=b.target),e.dispatchEvent(c),this},enable:function(a){return this.enabled=a,this},dispose:function(){var a,b;for(r.toggleBehavior(this.element,this.options.behavior,!1),a=-1;b=this.eventHandlers[++a];)r.off(this.element,b.gesture,b.handler);return this.eventHandlers=[],s.off(this.element,e[m],this.eventStartHandler),null}},function(a){function b(b,d){var e=u.current;if(!(d.options.dragMaxTouches>0&&b.touches.length>d.options.dragMaxTouches))switch(b.eventType){case m:c=!1;break;case n:if(b.distance<d.options.dragMinDistance&&e.name!=a)return;var j=e.startEvent.center;if(e.name!=a&&(e.name=a,d.options.dragDistanceCorrection&&b.distance>0)){var k=Math.abs(d.options.dragMinDistance/b.distance);j.pageX+=b.deltaX*k,j.pageY+=b.deltaY*k,j.clientX+=b.deltaX*k,j.clientY+=b.deltaY*k,b=u.extendEventData(b)}(e.lastEvent.dragLockToAxis||d.options.dragLockToAxis&&d.options.dragLockMinDistance<=b.distance)&&(b.dragLockToAxis=!0);var l=e.lastEvent.direction;b.dragLockToAxis&&l!==b.direction&&(b.direction=r.isVertical(l)?b.deltaY<0?h:f:b.deltaX<0?g:i),c||(d.trigger(a+"start",b),c=!0),d.trigger(a,b),d.trigger(a+b.direction,b);var q=r.isVertical(b.direction);(d.options.dragBlockVertical&&q||d.options.dragBlockHorizontal&&!q)&&b.preventDefault();break;case p:c&&b.changedLength<=d.options.dragMaxTouches&&(d.trigger(a+"end",b),c=!1);break;case o:c=!1}}var c=!1;d.gestures.Drag={name:a,index:50,handler:b,defaults:{dragMinDistance:10,dragDistanceCorrection:!0,dragMaxTouches:1,dragBlockHorizontal:!1,dragBlockVertical:!1,dragLockToAxis:!1,dragLockMinDistance:25}}}("drag"),d.gestures.Gesture={name:"gesture",index:1337,handler:function(a,b){b.trigger(this.name,a)}},function(a){function b(b,d){var e=d.options,f=u.current;switch(b.eventType){case m:clearTimeout(c),f.name=a,c=setTimeout(function(){f&&f.name==a&&d.trigger(a,b)},e.holdTimeout);break;case n:b.distance>e.holdThreshold&&clearTimeout(c);break;case p:clearTimeout(c)}}var c;d.gestures.Hold={name:a,index:10,defaults:{holdTimeout:500,holdThreshold:2},handler:b}}("hold"),d.gestures.Release={name:"release",index:1/0,handler:function(a,b){a.eventType==p&&b.trigger(this.name,a)}},d.gestures.Swipe={name:"swipe",index:40,defaults:{swipeMinTouches:1,swipeMaxTouches:1,swipeVelocityX:.6,swipeVelocityY:.6},handler:function(a,b){if(a.eventType==p){var c=a.touches.length,d=b.options;if(c<d.swipeMinTouches||c>d.swipeMaxTouches)return;(a.velocityX>d.swipeVelocityX||a.velocityY>d.swipeVelocityY)&&(b.trigger(this.name,a),b.trigger(this.name+a.direction,a))}}},function(a){function b(b,d){var e,f,g=d.options,h=u.current,i=u.previous;switch(b.eventType){case m:c=!1;break;case n:c=c||b.distance>g.tapMaxDistance;break;case o:!r.inStr(b.srcEvent.type,"cancel")&&b.deltaTime<g.tapMaxTime&&!c&&(e=i&&i.lastEvent&&b.timeStamp-i.lastEvent.timeStamp,f=!1,i&&i.name==a&&e&&e<g.doubleTapInterval&&b.distance<g.doubleTapDistance&&(d.trigger("doubletap",b),f=!0),(!f||g.tapAlways)&&(h.name=a,d.trigger(h.name,b)))}}var c=!1;d.gestures.Tap={name:a,index:100,handler:b,defaults:{tapMaxTime:250,tapMaxDistance:10,tapAlways:!0,doubleTapDistance:20,doubleTapInterval:300}}}("tap"),d.gestures.Touch={name:"touch",index:-1/0,defaults:{preventDefault:!1,preventMouse:!1},handler:function(a,b){return b.options.preventMouse&&a.pointerType==j?void a.stopDetect():(b.options.preventDefault&&a.preventDefault(),void(a.eventType==q&&b.trigger("touch",a)))}},function(a){function b(b,d){switch(b.eventType){case m:c=!1;break;case n:if(b.touches.length<2)return;var e=Math.abs(1-b.scale),f=Math.abs(b.rotation);if(e<d.options.transformMinScale&&f<d.options.transformMinRotation)return;u.current.name=a,c||(d.trigger(a+"start",b),c=!0),d.trigger(a,b),f>d.options.transformMinRotation&&d.trigger("rotate",b),e>d.options.transformMinScale&&(d.trigger("pinch",b),d.trigger("pinch"+(b.scale<1?"in":"out"),b));break;case p:c&&b.changedLength<2&&(d.trigger(a+"end",b),c=!1)}}var c=!1;d.gestures.Transform={name:a,index:45,defaults:{transformMinScale:.01,transformMinRotation:1},handler:b}}("transform"),"function"==typeof define&&define.amd?define(function(){return d}):"undefined"!=typeof module&&module.exports?module.exports=d:a.Hammer=d}(window),/*! jQuery plugin for Hammer.JS - v1.1.3 - 2014-05-20
 * http://eightmedia.github.com/hammer.js
 *
 * Copyright (c) 2014 Jorik Tangelder <j.tangelder@gmail.com>;
 * Licensed under the MIT license */
!function(a,b){"use strict";function c(a,c){Date.now||(Date.now=function(){return(new Date).getTime()}),a.utils.each(["on","off"],function(d){a.utils[d]=function(a,e,f){c(a)[d](e,function(a){var d=c.extend({},a.originalEvent,a);d.button===b&&(d.button=a.which-1),f.call(this,d)})}}),a.Instance.prototype.trigger=function(a,b){var d=c(this.element);return d.has(b.target).length&&(d=c(b.target)),d.trigger({type:a,gesture:b})},c.fn.hammer=function(b){return this.each(function(){var d=c(this),e=d.data("hammer");e?e&&b&&a.utils.extend(e.options,b):d.data("hammer",new a(this,b||{}))})}}"function"==typeof define&&define.amd?define(["hammerjs","jquery"],c):c(a.Hammer,a.jQuery||a.Zepto)}(window),Object.keys||(Object.keys=function(){var a=Object.prototype.hasOwnProperty,b=!{toString:null}.propertyIsEnumerable("toString"),c=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],d=c.length;return function(e){if("object"!=typeof e&&"function"!=typeof e||null===e)throw new TypeError("Object.keys called on non-object");var f=[];for(var g in e)a.call(e,g)&&f.push(g);if(b)for(var h=0;d>h;h++)a.call(e,c[h])&&f.push(c[h]);return f}}()),Array.prototype.indexOf||(Array.prototype.indexOf=function(a){"use strict";if(null==this)throw new TypeError;var b=Object(this),c=b.length>>>0;if(0===c)return-1;var d=0;if(arguments.length>1&&(d=Number(arguments[1]),d!=d?d=0:0!=d&&1/0!=d&&d!=-1/0&&(d=(d>0||-1)*Math.floor(Math.abs(d)))),d>=c)return-1;for(var e=d>=0?d:Math.max(c-Math.abs(d),0);c>e;e++)if(e in b&&b[e]===a)return e;return-1}),Array.prototype.lastIndexOf||(Array.prototype.lastIndexOf=function(a){"use strict";if(null==this)throw new TypeError;var b=Object(this),c=b.length>>>0;if(0===c)return-1;var d=c;arguments.length>1&&(d=Number(arguments[1]),d!=d?d=0:0!=d&&d!=1/0&&d!=-(1/0)&&(d=(d>0||-1)*Math.floor(Math.abs(d))));for(var e=d>=0?Math.min(d,c-1):c-Math.abs(d);e>=0;e--)if(e in b&&b[e]===a)return e;return-1}),Array.prototype.filter||(Array.prototype.filter=function(a){"use strict";if(null==this)throw new TypeError;var b=Object(this),c=b.length>>>0;if("function"!=typeof a)throw new TypeError;for(var d=[],e=arguments[1],f=0;c>f;f++)if(f in b){var g=b[f];a.call(e,g,f,b)&&d.push(g)}return d}),window.skuid||(window.skuid={}),!skuid.$){!function(a,b){var c;c=c||function(a){var b,c=String.prototype.split,d=/()??/.exec("")[1]===a;return b=function(b,e,f){if("[object RegExp]"!==Object.prototype.toString.call(e))return c.call(b,e,f);var g,h,i,j,k=[],l=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.extended?"x":"")+(e.sticky?"y":""),m=0,e=new RegExp(e.source,l+"g");for(b+="",d||(g=new RegExp("^"+e.source+"$(?!\\s)",l)),f=f===a?-1>>>0:f>>>0;(h=e.exec(b))&&(i=h.index+h[0].length,!(i>m&&(k.push(b.slice(m,h.index)),!d&&h.length>1&&h[0].replace(g,function(){for(var b=1;b<arguments.length-2;b++)arguments[b]===a&&(h[b]=a)}),h.length>1&&h.index<b.length&&Array.prototype.push.apply(k,h.slice(1)),j=h[0].length,m=i,k.length>=f)));)e.lastIndex===h.index&&e.lastIndex++;return m===b.length?(j||!e.test(""))&&k.push(""):k.push(b.slice(m)),k.length>f?k.slice(0,f):k},String.prototype.split=function(a,c){return b(this,a,c)},b}(),!function(a,b){if("object"==typeof d&&d)b(d);else{var c={};b(c),"function"==typeof define&&define.amd?define(c):a.Mustache=c}}(this,function(a){function b(a,b){return t.call(a,b)}function c(a){return!b(p,a)}function d(a){return"function"==typeof a}function e(a){return a.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function f(a){return String(a).replace(/[&<>"'\/]/g,function(a){return w[a]})}function g(a){if(!v(a)||2!==a.length)throw new Error("Invalid tags: "+a);return[new RegExp(e(a[0])+"\\s*"),new RegExp("\\s*"+e(a[1]))]}function h(b,d){function f(){if(A&&!B)for(;z.length;)delete y[z.pop()];else z=[];A=!1,B=!1}d=d||a.tags,b=b||"","string"==typeof d&&(d=d.split(o));for(var h,l,m,p,t,u,v=g(d),w=new k(b),x=[],y=[],z=[],A=!1,B=!1;!w.eos();){if(h=w.pos,m=w.scanUntil(v[0]))for(var C=0,D=m.length;D>C;++C)p=m.charAt(C),c(p)?z.push(y.length):B=!0,y.push(["text",p,h,h+1]),h+=1,"\n"===p&&f();if(!w.scan(v[0]))break;if(A=!0,l=w.scan(s)||"name",w.scan(n),"="===l?(m=w.scanUntil(q),w.scan(q),w.scanUntil(v[1])):"{"===l?(m=w.scanUntil(new RegExp("\\s*"+e("}"+d[1]))),w.scan(r),w.scanUntil(v[1]),l="&"):m=w.scanUntil(v[1]),!w.scan(v[1]))throw new Error("Unclosed tag at "+w.pos);if(t=[l,m,h,w.pos],y.push(t),"#"===l||"^"===l)x.push(t);else if("/"===l){if(u=x.pop(),!u)throw new Error('Unopened section "'+m+'" at '+h);if(u[1]!==m)throw new Error('Unclosed section "'+u[1]+'" at '+h)}else"name"===l||"{"===l||"&"===l?B=!0:"="===l&&(v=g(d=m.split(o)))}if(u=x.pop())throw new Error('Unclosed section "'+u[1]+'" at '+w.pos);return j(i(y))}function i(a){for(var b,c,d=[],e=0,f=a.length;f>e;++e)b=a[e],b&&("text"===b[0]&&c&&"text"===c[0]?(c[1]+=b[1],c[3]=b[3]):(d.push(b),c=b));return d}function j(a){for(var b,c,d=[],e=d,f=[],g=0,h=a.length;h>g;++g)switch(b=a[g],b[0]){case"#":case"^":e.push(b),f.push(b),e=b[4]=[];break;case"/":c=f.pop(),c[5]=b[2],e=f.length>0?f[f.length-1][4]:d;break;default:e.push(b)}return d}function k(a){this.string=a,this.tail=a,this.pos=0}function l(a,b){this.view=null==a?{}:a,this.cache={".":this.view},this.parent=b}function m(){this.cache={}}var n=/\s*/,o=/\s+/,p=/\S/,q=/\s*=/,r=/\s*\}/,s=/#|\^|\/|>|\{|&|=|!/,t=RegExp.prototype.test,u=Object.prototype.toString,v=Array.isArray||function(a){return"[object Array]"===u.call(a)},w={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};k.prototype.eos=function(){return""===this.tail},k.prototype.scan=function(a){var b=this.tail.match(a);if(b&&0===b.index){var c=b[0];return this.tail=this.tail.substring(c.length),this.pos+=c.length,c}return""},k.prototype.scanUntil=function(a){var b,c=this.tail.search(a);switch(c){case-1:b=this.tail,this.tail="";break;case 0:b="";break;default:b=this.tail.substring(0,c),this.tail=this.tail.substring(c)}return this.pos+=b.length,b},l.prototype.push=function(a){return new l(a,this)},l.prototype.lookup=function(a){var b;if(a in this.cache)b=this.cache[a];else{for(var c=this;c;){if(a.indexOf(".")>0){b=c.view;for(var e=a.split("."),f=0;null!=b&&f<e.length;)b=b[e[f++]]}else b=c.view[a];if(null!=b)break;c=c.parent}this.cache[a]=b}return d(b)&&(b=b.call(this.view)),b},m.prototype.clearCache=function(){this.cache={}},m.prototype.parse=function(a,b){var c=this.cache,d=c[a];return null==d&&(d=c[a]=h(a,b)),d},m.prototype.render=function(a,b,c){var d=this.parse(a),e=b instanceof l?b:new l(b);return this.renderTokens(d,e,c,a)},m.prototype.renderTokens=function(b,c,e,f){function g(a){return k.render(a,c,e)}for(var h,i,j="",k=this,l=0,m=b.length;m>l;++l)switch(h=b[l],h[0]){case"#":if(i=c.lookup(h[1]),!i)continue;if(v(i))for(var n=0,o=i.length;o>n;++n)j+=this.renderTokens(h[4],c.push(i[n]),e,f);else if("object"==typeof i||"string"==typeof i)j+=this.renderTokens(h[4],c.push(i),e,f);else if(d(i)){if("string"!=typeof f)throw new Error("Cannot use higher-order sections without the original template");i=i.call(c.view,f.slice(h[3],h[5]),g),null!=i&&(j+=i)}else j+=this.renderTokens(h[4],c,e,f);break;case"^":i=c.lookup(h[1]),(!i||v(i)&&0===i.length)&&(j+=this.renderTokens(h[4],c,e,f));break;case">":if(!e)continue;i=this.parse(d(e)?e(h[1]):e[h[1]]),null!=i&&(j+=this.renderTokens(i,c,e,f));break;case"&":i=c.lookup(h[1]),null!=i&&(j+=i);break;case"name":i=c.lookup(h[1]),null!=i&&(j+=a.escape(i));break;case"text":j+=h[1]}return j},a.name="mustache.js",a.version="0.8.0",a.tags=["{{","}}"];var x=new m;a.clearCache=function(){return x.clearCache()},a.parse=function(a,b){return x.parse(a,b)},a.render=function(a,b,c){return x.render(a,b,c)},a.to_html=function(b,c,e,f){var g=a.render(b,c,e);return d(f)?void f(g):g},a.escape=f,a.Scanner=k,a.Context=l,a.Writer=m});var d=a,e=window.Mustache;d.$=d.jQuery=b.noConflict(),d.Mustache=window.Mustache,e?(window.Mustache=e,e=null):delete window.Mustache,function(a){function b(b){if("string"==typeof b.data&&(b.data={keys:b.data}),b.data&&b.data.keys&&"string"==typeof b.data.keys){var c=b.handler,d=b.data.keys.toLowerCase().split(" ");b.handler=function(e){if(this===e.target||!b.data.filterTextInputs||!(a.inArray(e.target.type,a.hotkeys.textAcceptingInputTypes)>-1||/textarea|select/i.test(e.target.nodeName))){var f=a.hotkeys.specialKeys[e.keyCode],g=String.fromCharCode(e.which).toLowerCase(),h="",i={};a.each(["alt","ctrl","meta","shift"],function(a,b){e[b+"Key"]&&f!==b&&(h+=b+"+")}),h=h.replace("alt+ctrl+meta+shift","hyper"),f&&(i[h+f]=!0),g&&(i[h+g]=!0,i[h+a.hotkeys.shiftNums[g]]=!0,"shift+"===h&&(i[a.hotkeys.shiftNums[g]]=!0));for(var j=0,k=d.length;k>j;j++)if(i[d[j]])return c.apply(this,arguments)}}}}a.hotkeys={version:"0.8",specialKeys:{8:"backspace",9:"tab",10:"return",13:"return",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"del",59:";",61:"=",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"+",109:"-",110:".",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scroll",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},shiftNums:{"`":"~",1:"!",2:"@",3:"#",4:"$",5:"%",6:"^",7:"&",8:"*",9:"(",0:")","-":"_","=":"+",";":": ","'":'"',",":"<",".":">","/":"?","\\":"|"},textAcceptingInputTypes:["text","password","number","email","url","range","date","month","week","time","datetime","datetime-local","search","color","tel"]},a.each(["keydown","keyup","keypress"],function(){a.event.special[this]={add:b}})}(b),function(a){a.datepicker.parseDate=function(b,c,d){if(null==b||null==c)throw"Invalid arguments";if(c="object"==typeof c?c.toString():c+"",""===c)return null;var e,f,g,h,i=0,j=(d?d.shortYearCutoff:null)||this._defaults.shortYearCutoff,k="string"!=typeof j?j:(new Date).getFullYear()%100+parseInt(j,10),l=(d?d.dayNamesShort:null)||this._defaults.dayNamesShort,m=(d?d.dayNames:null)||this._defaults.dayNames,n=(d?d.monthNamesShort:null)||this._defaults.monthNamesShort,o=(d?d.monthNames:null)||this._defaults.monthNames,p=!0,q=-1,r=-1,s=-1,t=-1,u=!1,v=function(a){var c=e+1<b.length&&b.charAt(e+1)===a;return c&&e++,c},w=function(a){var b=v(a),d="@"===a?14:"!"===a?20:"y"===a&&b?4:"o"===a?3:2,e="y"!==a||p?1:d,f=new RegExp("^\\d{"+e+","+d+"}"),g=c.substring(i).match(f);if(!g)throw"Missing number at position "+i;return i+=g[0].length,parseInt(g[0],10)},x=function(b,d,e){var f=-1,g=a.map(v(b)?e:d,function(a,b){return[[b,a]]}).sort(function(a,b){return-(a[1].length-b[1].length)});if(a.each(g,function(a,b){var d=b[1];return c.substr(i,d.length).toLowerCase()===d.toLowerCase()?(f=b[0],i+=d.length,!1):void 0}),-1!==f)return f+1;throw"Unknown name at position "+i},y=function(){if(c.charAt(i)!==b.charAt(e))throw"Unexpected literal at position "+i;i++};for(e=0;e<b.length;e++)if(u)"'"!==b.charAt(e)||v("'")?y():u=!1;else switch(b.charAt(e)){case"d":s=w("d");break;case"D":x("D",l,m);break;case"o":t=w("o");break;case"m":r=w("m");break;case"M":r=x("M",n,o);break;case"y":q=w("y");break;case"@":h=new Date(w("@")),q=h.getFullYear(),r=h.getMonth()+1,s=h.getDate();break;case"!":h=new Date((w("!")-this._ticksTo1970)/1e4),q=h.getFullYear(),r=h.getMonth()+1,s=h.getDate();break;case"'":v("'")?y():u=!0;break;default:y()}if(i<c.length&&(g=c.substr(i),!/^\s+/.test(g)))throw"Extra/unparsed characters found in date: "+g;if(-1===q?q=(new Date).getFullYear():100>q&&(q+=(new Date).getFullYear()-(new Date).getFullYear()%100+(k>=q?0:-100)),t>-1)for(r=1,s=t;;){if(f=this._getDaysInMonth(q,r-1),f>=s)break;r++,s-=f}if(h=this._daylightSavingAdjust(new Date(q,r-1,s)),h.getFullYear()!==q||h.getMonth()+1!==r||h.getDate()!==s)throw"Invalid date";return h}}(b),/*!
	 * jQuery Cookie Plugin v1.3.1
	 * https://github.com/carhartl/jquery-cookie
	 *
	 * Copyright 2013 Klaus Hartl
	 * Released under the MIT license
	 */
function(a){"function"==typeof define&&define.amd&&define.amd.jQuery?define(["jquery"],a):a(b)}(function(a){function b(a){return a}function c(a){return decodeURIComponent(a.replace(e," "))}function d(a){0===a.indexOf('"')&&(a=a.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{return f.json?JSON.parse(a):a}catch(b){}}var e=/\+/g,f=a.cookie=function(e,g,h){if(void 0!==g){if(h=a.extend({},f.defaults,h),"number"==typeof h.expires){var i=h.expires,j=h.expires=new Date;j.setDate(j.getDate()+i)}return g=f.json?JSON.stringify(g):g+"",document.cookie=[encodeURIComponent(e),"=",f.raw?g:encodeURIComponent(g),h.expires?"; expires="+h.expires.toUTCString():"",h.path?"; path="+h.path:"",h.domain?"; domain="+h.domain:"",h.secure?"; secure":""].join("")}for(var k=f.raw?b:c,l=document.cookie.split("; "),m=e?void 0:{},n=0,o=l.length;o>n;n++){var p=l[n].split("="),q=k(p.shift()),r=k(p.join("="));if(e&&e===q){m=d(r);break}e||(m[q]=d(r))}return m};f.defaults={},a.removeCookie=function(b,c){return void 0!==a.cookie(b)?(a.cookie(b,"",a.extend(c,{expires:-1})),!0):!1}}),/*!
	 * jQuery blockUI plugin
	 * Version 2.65.0-2013.09.02
	 * Requires jQuery v1.7 or later
	 *
	 * Examples at: http://malsup.com/jquery/block/
	 * Copyright (c) 2007-2013 M. Alsup
	 * Dual licensed under the MIT and GPL licenses:
	 * http://www.opensource.org/licenses/mit-license.php
	 * http://www.gnu.org/licenses/gpl.html
	 *
	 * Thanks to Amir-Hossein Sobhi for some excellent contributions!
	 */
!function(){"use strict";function a(a){function b(b,d){var f,p,q=b==window,r=d&&void 0!==d.message?d.message:void 0;if(d=a.extend({},a.blockUI.defaults,d||{}),!d.ignoreIfBlocked||!a(b).data("blockUI.isBlocked")){if(d.overlayCSS=a.extend({},a.blockUI.defaults.overlayCSS,d.overlayCSS||{}),f=a.extend({},a.blockUI.defaults.css,d.css||{}),d.onOverlayClick&&(d.overlayCSS.cursor="pointer"),p=a.extend({},a.blockUI.defaults.themedCSS,d.themedCSS||{}),r=void 0===r?d.message:r,q&&n&&c(window,{fadeOut:0}),r&&"string"!=typeof r&&(r.parentNode||r.jquery)){var s=r.jquery?r[0]:r,t={};a(b).data("blockUI.history",t),t.el=s,t.parent=s.parentNode,t.display=s.style.display,t.position=s.style.position,t.parent&&t.parent.removeChild(s)}a(b).data("blockUI.onUnblock",d.onUnblock);var u,v,w,x,y=d.baseZ;u=a(k||d.forceIframe?'<iframe class="blockUI" style="z-index:'+y++ +';display:none;border:none;margin:0;padding:0;position:absolute;width:100%;height:100%;top:0;left:0" src="'+d.iframeSrc+'"></iframe>':'<div class="blockUI" style="display:none"></div>'),v=a(d.theme?'<div class="blockUI blockOverlay ui-widget-overlay" style="z-index:'+y++ +';display:none"></div>':'<div class="blockUI blockOverlay" style="z-index:'+y++ +';display:none;border:none;margin:0;padding:0;width:100%;height:100%;top:0;left:0"></div>'),d.theme&&q?(x='<div class="blockUI '+d.blockMsgClass+' blockPage ui-dialog ui-widget ui-corner-all" style="z-index:'+(y+10)+';display:none;position:fixed">',d.title&&(x+='<div class="ui-widget-header ui-dialog-titlebar ui-corner-all blockTitle">'+(d.title||"&nbsp;")+"</div>"),x+='<div class="ui-widget-content ui-dialog-content"></div>',x+="</div>"):d.theme?(x='<div class="blockUI '+d.blockMsgClass+' blockElement ui-dialog ui-widget ui-corner-all" style="z-index:'+(y+10)+';display:none;position:absolute">',d.title&&(x+='<div class="ui-widget-header ui-dialog-titlebar ui-corner-all blockTitle">'+(d.title||"&nbsp;")+"</div>"),x+='<div class="ui-widget-content ui-dialog-content"></div>',x+="</div>"):x=q?'<div class="blockUI '+d.blockMsgClass+' blockPage" style="z-index:'+(y+10)+';display:none;position:fixed"></div>':'<div class="blockUI '+d.blockMsgClass+' blockElement" style="z-index:'+(y+10)+';display:none;position:absolute"></div>',w=a(x),r&&(d.theme?(w.css(p),w.addClass("ui-widget-content")):w.css(f)),d.theme||v.css(d.overlayCSS),v.css("position",q?"fixed":"absolute"),(k||d.forceIframe)&&u.css("opacity",0);var z=[u,v,w],A=a(q?"body":b);a.each(z,function(){this.appendTo(A)}),d.theme&&d.draggable&&a.fn.draggable&&w.draggable({handle:".ui-dialog-titlebar",cancel:"li"});var B=m&&(!a.support.boxModel||a("object,embed",q?null:b).length>0);if(l||B){if(q&&d.allowBodyStretch&&a.support.boxModel&&a("html,body").css("height","100%"),(l||!a.support.boxModel)&&!q)var C=i(b,"borderTopWidth"),D=i(b,"borderLeftWidth"),E=C?"(0 - "+C+")":0,F=D?"(0 - "+D+")":0;a.each(z,function(a,b){var c=b[0].style;if(c.position="absolute",2>a)q?c.setExpression("height","Math.max(document.body.scrollHeight, document.body.offsetHeight) - (jQuery.support.boxModel?0:"+d.quirksmodeOffsetHack+') + "px"'):c.setExpression("height",'this.parentNode.offsetHeight + "px"'),q?c.setExpression("width",'jQuery.support.boxModel && document.documentElement.clientWidth || document.body.clientWidth + "px"'):c.setExpression("width",'this.parentNode.offsetWidth + "px"'),F&&c.setExpression("left",F),E&&c.setExpression("top",E);else if(d.centerY)q&&c.setExpression("top",'(document.documentElement.clientHeight || document.body.clientHeight) / 2 - (this.offsetHeight / 2) + (blah = document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop) + "px"'),c.marginTop=0;else if(!d.centerY&&q){var e=d.css&&d.css.top?parseInt(d.css.top,10):0,f="((document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop) + "+e+') + "px"';c.setExpression("top",f)}})}if(r&&(d.theme?w.find(".ui-widget-content").append(r):w.append(r),(r.jquery||r.nodeType)&&a(r).show()),(k||d.forceIframe)&&d.showOverlay&&u.show(),d.fadeIn){var G=d.onBlock?d.onBlock:j,H=d.showOverlay&&!r?G:j,I=r?G:j;d.showOverlay&&v._fadeIn(d.fadeIn,H),r&&w._fadeIn(d.fadeIn,I)}else d.showOverlay&&v.show(),r&&w.show(),d.onBlock&&d.onBlock();if(e(1,b,d),q?(n=w[0],o=a(d.focusableElements,n),d.focusInput&&setTimeout(g,20)):h(w[0],d.centerX,d.centerY),d.timeout){var J=setTimeout(function(){q?a.unblockUI(d):a(b).unblock(d)},d.timeout);a(b).data("blockUI.timeout",J)}}}function c(b,c){var f,g=b==window,h=a(b),i=h.data("blockUI.history"),j=h.data("blockUI.timeout");j&&(clearTimeout(j),h.removeData("blockUI.timeout")),c=a.extend({},a.blockUI.defaults,c||{}),e(0,b,c),null===c.onUnblock&&(c.onUnblock=h.data("blockUI.onUnblock"),h.removeData("blockUI.onUnblock"));var k;k=g?a("body").children().filter(".blockUI").add("body > .blockUI"):h.find(">.blockUI"),c.cursorReset&&(k.length>1&&(k[1].style.cursor=c.cursorReset),k.length>2&&(k[2].style.cursor=c.cursorReset)),g&&(n=o=null),c.fadeOut?(f=k.length,k.stop().fadeOut(c.fadeOut,function(){0===--f&&d(k,i,c,b)})):d(k,i,c,b)}function d(b,c,d,e){var f=a(e);if(!f.data("blockUI.isBlocked")){b.each(function(){this.parentNode&&this.parentNode.removeChild(this)}),c&&c.el&&(c.el.style.display=c.display,c.el.style.position=c.position,c.parent&&c.parent.appendChild(c.el),f.removeData("blockUI.history")),f.data("blockUI.static")&&f.css("position","static"),"function"==typeof d.onUnblock&&d.onUnblock(e,d);var g=a(document.body),h=g.width(),i=g[0].style.width;g.width(h-1).width(h),g[0].style.width=i}}function e(b,c,d){var e=c==window,g=a(c);if((b||(!e||n)&&(e||g.data("blockUI.isBlocked")))&&(g.data("blockUI.isBlocked",b),e&&d.bindEvents&&(!b||d.showOverlay))){var h="mousedown mouseup keydown keypress keyup touchstart touchend touchmove";b?a(document).bind(h,d,f):a(document).unbind(h,f)}}function f(b){if("keydown"===b.type&&b.keyCode&&9==b.keyCode&&n&&b.data.constrainTabKey){var c=o,d=!b.shiftKey&&b.target===c[c.length-1],e=b.shiftKey&&b.target===c[0];if(d||e)return setTimeout(function(){g(e)},10),!1}var f=b.data,h=a(b.target);return h.hasClass("blockOverlay")&&f.onOverlayClick&&f.onOverlayClick(),h.parents("div."+f.blockMsgClass).length>0?!0:0===h.parents().children().filter("div.blockUI").length}function g(a){if(o){var b=o[a===!0?o.length-1:0];b&&b.focus()}}function h(a,b,c){var d=a.parentNode,e=a.style,f=(d.offsetWidth-a.offsetWidth)/2-i(d,"borderLeftWidth"),g=(d.offsetHeight-a.offsetHeight)/2-i(d,"borderTopWidth");b&&(e.left=f>0?f+"px":"0"),c&&(e.top=g>0?g+"px":"0")}function i(b,c){return parseInt(a.css(b,c),10)||0}a.fn._fadeIn=a.fn.fadeIn;var j=a.noop||function(){},k=/MSIE/.test(navigator.userAgent),l=/MSIE 6.0/.test(navigator.userAgent)&&!/MSIE 8.0/.test(navigator.userAgent);document.documentMode||0;var m=a.isFunction(document.createElement("div").style.setExpression);a.blockUI=function(a){b(window,a)},a.unblockUI=function(a){c(window,a)},a.growlUI=function(b,c,d,e){var f=a('<div class="growlUI"></div>');b&&f.append("<h1>"+b+"</h1>"),c&&f.append("<h2>"+c+"</h2>"),void 0===d&&(d=3e3);var g=function(b){b=b||{},a.blockUI({message:f,fadeIn:"undefined"!=typeof b.fadeIn?b.fadeIn:700,fadeOut:"undefined"!=typeof b.fadeOut?b.fadeOut:1e3,timeout:"undefined"!=typeof b.timeout?b.timeout:d,centerY:!1,showOverlay:!1,onUnblock:e,css:a.blockUI.defaults.growlCSS})};g(),f.css("opacity"),f.mouseover(function(){g({fadeIn:0,timeout:3e4});var b=a(".blockMsg");b.stop(),b.fadeTo(300,1)}).mouseout(function(){a(".blockMsg").fadeOut(1e3)})},a.fn.block=function(c){if(this[0]===window)return a.blockUI(c),this;var d=a.extend({},a.blockUI.defaults,c||{});return this.each(function(){var b=a(this);d.ignoreIfBlocked&&b.data("blockUI.isBlocked")||b.unblock({fadeOut:0})}),this.each(function(){"static"==a.css(this,"position")&&(this.style.position="relative",a(this).data("blockUI.static",!0)),this.style.zoom=1,b(this,c)})},a.fn.unblock=function(b){return this[0]===window?(a.unblockUI(b),this):this.each(function(){c(this,b)})},a.blockUI.version=2.65,a.blockUI.defaults={message:"<h1>Please wait...</h1>",title:null,draggable:!0,theme:!1,css:{padding:0,margin:0,width:"30%",top:"40%",left:"35%",textAlign:"center",color:"#000",border:"3px solid #aaa",backgroundColor:"#fff",cursor:"wait"},themedCSS:{width:"30%",top:"40%",left:"35%"},overlayCSS:{backgroundColor:"#000",opacity:.6,cursor:"wait"},cursorReset:"default",growlCSS:{width:"350px",top:"10px",left:"",right:"10px",border:"none",padding:"5px",opacity:.6,cursor:"default",color:"#fff",backgroundColor:"#000","-webkit-border-radius":"10px","-moz-border-radius":"10px","border-radius":"10px"},iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank",forceIframe:!1,baseZ:1e3,centerX:!0,centerY:!0,allowBodyStretch:!0,bindEvents:!0,constrainTabKey:!0,fadeIn:200,fadeOut:400,timeout:0,showOverlay:!0,focusInput:!0,focusableElements:":input:enabled:visible",onBlock:null,onUnblock:null,onOverlayClick:null,quirksmodeOffsetHack:4,blockMsgClass:"blockMsg",ignoreIfBlocked:!1};var n=null,o=[]}"function"==typeof define&&define.amd&&define.amd.jQuery?define(["jquery"],a):a(b)}(),function(a){var b=a.blockUI.defaults;a.extend(b.css,{border:"none",padding:"15px",backgroundColor:"#888","-webkit-border-radius":"10px","-moz-border-radius":"10px",opacity:.75,color:"#EEE","font-weight":"bold",top:"200px"}),b.centerY=!1,a.extend(b.overlayCSS,{backgroundColor:"#FFF",opacity:.7}),a.extend(b.growlCSS,{opacity:1,backgroundColor:"#000"})}(b),function(a){var b=0;a.widget("ech.multiselect",{options:{header:!0,height:175,minWidth:225,classes:"",checkAllText:"Check all",uncheckAllText:"Uncheck all",noneSelectedText:"Select options",selectedText:"# selected",selectedList:0,show:null,hide:null,autoOpen:!1,multiple:!0,position:{}},_create:function(){var b=this.element.hide(),c=this.options;this.speed=a.fx.speeds._default,this._isOpen=!1,b=(this.button=a('<div type="button"><span class="ui-icon ui-icon-triangle-2-n-s"></span></div>')).addClass("ui-multiselect ui-widget ui-state-default ui-corner-all").addClass(c.classes).attr({title:b.attr("title"),"aria-haspopup":!0,tabIndex:b.attr("tabIndex")}).insertAfter(b),(this.buttonlabel=a("<span />")).html(c.noneSelectedText).appendTo(b);var b=(this.menu=a("<div />")).addClass("ui-multiselect-menu ui-widget ui-widget-content ui-corner-all").addClass(c.classes).appendTo(document.body),d=(this.header=a("<div />")).addClass("ui-widget-header ui-corner-all ui-multiselect-header ui-helper-clearfix").appendTo(b);(this.headerLinkContainer=a("<ul />")).addClass("ui-helper-reset").html(function(){return!0===c.header?'<li><a class="ui-multiselect-all" href="#"><span class="ui-icon ui-icon-check"></span><span>'+c.checkAllText+'</span></a></li><li><a class="ui-multiselect-none" href="#"><span class="ui-icon ui-icon-closethick"></span><span>'+c.uncheckAllText+"</span></a></li>":"string"==typeof c.header?"<li>"+c.header+"</li>":""}).append('<li class="ui-multiselect-close"><a href="#" class="ui-multiselect-close"><span class="ui-icon ui-icon-circle-close"></span></a></li>').appendTo(d),(this.checkboxContainer=a("<ul />")).addClass("ui-multiselect-checkboxes ui-helper-reset").appendTo(b),this._bindEvents(),this.refresh(!0),c.multiple||b.addClass("ui-multiselect-single")},_init:function(){!1===this.options.header&&this.header.hide(),this.options.multiple||this.headerLinkContainer.find(".ui-multiselect-all, .ui-multiselect-none").hide(),this.options.autoOpen&&this.open(),this.element.is(":disabled")&&this.disable()},refresh:function(c){var d=this.element,e=this.options,f=this.menu,g=this.checkboxContainer,h=[],i="",j=d.attr("id")||b++;d.find("option").each(function(b){a(this);var c,d=this.parentNode,f=this.innerHTML,g=this.title,k=this.value,b="ui-multiselect-"+(this.id||j+"-option-"+b),l=this.disabled,m=this.selected,n=["ui-corner-all"],o=(l?"ui-multiselect-disabled ":" ")+this.className;"OPTGROUP"===d.tagName&&(c=d.getAttribute("label"),-1===a.inArray(c,h)&&(i+='<li class="ui-multiselect-optgroup-label '+d.className+'"><a href="#">'+c+"</a></li>",h.push(c))),l&&n.push("ui-state-disabled"),m&&!e.multiple&&n.push("ui-state-active"),i+='<li class="'+o+'">',i+='<label for="'+b+'" title="'+g+'" class="'+n.join(" ")+'">',i+='<input id="'+b+'" name="multiselect_'+j+'" type="'+(e.multiple?"checkbox":"radio")+'" value="'+k+'" title="'+f+'"',m&&(i+=' checked="checked"',i+=' aria-selected="true"'),l&&(i+=' disabled="disabled"',i+=' aria-disabled="true"'),i+=" /><span>"+f+"</span></label></li>"}),g.html(i),this.labels=f.find("label"),this.inputs=this.labels.children("input"),this._setButtonWidth(),this._setMenuWidth(),this.button[0].defaultValue=this.update(),c||this._trigger("refresh")},update:function(){var b=this.options,c=this.inputs,d=c.filter(":checked"),e=d.length,b=0===e?b.noneSelectedText:a.isFunction(b.selectedText)?b.selectedText.call(this,e,c.length,d.get()):/\d/.test(b.selectedList)&&0<b.selectedList&&e<=b.selectedList?d.map(function(){return a(this).next().html()}).get().join(", "):b.selectedText.replace("#",e).replace("#",c.length);return this.buttonlabel.html(b),b},_bindEvents:function(){function b(){return c[c._isOpen?"close":"open"](),!1}var c=this,d=this.button;d.find("span").bind("click.multiselect",b),d.bind({click:b,keypress:function(a){switch(a.which){case 27:case 38:case 37:c.close();break;case 39:case 40:c.open()}},mouseenter:function(){d.hasClass("ui-state-disabled")||a(this).addClass("ui-state-hover-")},mouseleave:function(){a(this).removeClass("ui-state-hover-")},focus:function(){d.hasClass("ui-state-disabled")||a(this).addClass("ui-state-focus")},blur:function(){a(this).removeClass("ui-state-focus")}}),this.header.delegate("a","click.multiselect",function(b){a(this).hasClass("ui-multiselect-close")?c.close():c[a(this).hasClass("ui-multiselect-all")?"checkAll":"uncheckAll"](),b.preventDefault()}),this.menu.delegate("li.ui-multiselect-optgroup-label a","click.multiselect",function(b){b.preventDefault();var d=a(this),e=d.parent().nextUntil("li.ui-multiselect-optgroup-label").find("input:visible:not(:disabled)"),f=e.get(),d=d.parent().text();!1!==c._trigger("beforeoptgrouptoggle",b,{inputs:f,label:d})&&(c._toggleChecked(e.filter(":checked").length!==e.length,e),c._trigger("optgrouptoggle",b,{inputs:f,label:d,checked:f[0].checked}))}).delegate("label","mouseenter.multiselect",function(){a(this).hasClass("ui-state-disabled")||(c.labels.removeClass("ui-state-hover-"),a(this).addClass("ui-state-hover-").find("input").focus())}).delegate("label","keydown.multiselect",function(b){switch(b.preventDefault(),b.which){case 9:case 27:c.close();break;case 38:case 40:case 37:case 39:c._traverse(b.which,this);break;case 13:a(this).find("input")[0].click()}}).delegate('input[type="checkbox"], input[type="radio"]',"click.multiselect",function(b){var d=a(this),e=this.value,f=this.checked,g=c.element.find("option");this.disabled||!1===c._trigger("click",b,{value:e,text:this.title,checked:f})?b.preventDefault():(d.focus(),d.attr("aria-selected",f),g.each(function(){this.value===e?this.selected=f:c.options.multiple||(this.selected=!1)}),c.options.multiple||(c.labels.removeClass("ui-state-active"),d.closest("label").toggleClass("ui-state-active",f),c.close()),c.element.trigger("change"),setTimeout(a.proxy(c.update,c),10))}),a(document).bind("mousedown.multiselect",function(b){c._isOpen&&!a.contains(c.menu[0],b.target)&&!a.contains(c.button[0],b.target)&&b.target!==c.button[0]&&c.close()}),a(this.element[0].form).bind("reset.multiselect",function(){setTimeout(a.proxy(c.refresh,c),10)})},_setButtonWidth:function(){var a=this.element.outerWidth(),b=this.options;/\d/.test(b.minWidth)&&a<b.minWidth&&(a=b.minWidth),this.button.css("width","100%")},_setMenuWidth:function(){{var a=this.menu;this.button.outerWidth()-parseInt(a.css("padding-left"),10)-parseInt(a.css("padding-right"),10)-parseInt(a.css("border-right-width"),10)-parseInt(a.css("border-left-width"),10)}},_traverse:function(b,c){var d=a(c),e=38===b||37===b,d=d.parent()[e?"prevAll":"nextAll"]("li:not(.ui-multiselect-disabled, .ui-multiselect-optgroup-label)")[e?"last":"first"]();d.length?d.find("label").trigger("mouseover"):(d=this.menu.find("ul").last(),this.menu.find("label")[e?"last":"first"]().trigger("mouseover"),d.scrollTop(e?d.height():0))},_toggleState:function(a,b){return function(){this.disabled||(this[a]=b),b?this.setAttribute("aria-selected",!0):this.removeAttribute("aria-selected")}},_toggleChecked:function(b,c){var d=c&&c.length?c:this.inputs,e=this;d.each(this._toggleState("checked",b)),d.eq(0).focus(),this.update();var f=d.map(function(){return this.value}).get();this.element.find("option").each(function(){!this.disabled&&-1<a.inArray(this.value,f)&&e._toggleState("selected",b).call(this)}),d.length&&this.element.trigger("change")},_toggleDisabled:function(b){this.button.attr({disabled:b,"aria-disabled":b})[b?"addClass":"removeClass"]("ui-state-disabled");var c=this.menu.find("input"),c=b?c.filter(":enabled").data("ech-multiselect-disabled",!0):c.filter(function(){return!0===a.data(this,"ech-multiselect-disabled")}).removeData("ech-multiselect-disabled");c.attr({disabled:b,"arial-disabled":b}).parent()[b?"addClass":"removeClass"]("ui-state-disabled"),this.element.attr({disabled:b,"aria-disabled":b})},open:function(){var b=this.button,c=this.menu,d=this.speed,e=this.options,f=[];if(!1!==this._trigger("beforeopen")&&!b.hasClass("ui-state-disabled")&&!this._isOpen){var g=c.find("ul").last(),h=e.show,i=b.offset();a.isArray(e.show)&&(h=e.show[0],d=e.show[1]||this.speed),h&&(f=[h,d]),g.scrollTop(0).height(e.height),a.ui.position&&!a.isEmptyObject(e.position)?(e.position.of=e.position.of||b,c.show().position(e.position).hide()):c.css({top:i.top+b.outerHeight(),left:i.left}),a.fn.show.apply(c,f),this.labels.eq(0).trigger("mouseover").trigger("mouseenter").find("input").trigger("focus"),b.addClass("ui-state-active"),this._isOpen=!0,this._trigger("open")}},close:function(){if(!1!==this._trigger("beforeclose")){var b=this.options,c=b.hide,d=this.speed,e=[];a.isArray(b.hide)&&(c=b.hide[0],d=b.hide[1]||this.speed),c&&(e=[c,d]),a.fn.hide.apply(this.menu,e),this.button.removeClass("ui-state-active").trigger("blur").trigger("mouseleave"),this._isOpen=!1,this._trigger("close")}},enable:function(){this._toggleDisabled(!1)},disable:function(){this._toggleDisabled(!0)},checkAll:function(){this._toggleChecked(!0),this._trigger("checkAll")},uncheckAll:function(){this._toggleChecked(!1),this._trigger("uncheckAll")},getChecked:function(){return this.menu.find("input").filter(":checked")},destroy:function(){return a.Widget.prototype.destroy.call(this),this.button.remove(),this.menu.remove(),this.element.show(),this},isOpen:function(){return this._isOpen},widget:function(){return this.menu},getButton:function(){return this.button},_setOption:function(b,c){var d=this.menu;switch(b){case"header":d.find("div.ui-multiselect-header")[c?"show":"hide"]();break;case"checkAllText":d.find("a.ui-multiselect-all span").eq(-1).text(c);break;case"uncheckAllText":d.find("a.ui-multiselect-none span").eq(-1).text(c);break;case"height":d.find("ul").last().height(parseInt(c,10));break;case"minWidth":this.options[b]=parseInt(c,10),this._setButtonWidth(),this._setMenuWidth();break;case"selectedText":case"selectedList":case"noneSelectedText":this.options[b]=c,this.update();break;case"classes":d.add(this.button).removeClass(this.options.classes).addClass(c);break;case"multiple":d.toggleClass("ui-multiselect-single",!c),this.options.multiple=c,this.element[0].multiple=c,this.refresh()}a.Widget.prototype._setOption.apply(this,arguments)}})}(b),function(a){var b=/[\-\[\]{}()*+?.,\\\^$|#\s]/g;a.widget("ech.multiselectfilter",{options:{label:"Filter:",width:null,placeholder:"Enter keywords",autoReset:!1},_create:function(){var b=this.options,c=a(this.element),d=this.instance=c.data("echMultiselect")||c.data("multiselect")||c.data("ech-multiselect");this.header=d.menu.find(".ui-multiselect-header").addClass("ui-multiselect-hasfilter");var e=this.wrapper=a('<div class="ui-multiselect-filter">'+(b.label.length?b.label:"")+'<input placeholder="'+b.placeholder+'" type="search"'+(/\d/.test(b.width)?'style="width:'+b.width+'px"':"")+" /></div>").prependTo(this.header);this.inputs=d.menu.find('input[type="checkbox"], input[type="radio"]'),this.input=e.find("input").bind({keydown:function(a){13===a.which&&a.preventDefault()},keyup:a.proxy(this._handler,this),click:a.proxy(this._handler,this)}),this.updateCache(),d._toggleChecked=function(b,c){var e=c&&c.length?c:this.labels.find("input"),f=this,g=d._isOpen?":disabled, :hidden":":disabled";e=e.not(g).each(this._toggleState("checked",b)),this.update();var h=e.map(function(){return this.value}).get();this.element.find("option").filter(function(){!this.disabled&&a.inArray(this.value,h)>-1&&f._toggleState("selected",b).call(this)}),e.length&&this.element.trigger("change")};var f=a(document).bind("multiselectrefresh",a.proxy(function(){this.updateCache(),this._handler()},this));this.options.autoReset&&f.bind("multiselectclose",a.proxy(this._reset,this))},_handler:function(c){var d=a.trim(this.input[0].value.toLowerCase()),e=this.rows,f=this.inputs,g=this.cache;if(d){e.hide();var h=RegExp(d.replace(b,"\\$&"),"gi");this._trigger("filter",c,a.map(g,function(a,b){return-1!==a.search(h)?(e.eq(b).show(),f.get(b)):null}))}else e.show();this.instance.menu.find(".ui-multiselect-optgroup-label").each(function(){var b=a(this),c=b.nextUntil(".ui-multiselect-optgroup-label").filter(function(){return"none"!==a.css(this,"display")}).length;b[c?"show":"hide"]()})},_reset:function(){this.input.val("").trigger("keyup")},updateCache:function(){this.rows=this.instance.menu.find(".ui-multiselect-checkboxes li:not(.ui-multiselect-optgroup-label)"),this.cache=this.element.children().map(function(){var b=a(this);return"optgroup"===this.tagName.toLowerCase()&&(b=b.children()),b.map(function(){return this.innerHTML.toLowerCase()}).get()}).get()},widget:function(){return this.wrapper},destroy:function(){a.Widget.prototype.destroy.call(this),this.input.val("").trigger("keyup"),this.wrapper.remove()}})}(b),void 0===b.when.all&&(b.when.all=function(a){var c=new b.Deferred;return b.when.apply(b,a).then(function(){c.resolve(Array.prototype.slice.call(arguments))},function(){c.reject(Array.prototype.slice.call(arguments))}),c}),function(a){a.number=function(a,b,c,d){d=void 0===d?",":d,c=void 0===c?".":c,b=isFinite(+b)?Math.abs(b):0;var e="\\u"+("0000"+c.charCodeAt(0).toString(16)).substr(-4);a=(a+"").replace(RegExp(e,"g"),".").replace(RegExp("[^0-9+-Ee.]","g"),"");var f=isFinite(+a)?+a:0,g="",h=function(a,b){var c=Math.pow(10,b);return""+Math.round(a*c)/c};return g=(b?h(f,b):""+Math.round(f)).split("."),g[0].length>3&&(g[0]=g[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,d)),b>(g[1]||"").length&&(g[1]=g[1]||"",g[1]+=Array(b-g[1].length+1).join("0")),g.join(c)}}(b),function(a){a.fn.setCursorPosition=function(a){return this.each(function(b,c){if(c.setSelectionRange)c.setSelectionRange(a,a);else if(c.createTextRange){var d=c.createTextRange();d.collapse(!0),d.moveEnd("character",a),d.moveStart("character",a),d.select()}}),this},a.fn.getCursorPosition=function(){var b=a(this).get(0),c=0;if("selectionStart"in b)c=b.selectionStart;else if("selection"in document){b.focus();var d=document.selection.createRange(),e=document.selection.createRange().text.length;d.moveStart("character",-b.value.length),c=d.text.length-e}return c}}(b),d.load=function(a,b,c){function d(){}function e(a){return Object(a)===a}function f(a){return"string"==typeof a}function g(){return"yn_"+o++}function h(){m&&m.parentNode||(m=b.getElementsByTagName("script")[0])}function i(a){return!a||"loaded"==a||"complete"==a||"uninitialized"==a}function j(b,c){c.call(a)}function k(a,k){var l,o,p,t,u,v,w=c.Deferred(),x=w.promise();if(f(a)?l=a:e(a)&&(l=a._url||a.src,o=a.attrs,p=a.timeout),k=k||d,o=o||{},!l){var y=new Error("You must provide a valid script to load.");return k(y),w.reject(y),x}if(l in r)return r[l];if(c("script[src='"+l+"']").size())return w.resolve(),j(l,k),x;r[l]=x,t=b.createElement("script"),p=p||s.errorTimeout,t.async=!1,t.src=l,q&&(t.event="onclick",t.id=t.htmlFor=o.id||g());for(v in o)t.setAttribute(v,o[v]);return t.onreadystatechange=t.onload=function(){if(!u&&i(t.readyState)){if(u=1,q)try{t.onclick()}catch(a){}j(l,k),w.resolve()}t.onload=t.onreadystatechange=t.onerror=null},t.onerror=function(){u=1;var a=new Error("Script Error: "+l);k(a),w.reject(a)},n(function(){if(!u){u=1;var a=new Error("Timeout: "+l);k(a),w.reject(a),t.parentNode.removeChild(t)}},p),h(),m.parentNode.insertBefore(t,m),x}function l(g,i){var j,k,l,o={},p=c.Deferred(),q=p.promise();if(e(g)?(j=g._url||g.href,o=g.attrs||{}):f(g)&&(j=g),i=i||d,c("link[href='"+j+"']").size())return p.resolve(),i.call(a),q;l=b.createElement("link"),l.href=j,l.rel="stylesheet",l.media="only x",l.type=o.type||"text/css",n(function(){l.media=o.media||"all"});for(k in o)l.setAttribute(k,o[k]);return g&&g.insertBefore?g.insertBefore.parentNode.insertBefore(l,g.insertBefore):g&&g.insertAfter?g.insertAfter.parentNode.insertBefore(l,g.insertAfter.nextSibling):(h(),m.parentNode.appendChild(l)),n(function(){p.resolve(),i.call(a)}),q}var m,n=a.setTimeout,o=0,p={}.toString,q=!(!b.attachEvent||a.opera&&"[object Opera]"==p.call(a.opera)),r={},s={errorTimeout:1e4,js:k,css:l};return s}(window,document,b),function(a){function b(b){this.$textarea=a(b),this._init()}b.prototype={_init:function(){var b=this;this.$textarea.wrap('<div class="flex-text-wrap" />').before("<pre><span /><br /><br /></pre>"),this.$span=this.$textarea.prev().find("span"),this.$textarea.on("input propertychange keyup change",function(){b._mirror()}),a.valHooks.textarea={get:function(a){return a.value.replace(/\r?\n/g,"\r\n")}},this._mirror()},_mirror:function(){this.$span.text(this.$textarea.val())}},a.fn.flexText=function(){return this.each(function(){a.data(this,"flexText")||a.data(this,"flexText",new b(this))})}}(b),Array.prototype.reduce||(Array.prototype.reduce=function(a){"use strict";if(null==this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof a)throw new TypeError(a+" is not a function");var b,c=Object(this),d=c.length>>>0,e=0;if(2==arguments.length)b=arguments[1];else{for(;d>e&&!(e in c);)e++;if(e>=d)throw new TypeError("Reduce of empty array with no initial value");b=c[e++]}for(;d>e;e++)e in c&&(b=a(b,c[e],e,c));return b}),b.fn.extend({insertAtCaret:function(a){return this.each(function(){if(document.selection)this.focus(),sel=document.selection.createRange(),sel.text=a,this.focus();else if(this.selectionStart||"0"==this.selectionStart){var b=this.selectionStart,c=this.selectionEnd,d=this.scrollTop;this.value=this.value.substring(0,b)+a+this.value.substring(c,this.value.length),this.focus(),this.selectionStart=b+a.length,this.selectionEnd=b+a.length,this.scrollTop=d}else this.value+=a,this.focus()})}})}(window.skuid,window.jQuery),window.sforce=window.sforce||{},sforce.internal={},sforce.StringBuffer=function(){this.buffer=[],this.append=function(a){return this.buffer.push(a),this},this.toString=function(){return this.buffer.join("")}},sforce.Base64Binary=function(a){this.input=a},sforce.Base64Binary.prototype.keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",sforce.Base64Binary.prototype.toString=function(){var a,b,c,d,e,f=[],g="",h="",i=0;do a=this.input.charCodeAt(i++),b=this.input.charCodeAt(i++),g=this.input.charCodeAt(i++),c=a>>2,d=(3&a)<<4|b>>4,e=(15&b)<<2|g>>6,h=63&g,isNaN(b)?e=h=64:isNaN(g)&&(h=64),f.push(this.keyStr.charAt(c)+this.keyStr.charAt(d)+this.keyStr.charAt(e)+this.keyStr.charAt(h)),a=b=g="",c=d=e=h="";while(i<this.input.length);return f.join("")},sforce.Base64Binary.prototype.decode=function(a){var b,c,d,e,f,g=[],h="",i="",j=0,k=/[^A-Za-z0-9\+\/\=]/g;k.exec(a)&&alert("There were invalid base64 characters in the input text.\nValid base64 characters are A-Z, a-z, 0-9, '+', '/', and '='\nExpect errors in decoding."),a=a.replace(/[^A-Za-z0-9\+\/\=]/g,"");do d=this.keyStr.indexOf(a.charAt(j++)),e=this.keyStr.indexOf(a.charAt(j++)),f=this.keyStr.indexOf(a.charAt(j++)),i=this.keyStr.indexOf(a.charAt(j++)),b=d<<2|e>>4,c=(15&e)<<4|f>>2,h=(3&f)<<6|i,g.push(String.fromCharCode(b)),64!=f&&g.push(String.fromCharCode(c)),64!=i&&g.push(String.fromCharCode(h)),b=c=h="",d=e=f=i="";while(j<a.length);return g.join("")},sforce.internal.dateToString=function(a){var b=a,c=b.getFullYear(),d=b.getMonth()+1,e=b.getDate();return c+"-"+d+"-"+e},sforce.internal.dateTimeToString=function(a){var b=a,c=b.getFullYear(),d=b.getMonth()+1,e=b.getDate(),f=b.getHours(),g=b.getMinutes(),h=b.getSeconds(),i=b.getTimezoneOffset(),j=0>i?"+":"-";i=Math.abs(i);var k=i/60,l=i%60;9>=h&&(h="0"+h);var m=b.getMilliseconds();0!==m&&(m="."+m,m.length>4&&(m=m.substring(0,4)),h+=m);var n;return 0===i?n="Z":(10>l&&(l="0"+l),10>k&&(k="0"+k),n=j+k+":"+l),9>=d&&(d="0"+d),9>=e&&(e="0"+e),9>=f&&(f="0"+f),9>=g&&(g="0"+g),c+"-"+d+"-"+e+"T"+f+":"+g+":"+h+n},sforce.internal.stringToDate=function(a){var b=!1;if(null===a||0===a.length)throw"Unable to parse dateTime";if("+"==a.charAt(0)&&(a=a.substring(1)),"-"==a.charAt(0)&&(a=a.substring(1),b=!0),10!=a.length)throw"Unable to parse date, "+a+" length != 10";if("-"!=a.charAt(4)||"-"!=a.charAt(7))throw"Unable to parse date";var c=a.substring(0,4),d=a.substring(5,7),e=a.substring(8,10),f=new Date(c,d-1,e,0,0,0);return f.setMilliseconds(0),f},sforce.internal.stringToDateTime=function(a){var b=!1;if(null===a||0===a.length)throw"Unable to parse dateTime";if("+"==a.charAt(0)&&(a=a.substring(1)),"-"==a.charAt(0)&&(a=a.substring(1),b=!0),a.length<19)throw"Unable to parse dateTime";if("-"!=a.charAt(4)||"-"!=a.charAt(7)||"T"!=a.charAt(10))throw"Unable to parse dateTime";if(":"!=a.charAt(13)||":"!=a.charAt(16))throw"Unable to parse dateTime";var c=a.substring(0,4),d=a.substring(5,7),e=a.substring(8,10),f=a.substring(11,13),g=a.substring(14,16),h=a.substring(17,19),i=new Date(c,d-1,e,f,g,h),j=19;if(j<a.length&&"."==a.charAt(j)){for(var k=0,l=++j;j<a.length&&sforce.internal.isDigit(a.charAt(j));)j++;var m=a.substring(l,j);3==m.length?k=m:m.length<3?k=(m+"000").substring(0,3):(k=m.substring(0,3),m.charAt(3)>="5"&&++k),i.setMilliseconds(k)}var n=6e4*i.getTimezoneOffset();if(j+5<a.length&&("+"==a.charAt(j)||"-"==a.charAt(j))){if(!(sforce.internal.isDigit(a.charAt(j+1))&&sforce.internal.isDigit(a.charAt(j+2))&&":"==a.charAt(j+3)&&sforce.internal.isDigit(a.charAt(j+4))&&sforce.internal.isDigit(a.charAt(j+5))))throw"Unable to parse dateTime";var o=10*(a.charAt(j+1)-"0")+a.charAt(j+2)-"0",p=10*(a.charAt(j+4)-"0")+a.charAt(j+5)-"0",q=6e4*(60*o+p);"+"==a.charAt(j)&&(q=-q),i=new Date(i.getTime()-n+q),j+=6}if(j<a.length&&"Z"==a.charAt(j)&&(j++,i=new Date(i.getTime()-n)),j<a.length)throw"Unable to parse dateTime";return i},sforce.internal.isDigit=function(a){return"0"==a||"1"==a||"2"==a||"3"==a||"4"==a||"5"==a||"6"==a||"7"==a||"8"==a||"9"==a?!0:!1},sforce.Xml=function(){},sforce.Xml.prototype.toXml=function(a,b,c){c.writeStartElement(b,a),this._xsiType&&c.writeXsiType(this._xsiType);for(var d in this)if("_name"==d||"_xsiType"==d);else{var e=this[d];if("function"!=typeof e)if("array"==typeof e)for(var f=0;f<e.length;f++)this.writeValue(a,c,d,e[f]);else this.writeValue(a,c,d,e)}c.writeEndElement(b,a)},sforce.Xml.prototype.writeValue=function(a,b,c,d){return null===d?void b.writeNameValueNode("fieldsToNull",c):void("undefined"!=typeof d&&(d.toXml?d.toXml(a,c,b):b.writeNameValueNode(c,d)))},sforce.Xml.prototype.get=function(a){return this[a]?this[a]:null},sforce.Xml.prototype.set=function(a,b){this[a]=b},sforce.Xml.prototype.getArray=function(a){var b=this[a];return b?b.join?b:[b]:[]},sforce.Xml.prototype.getBoolean=function(a){return"true"==this[a]?!0:!1},sforce.Xml.prototype.getDate=function(a){return this[a]?this[a].getFullYear?this[a]:sforce.internal.stringToDate(this[a]):null},sforce.Xml.prototype.getDateTime=function(a){return this[a]?this[a].getFullYear?this[a]:sforce.internal.stringToDateTime(this[a]):null
},sforce.Xml.prototype.getInt=function(a){if(this[a])return"number"==typeof this[a]?this[a]:parseInt(this[a],10);throw"Unable to parse int field: "+a},sforce.Xml.prototype.getFloat=function(a){if(this[a])return"number"==typeof this[a]?this[a]:parseFloat(this[a]);throw"Unable to parse float field: "+a},sforce.Xml.prototype.getBase64Binary=function(a){if(this[a])return sforce.Base64Binary.prototype.decode(this[a]);throw"Unable to parse base64Binary field: "+a},sforce.Xml.prototype.toString=function(){var a=new sforce.StringBuffer;a.append("{");for(var b in this){var c=this[b];if(c)if("object"==typeof c)a.append(b).append(":").append(c.toString());else if(c.join){a.append(b).append(":").append("[");for(var d=0;d<c.length;d++)a.append(c[d]),d<c.length-1&&a.append(", ");a.append("]")}else{if("function"==typeof c)continue;a.append(b).append(":").append("'"+c+"'")}else a.append(b).append(":").append(""+c);a.append(", ")}return a.append("}"),a.toString()},sforce.internal.Debug=function(){this.output=null,this.trace=!1,this.apexTrace=!1,this.win=null,this.traceQueue=[],this.quiet=!1,this.open=function(){this.println("","print")},this.println=function(a,b){if(!this.quiet){if("function"==typeof println)return void println(a,b);null!==this.win&&this.win.document||(this.output=null,this.win=window.open("undefined"!=typeof window.UserContext?UserContext.getUrl("/soap/ajax/31.0/debugshell.html"):"/soap/ajax/31.0/debugshell.html","","width=800,height=400,toolbar=no,location=no,directories=no,alwaysRaised=yes,status=no,menubar=no,scrollbars=yes,copyhistory=yes,resizable=yes")),null===this.output&&this.findOutput(),null!==this.output?(sforce.debug.traceQueue.length>0&&this.traceCallback(),this.win.println(a,b)):(sforce.debug.traceQueue.push({message:a,type:b}),setTimeout(sforce.debug.traceCallback,1e3))}},this.traceCallback=function(){if(sforce.debug.findOutput(),null===sforce.debug.output)return void setTimeout(sforce.debug.traceCallback,1e3);for(var a=0;a<sforce.debug.traceQueue.length;a++){var b=sforce.debug.traceQueue[a];sforce.debug.win.println(b.message,b.type)}sforce.debug.traceQueue=[]},this.findOutput=function(){return null===this.output&&(this.output=this.win.document.getElementById("output")),this.output},this.logXml=function(a){a=a.replace(/</g,"&lt;"),a=a.replace(/>/g,"&gt;"),a="<textarea cols=80 rows=5 wrap=hard>"+a+"</textarea>",this.println(a,"printxml")},this.log=function(a){this.println(a,"print")},this.logApex=function(a){var b=a.indexOf("<debugLog>"),c=a.indexOf("</debugLog>");-1===b?b=0:b+="<debugLog>".length,-1===c&&(c=a.length);var d=a.substring(b,c);this.println(d,"printxml")}},sforce.debug=new sforce.internal.Debug,sforce.internal._connections=[],sforce.internal.ConnectionHolder=function(a,b){this.connection=a,this.callback=b,this.timedout=!1},sforce.Transport=function(a){this.url=a,this.connection=null,this.newConnection=function(){try{this.connection=new ActiveXObject("Msxml2.XMLHTTP")}catch(a){try{this.connection=new ActiveXObject("Microsoft.XMLHTTP")}catch(a){this.connection=new XMLHttpRequest}}return this.connection},this.send=function(a,b,c,d){this.newConnection(),c&&(this.connection.onreadystatechange=this.httpConnectionCallback);var e=new sforce.internal.ConnectionHolder(this.connection,b);sforce.internal._connections.push(e),this.connection.open("POST",this.url,c),this.connection.setRequestHeader("Content-Type","text/xml; charset=UTF-8"),this.connection.setRequestHeader("SOAPAction",'""'),this.connection.setRequestHeader("Accept","text/xml"),this.connection.send(a),c&&"undefined"!=typeof d&&this.setTimeoutOn(e,d),c||this.httpConnectionCallback()},this.setTimeoutOn=function(a,b){function c(){4!==a.connection.readyState&&(a.timedout=!0,a.connection.abort())}setTimeout(c,b)},this.httpConnectionCallback=function(){for(var a=0;a<sforce.internal._connections.length;a++){var b=sforce.internal._connections[a];if(null!==b)if(b.timedout)sforce.internal._connections[a]=null,sforce.internal._connections.slice(a,1),b.callback.httpCallback("Remote invocation timed out",!1);else if(4==b.connection.readyState){sforce.internal._connections[a]=null,sforce.internal._connections.slice(a,1);var c=200==b.connection.status;sforce.debug.trace&&(sforce.debug.log("Response : status - "+b.connection.status),sforce.debug.logXml(b.connection.responseText)),sforce.debug.apexTrace&&sforce.debug.logApex(b.connection.responseText),b.connection.responseXML&&b.connection.responseXML.documentElement?b.callback.httpCallback(b.connection.responseXML.documentElement,c):b.callback.httpCallback("Remote invocation failed, due to: "+b.connection.responseText+" status code: ",b.connection.status)}}}},sforce.XmlWriter=function(){this.buffer=new sforce.StringBuffer,this.namespaces={},this.prefixCount=0,this.writingStartElement=!1},sforce.XmlWriter.prototype.writeStartElement=function(a,b,c){this.writingStartElement&&this.buffer.append(">"),this.buffer.append("<");var d=!1;b&&(this.namespaces[b]||""===this.namespaces[b]||(d=!0),c||(c=this.getPrefix(b)),null!==c&&""!==c&&(this.buffer.append(c),this.buffer.append(":"))),this.buffer.append(a),d===!0&&this.writeNamespace(b,c),this.writingStartElement=!0},sforce.XmlWriter.prototype.writeEndElement=function(a,b){if(this.writingStartElement)this.buffer.append("/>");else{if(this.buffer.append("</"),b){var c=this.getPrefix(b);c&&""!==c&&(this.buffer.append(c),this.buffer.append(":"))}this.buffer.append(a),this.buffer.append(">")}this.writingStartElement=!1},sforce.XmlWriter.prototype.writeNamespace=function(a,b){b&&""!==b?(this.namespaces[a]=b,this.buffer.append(" "),this.buffer.append("xmlns:"),this.buffer.append(b)):(this.namespaces[a]="",this.buffer.append(" "),this.buffer.append("xmlns")),this.buffer.append('="'),this.buffer.append(a),this.buffer.append('"')},sforce.XmlWriter.prototype.writeText=function(a){if(!this.writingStartElement)throw"Can only write text after a start element";this.buffer.append(">"),this.writingStartElement=!1,"string"==typeof a&&(a=a.replace(/&/g,"&amp;"),a=a.replace(/</g,"&lt;"),a=a.replace(/>/g,"&gt;")),this.buffer.append(a)},sforce.XmlWriter.prototype.writeXsiType=function(a){this.writeNamespace("http://www.w3.org/2001/XMLSchema-instance","xsi"),this.writeAttribute("xsi:type",a)},sforce.XmlWriter.prototype.writeAttribute=function(a,b){this.buffer.append(" "+a+'="'+b+'"')},sforce.XmlWriter.prototype.getPrefix=function(a){var b=this.namespaces[a];return b||""===b?b:(b="ns"+this.prefixCount,this.prefixCount++,this.namespaces[a]=b,b)},sforce.XmlWriter.prototype.toString=function(){return this.buffer.toString()},sforce.XmlWriter.prototype.soapNS="http://schemas.xmlsoap.org/soap/envelope/",sforce.XmlWriter.prototype.startEnvelope=function(){this.writeStartElement("Envelope",this.soapNS,"se")},sforce.XmlWriter.prototype.endEnvelope=function(){this.writeEndElement("Envelope",this.soapNS)},sforce.XmlWriter.prototype.startHeader=function(){this.writeStartElement("Header",this.soapNS,"se")},sforce.XmlWriter.prototype.endHeader=function(){this.writeEndElement("Header",this.soapNS)},sforce.XmlWriter.prototype.startBody=function(){this.writeStartElement("Body",this.soapNS,"se")},sforce.XmlWriter.prototype.endBody=function(){this.writeEndElement("Body",this.soapNS)},sforce.XmlWriter.prototype.writeNameValueNode=function(a,b){if(null===b)return this.writeStartElement(a),this.writeNamespace("http://www.w3.org/2001/XMLSchema-instance","xsi"),this.writeAttribute("xsi:nill","true"),void this.writeEndElement(a);if(b.toUTCString&&(b=sforce.internal.dateTimeToString(b)),"boolean"==typeof b&&(b=b?"true":"false"),b&&b.join)for(var c=0;c<b.length;c++)this.writeStartElement(a),this.writeText(b[c]),this.writeEndElement(a);else this.writeStartElement(a),this.writeText(b),this.writeEndElement(a)},sforce.XmlReader=function(a){this.envelope=a},sforce.XmlReader.prototype.getEnvelope=function(){if(this.isTag("Envelope",this.envelope))return this.envelope;throw"Unable to find soap envelope, but found "+this.envelope.nodeName},sforce.XmlReader.prototype.getBody=function(){return this.getChild("Body",this.envelope)},sforce.XmlReader.prototype.getHeader=function(){return this.getChild("Header",this.envelope)},sforce.XmlReader.prototype.getChild=function(a,b){for(var c=b.childNodes,d=0;d<c.length;d++)if(1==c[d].nodeType&&this.isTag(a,c[d]))return c[d];return null},sforce.XmlReader.prototype.getFirstElement=function(a){for(var b=a.childNodes,c=0;c<b.length;c++)if(1==b[c].nodeType)return b[c];return null},sforce.XmlReader.prototype.isTag=function(a,b){var c=b.nodeName.split(":");return 2==c.length&&c[1]==a?!0:1==c.length&&c[0]==a?!0:!1},sforce.XmlReader.prototype.isNameValueNode=function(a){for(var b=a.childNodes,c=0;c<b.length;c++)if(3!=b[c].nodeType)return!1;return!0},sforce.XmlReader.prototype.getTextValue=function(a){if(3==a.nodeType)return a.nodeValue;var b=a.getAttribute("xsi:nil");if("true"==b)return null;for(var c="",d=a.childNodes,e=0;e<d.length;e++){if(3!=d[e].nodeType)throw"Not a simple name value node";c+=d[e].nodeValue}return c},sforce.XmlReader.prototype.toXmlObject=function(a){var b=a.getAttribute("xsi:nil");if("true"==b)return null;var c=new sforce.Xml,d=[];for(d.push({node:a,obj:c});d.length>0;)for(var e=d.shift(),f=e.node.firstChild;null!==f;f=f.nextSibling)if(1==f.nodeType){var g=f.nodeName,h=g.indexOf(":");g=-1==h?g:g.substring(h+1);for(var i,j=!0,k="",l=f.firstChild;null!==l;l=l.nextSibling){if(3!=l.nodeType){j=!1;break}k+=l.nodeValue}if(j?i="true"==f.getAttribute("xsi:nil")?null:k:(i=new sforce.Xml,d.push({node:f,obj:i})),e.obj[g])if(e.obj[g].push)e.obj[g].push(i);else{var m=e.obj[g];"Id"===g&&m===i||(e.obj[g]=[],e.obj[g].push(m),e.obj[g].push(i))}else e.obj[g]=i}return c},sforce.SoapTransport=function(){this.connectionCallback=null,this.result=null,this.fault=null,this.isAsync=!0,this.isArray=!1},sforce.SoapTransport.prototype.onFailure=function(a){var b="ERROR: ........... ";alert(b+a),this.result=null},sforce.SoapTransport.prototype.send=function(a,b,c,d){this.isArray=c;var e=new sforce.Transport(a);if(this.isAsync=d?!0:!1,!this.isAsync){if(e.send(b.toString(),this,this.isAsync),null!==this.fault)throw this.fault;return this.result}this.connectionCallback=d,e.send(b.toString(),this,this.isAsync,d.timeout)},sforce.SoapTransport.prototype.httpCallback=function(a,b){try{if(b===!0){var c=new sforce.XmlReader(a);c.getEnvelope();var d=c.getBody(),e=c.getFirstElement(d);if(null===e)throw"Unable to find operation response element";for(var f=[],g=e.childNodes,h=0;h<g.length;h++)1==g[h].nodeType&&f.push(c.isNameValueNode(g[h])?c.getTextValue(g[h]):c.toXmlObject(g[h]));if(this.isArray)this.result=f;else{if(f.length>1)throw"Found more than one response: "+f;this.result=f[0]}if(this.isAsync)try{if(this.beforeCallback(),"function"==typeof this.connectionCallback)this.connectionCallback(this.result);else{if(!this.connectionCallback.onSuccess)throw"Unable to find onSuccess method in the callback object";this.connectionCallback.onSuccess(this.result,this.connectionCallback.source)}}finally{this.afterCallback()}}else if("undefined"!=typeof a.nodeName){var i=new sforce.XmlReader(a);i.getEnvelope();var j=i.getBody(),k=i.getFirstElement(j),l=i.toXmlObject(k);this.sendFault(l)}else this.sendFault(a)}catch(m){this.sendFault(m)}},sforce.SoapTransport.prototype.sendFault=function(a){if(this.isAsync)if(this.connectionCallback.onFailure)try{this.beforeCallback(),this.connectionCallback.onFailure(a,this.connectionCallback.source)}finally{this.afterCallback()}else this.onFailure(a);else this.fault=a},sforce.SoapTransport.prototype.beforeCallback=function(){},sforce.SoapTransport.prototype.afterCallback=function(){},sforce.SObject=function(a){this.type=a},sforce.SObject.prototype=new sforce.Xml("sObjects"),sforce.LeadConvert=function(){},sforce.LeadConvert.prototype=new sforce.Xml("leadConverts"),sforce.MergeRequest=function(){},sforce.MergeRequest.prototype=new sforce.Xml("request"),sforce.QuickAction=function(){},sforce.QuickAction.prototype=new sforce.Xml("quickActions"),sforce.MatchOptions=function(){},sforce.MatchOptions.prototype=new sforce.Xml("matchOptions"),sforce.Connection=function(){this.sessionId=null,this.updateMru=null,this.allowFieldTruncation=null,this.disableFeedTracking=null,this.streamingEnabled=null,this.allOrNone=null,this.client=null,this.defaultNamespace=null,this.batchSize=null,this.loginScopeHeader=null,this.emailHeader=null,this.assignmentRuleHeader=null,this.transferToUserId=null,this.debuggingHeader=null,this.serverUrl="undefined"!=typeof window.UserContext?UserContext.getUrl("/services/Soap/u/31.0"):"/services/Soap/u/31.0"},sforce.internal.Parameter=function(a,b,c){this.name=a,this.value=b,this.isArray=c},sforce.Connection.prototype.sforceNs="urn:partner.soap.sforce.com",sforce.Connection.prototype.sobjectNs="sobject.partner.soap.sforce.com",sforce.Connection.prototype.writeOne=function(a,b,c,d){null===c?a.writeNameValueNode(b,null):c.toXml?c.toXml(d,b,a):a.writeNameValueNode(b,c)},sforce.Connection.prototype.init=function(a,b){this.sessionId=a,this.serverUrl=b},sforce.Connection.prototype.login=function(a,b){var c=new sforce.internal.Parameter("username",a,!1),d=new sforce.internal.Parameter("password",b,!1),e=this.invoke("login",[c,d],!1,null);return this.sessionId=e.sessionId,e},sforce.Connection.prototype.describeSObject=function(a,b){var c=new sforce.internal.Parameter("sObjectType",a,!1);return this.invoke("describeSObject",[c],!1,b)},sforce.Connection.prototype.describeSObjects=function(a,b){var c=new sforce.internal.Parameter("sObjectType",a,!0);return this.invoke("describeSObjects",[c],!0,b)},sforce.Connection.prototype.describeGlobal=function(a){return this.invoke("describeGlobal",[],!1,a)},sforce.Connection.prototype.describeLayout=function(a,b,c){var d=new sforce.internal.Parameter("sObjectType",a,!1);b||(b=[]);var e=new sforce.internal.Parameter("recordTypeIds",b,!0);return this.invoke("describeLayout",[d,e],!1,c)},sforce.Connection.prototype.describeAvailableQuickActions=function(a,b){var c=new sforce.internal.Parameter("parentType",a,!1);return this.invoke("describeAvailableQuickActions",[c],!0,b)},sforce.Connection.prototype.describeQuickActions=function(a,b){var c=new sforce.internal.Parameter("quickActionNames",a,!0);return this.invoke("describeQuickActions",[c],!0,b)},sforce.Connection.prototype.performQuickActions=function(a,b){var c=new sforce.internal.Parameter("quickActions",a,!0);return this.invoke("performQuickActions",[c],!0,b)},sforce.Connection.prototype.describeCompactLayouts=function(a,b,c){var d=new sforce.internal.Parameter("sObjectType",a,!1);b||(b=[]);var e=new sforce.internal.Parameter("recordTypeIds",b,!0);return this.invoke("describeCompactLayouts",[d,e],!1,c)},sforce.Connection.prototype.describePrimaryCompactLayouts=function(a,b){var c=new sforce.internal.Parameter("sObjectTypes",a,!0);return this.invoke("describePrimaryCompactLayouts",[c],!0,b)},sforce.Connection.prototype.describeApprovalLayout=function(a,b,c){var d=new sforce.internal.Parameter("sObjectType",a,!1);b||(b=[]);var e=new sforce.internal.Parameter("approvalProcessNames",b,!0);return this.invoke("describeApprovalLayout",[d,e],!1,c)},sforce.Connection.prototype.describeTabs=function(a){return this.invoke("describeTabs",[],!0,a)},sforce.Connection.prototype.describeAllTabs=function(a){return this.invoke("describeAllTabs",[],!0,a)},sforce.Connection.prototype.describeTheme=function(a){return this.invoke("describeTheme",[],!0,a)},sforce.Connection.prototype.describeGlobalTheme=function(a){return this.invoke("describeGlobalTheme",[],!0,a)},sforce.Connection.prototype.describeSoftphoneLayout=function(a){return this.invoke("describeSoftphoneLayout",[],!1,a)},sforce.Connection.prototype.describeMiniLayout=function(a,b,c){var d=new sforce.internal.Parameter("sObjectType",a,!1),e=new sforce.internal.Parameter("recordTypeIds",b,!0);return this.invoke("describeMiniLayout",[d,e],!1,c)},sforce.Connection.prototype.describeSearchScopeOrder=function(a){return this.invoke("describeSearchScopeOrder",[],!0,a)},sforce.Connection.prototype.create=function(a,b){var c=new sforce.internal.Parameter("sObjects",a,!0);return this.invoke("create",[c],!0,b)},sforce.Connection.prototype.update=function(a,b){var c=new sforce.internal.Parameter("sObjects",a,!0);return this.invoke("update",[c],!0,b)},sforce.Connection.prototype.upsert=function(a,b,c){var d=new sforce.internal.Parameter("externalIDFieldName",a,!1),e=new sforce.internal.Parameter("sObjects",b,!0);return this.invoke("upsert",[d,e],!0,c)},sforce.Connection.prototype.deleteIds=function(a,b){var c=new sforce.internal.Parameter("ids",a,!0);return this.invoke("delete",[c],!0,b)},sforce.Connection.prototype.impersonateUser=function(a,b){var c=new sforce.internal.Parameter("ids",a,!0);return this.invoke("impersonateUser",[c],!0,b)},sforce.Connection.prototype.query=function(a,b){var c=new sforce.internal.Parameter("queryString",a,!1);return this.invoke("query",[c],!1,b)},sforce.Connection.prototype.queryAll=function(a,b){var c=new sforce.internal.Parameter("queryString",a,!1);return this.invoke("queryAll",[c],!1,b)},sforce.Connection.prototype.queryMore=function(a,b){var c=new sforce.internal.Parameter("queryLocator",a,!1);return this.invoke("queryMore",[c],!1,b)},sforce.Connection.prototype.retrieve=function(a,b,c,d){var e=new sforce.internal.Parameter("fieldList",a,!1),f=new sforce.internal.Parameter("sObjectType",b,!1),g=new sforce.internal.Parameter("ids",c,!0);return this.invoke("retrieve",[e,f,g],!0,d)},sforce.Connection.prototype.match=function(a,b,c){var d=new sforce.internal.Parameter("sObjects",a,!0),e=new sforce.internal.Parameter("matchOptions",b,!1);return this.invoke("match",[d,e],!1,c)},sforce.Connection.prototype.getUserInfo=function(a){return this.invoke("getUserInfo",[],!1,a)},sforce.Connection.prototype.resetPassword=function(a,b){var c=new sforce.internal.Parameter("userId",a,!1);return this.invoke("resetPassword",[c],!1,b)},sforce.Connection.prototype.setPassword=function(a,b,c){var d=new sforce.internal.Parameter("userId",a,!1),e=new sforce.internal.Parameter("password",b,!1);return this.invoke("setPassword",[d,e],!1,c)},sforce.Connection.prototype.search=function(a,b){var c=new sforce.internal.Parameter("searchString",a,!1);return this.invoke("search",[c],!1,b)},sforce.Connection.prototype.getDeleted=function(a,b,c,d){var e=new sforce.internal.Parameter("sObjectType",a,!1),f=new sforce.internal.Parameter("startDate",b,!1),g=new sforce.internal.Parameter("endDate",c,!1);return this.invoke("getDeleted",[e,f,g],!1,d)},sforce.Connection.prototype.getUpdated=function(a,b,c,d){var e=new sforce.internal.Parameter("sObjectType",a,!1),f=new sforce.internal.Parameter("startDate",b,!1),g=new sforce.internal.Parameter("endDate",c,!1);return this.invoke("getUpdated",[e,f,g],!1,d)},sforce.Connection.prototype.getServerTimestamp=function(a){return this.invoke("getServerTimestamp",[],!1,a)},sforce.Connection.prototype.convertLead=function(a,b){var c=new sforce.internal.Parameter("leadConverts",a,!0);return this.invoke("convertLead",[c],!0,b)},sforce.Connection.prototype.merge=function(a,b){var c=new sforce.internal.Parameter("request",a,!0);return this.invoke("merge",[c],!0,b)},sforce.Connection.prototype.undelete=function(a,b){var c=new sforce.internal.Parameter("ids",a,!0);return this.invoke("undelete",[c],!0,b)},sforce.Connection.prototype.process=function(a,b){var c=new sforce.internal.Parameter("actions",a,!0);return this.invoke("process",[c],!0,b)},sforce.Connection.prototype.sendEmail=function(a,b){var c=new sforce.internal.Parameter("messages",a,!0);return this.invoke("sendEmail",[c],!0,b)},sforce.Connection.prototype.emptyRecycleBin=function(a,b){var c=new sforce.internal.Parameter("ids",a,!0);return this.invoke("emptyRecycleBin",[c],!0,b)},sforce.Connection.prototype.invalidateSessions=function(a,b){var c=new sforce.internal.Parameter("sessionIds",a,!0);return this.invoke("invalidateSessions",[c],!0,b)},sforce.Connection.prototype.logout=function(a){return this.invoke("logout",[],!0,a)},sforce.Connection.prototype.remoteFunction=function(a){function b(){if(sforce.debug.trace&&sforce.debug.log("callback called ..."),4==c.readyState)if(200==c.status)if("text/plain"==a.mimeType)a.onSuccess(c.responseText,c);else{if("text/xml"!=a.mimeType)throw"unsupported mime type: "+a.mimeType;if(!c.responseXML||!c.responseXML.documentElement)throw"Response not text/xml mime type: "+c.responseText;a.onSuccess(c.responseXML.documentElement,c)}else a.onFailure?a.onFailure(c.responseText,c):sforce.debug.log(c.responseText)}if(!a.url)throw"url not defined";if(!a.onSuccess)throw"onSuccess method not defined";if(a.method||(a.method="GET"),a.mimeType||(a.mimeType="text/plain"),"undefined"==typeof a.async&&(a.async=!0),"undefined"==typeof a.cache&&(a.cache=!1),"text/plain"!=a.mimeType&&"text/xml"!=a.mimeType)throw"Unknown mime type "+a.mimeType;sforce.debug.trace&&sforce.debug.log("Open connection to ... "+a.url);var c=(new sforce.Transport).newConnection(),d="undefined"!=typeof window.UserContext?UserContext.getUrl("/services/proxy"):"/services/proxy";if(d=a.cache?d+"?end-point-url="+a.url:d+"?no-cache="+(new Date).getTime(),c.open(a.method,d,a.async),a.requestHeaders)for(var e in a.requestHeaders)"function"!=typeof a.requestHeaders[e]&&c.setRequestHeader(e,a.requestHeaders[e]);c.setRequestHeader("SalesforceProxy-Endpoint",a.url),c.setRequestHeader("SalesforceProxy-SID",this.sessionId),a.async&&(c.onreadystatechange=b),sforce.debug.trace&&sforce.debug.log("Sending ..."),c.send(a.requestData?a.requestData:null),sforce.debug.trace&&sforce.debug.log("Done Sending ..."),a.async||b()},sforce.Connection.prototype.writeHeader=function(a,b){if(a.startHeader(),a.writeNamespace(b,"sfns"),null!==this.sessionId&&(a.writeStartElement("SessionHeader",b),a.writeNameValueNode("sessionId",this.sessionId),a.writeEndElement("SessionHeader",b)),"undefined"!=typeof this.organizationId)throw"Use sforce.connection.loginScopeHeader.organizationId instead of sforce.connection.organizationId";if(null!==this.loginScopeHeader&&(a.writeStartElement("LoginScopeHeader",b),null!==this.loginScopeHeader.organizationId&&a.writeNameValueNode("organizationId",this.loginScopeHeader.organizationId),null!==this.loginScopeHeader.portalId&&a.writeNameValueNode("portalId",this.loginScopeHeader.portalId),a.writeEndElement("LoginScopeHeader",b)),(null!==this.client||null!==this.defaultNamespace)&&(a.writeStartElement("CallOptions",b),null!==this.client&&a.writeNameValueNode("client",this.client),null!==this.defaultNamespace&&a.writeNameValueNode("defaultNamespace",this.defaultNamespace),a.writeEndElement("CallOptions",b)),null!==this.batchSize&&(a.writeStartElement("QueryOptions",b),a.writeNameValueNode("batchSize",this.batchSize),a.writeEndElement("QueryOptions",b)),null!==this.allowFieldTruncation&&(a.writeStartElement("AllowFieldTruncationHeader",b),a.writeNameValueNode("allowFieldTruncation",this.allowFieldTruncation),a.writeEndElement("AllowFieldTruncationHeader",b)),null!==this.disableFeedTracking&&(a.writeStartElement("DisableFeedTrackingHeader",b),a.writeNameValueNode("disableFeedTracking",this.disableFeedTracking),a.writeEndElement("DisableFeedTrackingHeader",b)),null!==this.streamingEnabled&&(a.writeStartElement("StreamingEnabledHeader",b),a.writeNameValueNode("StreamingEnabled",this.streamingEnabled),a.writeEndElement("StreamingEnabledHeader",b)),null!==this.allOrNone&&(a.writeStartElement("AllOrNoneHeader",b),a.writeNameValueNode("allOrNone",this.allOrNone),a.writeEndElement("AllOrNoneHeader",b)),null!==this.updateMru&&(a.writeStartElement("MruHeader",b),a.writeNameValueNode("updateMru",this.updateMru),a.writeEndElement("MruHeader",b)),null!==this.emailHeader&&(a.writeStartElement("EmailHeader",b),this.emailHeader.triggerAutoResponseEmail&&a.writeNameValueNode("triggerAutoResponseEmail",this.emailHeader.triggerAutoResponseEmail),this.emailHeader.triggerOtherEmail&&a.writeNameValueNode("triggerOtherEmail",this.emailHeader.triggerOtherEmail),this.emailHeader.triggerUserEmail&&a.writeNameValueNode("triggerUserEmail",this.emailHeader.triggerUserEmail),a.writeEndElement("EmailHeader",b)),null!==this.assignmentRuleHeader&&(a.writeStartElement("AssignmentRuleHeader",b),this.assignmentRuleHeader.assignmentRuleId&&a.writeNameValueNode("assignmentRuleId",this.assignmentRuleHeader.assignmentRuleId),this.assignmentRuleHeader.useDefaultRule&&a.writeNameValueNode("useDefaultRule",this.assignmentRuleHeader.useDefaultRule),a.writeEndElement("AssignmentRuleHeader",b)),null!==this.transferToUserId&&(a.writeStartElement("UserTerritoryDeleteHeader",b),a.writeNameValueNode("transferToUserId",this.transferToUserId),a.writeEndElement("UserTerritoryDeleteHeader",b)),null!==this.debuggingHeader){if(a.writeStartElement("DebuggingHeader",b),this.debuggingHeader.debugLevel&&a.writeNameValueNode("debugLevel",this.debuggingHeader.debugLevel),this.debuggingHeader.debugCategories)for(var c=this.debuggingHeader.debugCategories,d=0;d<c.length;d++){var e=c[d].split(",");2==e.length&&(a.writeStartElement("categories"),a.writeNameValueNode("category",e[0]),a.writeNameValueNode("level",e[1]),a.writeEndElement("categories"))}a.writeEndElement("DebuggingHeader",b)}a.endHeader()},sforce.Connection.prototype.namespaceMap=[{ns:sforce.Connection.prototype.sforceNs,prefix:null},{ns:sforce.Connection.prototype.sobjectNs,prefix:"ns1"}],sforce.Connection.prototype.invoke=function(a,b,c,d){return this._invoke(a,b,c,d,this.namespaceMap,this.serverUrl,this.sforceNs,this.sobjectNs)},sforce.Connection.prototype._invoke=function(a,b,c,d,e,f,g,h){if(d)if("function"==typeof d);else{if(!d.onSuccess)throw"onSuccess not defined in the callback";if(!d.onFailure)throw"onFailure not defined in the callback"}var i=new sforce.XmlWriter;i.startEnvelope(),this.writeHeader(i,g),i.startBody(),i.writeStartElement(a);for(var j=0;j<e.length;j++)i.writeNamespace(e[j].ns,e[j].prefix);for(var j=0;j<b.length;j++){var k=b[j];if("undefined"==typeof k.value)throw"arg "+j+" '"+k.name+"' not specified";if(null!==k.value){if(k.isArray&&!k.value.push)throw"arg "+j+" '"+k.name+"' is an array. But passed in value is not an array";if(!k.isArray&&k.value.push)throw"arg "+j+" '"+k.name+"' is not an array. But passed in value is an array"}if(null===k.value)this.writeOne(i,k.name,null,h);else if(k.value.push)for(var l=0;l<k.value.length;l++){var m=k.value[l];if(!m)throw"Array element at "+l+" is null.";this.writeOne(i,k.name,m,h)}else this.writeOne(i,k.name,k.value,h)}i.writeEndElement(a),i.endBody(),i.endEnvelope(),sforce.debug.trace&&(sforce.debug.log("Request: server- "+f),sforce.debug.logXml(i.toString()));var n=new sforce.SoapTransport;return n.send(f,i,c,d)},sforce.QueryResultIterator=function(a){this.queryResult=a,this.index=0,this.records=this.queryResult.getArray("records")},sforce.QueryResultIterator.prototype.hasNext=function(){return this.records.length>this.index?!0:(null!==this.queryResult.queryLocator&&(this.queryResult=sforce.connection.queryMore(this.queryResult.queryLocator),this.records=this.queryResult.getArray("records"),this.index=0),this.records.length>this.index?!0:!1)},sforce.QueryResultIterator.prototype.next=function(){if(this.records.length>this.index){var a=this.records[this.index];return this.index++,a}throw"Index out of bound : "+this.index},sforce.Email=function(){},sforce.Email.prototype=new sforce.Xml("messages"),sforce.MassEmailMessage=function(){},sforce.MassEmailMessage.prototype=new sforce.Xml("messages"),sforce.MassEmailMessage.prototype._xsiType="MassEmailMessage",sforce.SingleEmailMessage=function(){},sforce.SingleEmailMessage.prototype=new sforce.Xml("messages"),sforce.SingleEmailMessage.prototype._xsiType="SingleEmailMessage",sforce.ProcessRequest=function(){},sforce.ProcessRequest.prototype=new sforce.Xml("actions"),sforce.ProcessSubmitRequest=function(){},sforce.ProcessSubmitRequest.prototype=new sforce.Xml("actions"),sforce.ProcessSubmitRequest.prototype._xsiType="ProcessSubmitRequest",sforce.ProcessWorkitemRequest=function(){},sforce.ProcessWorkitemRequest.prototype=new sforce.Xml("actions"),sforce.ProcessWorkitemRequest.prototype._xsiType="ProcessWorkitemRequest",sforce.connection=new sforce.Connection;var UserContext="undefined"!=typeof window.UserContext?window.UserContext:{siteUrlPrefix:"",getUrl:function(a){return"undefined"!=typeof a&&"undefined"!=typeof UserContext.siteUrlPrefix&&UserContext.siteUrlPrefix?0!=a.indexOf("/")?a:0==a.indexOf(UserContext.siteUrlPrefix)?a:UserContext.siteUrlPrefix+a:a}};"undefined"!=typeof __sfdcSiteUrlPrefix&&(UserContext.siteUrlPrefix=__sfdcSiteUrlPrefix),sforce.connection.serverUrl="undefined"!=typeof window.UserContext?UserContext.getUrl("/services/Soap/u/31.0"):"/services/Soap/u/31.0","undefined"!=typeof __sfdcSessionId&&(sforce.connection.sessionId=__sfdcSessionId),window.Sfdc&&Sfdc.xdomain&&window.location.hostname.indexOf(".visual.force.")>-1&&(sforce._consoleApiUrl="/support/console/34.0/integration.js",skuid.load.js(sforce._consoleApiUrl))}if(window.$j=skuid.$,"object"!=typeof JSON)throw skuid.$("#bodyTable").find(".nx-page").css("font-size","14pt").empty().text("Skuid cannot run in this Web Browser.  Please make sure you are using Internet Explorer 8 or higher and are not in Compatibility Mode."),"";window.Visualforce&&window.Visualforce.remoting&&(window.Visualforce.remoting.timeout=9e4),function(a){var b,c=a.$,d=null!==navigator.userAgent.match(/iPad/i);a.loadFonts=function(b){var d=function(){a.fontsloaded=!0,a.events.publish("ui.fontsloaded")},e=JSON.parse(b),f=e.fontConfig,g=e.cssResources,h=a.utils.getSafeRelativeUrl;if(f.custom||f.google||f.webkit?(f.active=d,f.inactive=d,f.custom&&(a.isAura&&f.custom.localurls&&f.custom.localurls.length&&(c.each(f.custom.localurls,function(a,b){f.custom.urls[a]=b}),delete f.custom.localurls),f.custom.urls&&f.custom.urls.length&&c.each(f.custom.urls,function(a,b){f.custom.urls[a]=h(b)})),WebFont.load(f)):d(),g)for(var i=0;i<g.length;i++)a.utils.loadCSS(h(g[i]),{insertAfter:a.$("link#themeLink")[0]})},window.console||(b=window.console={},b.warn=b.info=b.error=b.trace=b.log=b.time=b.timeEnd=function(){}),a.$.fn.skootip=function(a,b){var e,f=this,g={position:{my:"center bottom",at:"center top-10",collision:"fit",using:function(a,b){c(this).css({top:a.top,left:a.left});var d=a.left+b.element.width/2,f=b.target.left+b.target.width/2;e=Math.floor(f-d-4)}},show:{delay:700},open:function(a,b){var d=c("<div>").addClass("sk-hastooltip").css("left",e+"px");b.tooltip.append(d)}};return a&&f.attr("title",a),b&&c.extend(!0,g,b),d?f:f.tooltip(g)}}(window.skuid),function(a){var b=a.$,c=a.events={},d={},e=function(a,b){return d[a]||(d[a]=[]),d[a].push(b),[a,b]},f=function(a,c){d[a]&&b.each(d[a],function(a,d){d&&d.apply(b,c||[])})},g=function(a,c){return a instanceof Array?b.map(a,function(a){return e(a,c)}):e(a,c)},h=function(a){var c=a[0];d[c]&&b.each(d[c],function(b){this==a[1]&&d[c].splice(b,1)})};c._cache=d,c.publish=f,c.subscribe=g,c.unsubscribe=h}(skuid),function(a){function b(b){var c={},i={data:c},j={},k=!1;if(d.each(b,function(b,f){var g,h=f.objectType,i=f.fields,k=f.records,l=c[b]={};d.each(k,function(b,c){var f,k={},m={},n=0,o={};d.each(i,function(a,b){m[b]=1,n++}),n&&(f=e[c],f&&d.each(m,function(b){var c=a.utils.getObjectProperty(f,b);"undefined"!=typeof c&&(o[b]=c,delete m[b],n--)}),n&&(d.each(a.model.list(),function(b,e){if(e.data&&e.data.length&&(e.objectName===h&&(f=e.getRowById(c),f&&d.each(m,function(a){a in f&&(o[a]=e.getFieldValue(f,a,!0),delete m[a],n--)})),n)){var g={},i=e.fields;i&&i.length&&d.each(i,function(a,b){var c=b.referenceTo;"REFERENCE"===b.displaytype&&c&&c.length&&d.each(c,function(a,c){return c.objectName===h?(g[b.id]=b.rel,!1):void 0})}),a.utils.size(g)&&d.each(g,function(b,f){return d.each(e.data,function(e,g){return a.utils.getObjectProperty(g,b)!==c||(d.each(m,function(b){var c=a.utils.getObjectProperty(g,f+"."+b);"undefined"!=typeof c&&(o[b]=c,delete m[b],n--)}),n)?void 0:!1}),n?void 0:!1})}}),n&&(g=j[h],g||(g=j[h]={objectType:h,fields:{},records:[]}),g.records.push(c),d.each(m,function(a){g.fields[a]=1
})))),d.extend(k,o),l[c]={record:k,isDone:0===n}})}),a.utils.size(j)){k=!0;var l=[],m=d.Deferred(),n=g++;d.each(j,function(b,c){var e=new a.model.Model({objectName:b,id:a.utils.generateGUID(),fields:d.map(c.fields,function(a,b){return{id:b}}),conditions:[{field:"Id",operator:"IN",type:"multiple",values:c.records}],doQuery:!0,recordsLimit:c.records.length});e.calloutIterator=n,e.lastSuccessfulCallout=function(){return h},l.push(e)}),j={},d.when(a.model.load(l)).done(function(){d.each(l,function(a,b){var e=c[b.keyPrefix];d.each(b.data,function(a,c){"attributes"in c&&delete c.attributes;var g=c.Id,h=e[g];h||(h=e[g]={}),d.extend(h,b.getRowById(g)),h.isDone=!0,f(c)})}),i.isSuccess=!0}).fail(function(){i.isSuccess=!1}).always(function(){h=l[0].lastSuccessfulCallout,i.isComplete=!0,m.resolve(i)}),i.promise=m.promise()}return i.isComplete=i.isSuccess=!k,i}var c=a.data={},d=a.$,e={},f=function(a){var b=a.Id,c=e[b];c||(c=e[b]={}),d.extend(c,a)},g=0,h=0;c.get=b,c.add=f;var i="_cls",j="skuid.RemotingStubs",k=a.remote=function(){var b,c=a.utils.getObjectProperty,e=k[i],f=c(window,e),g=c(window,j);return e!==j?(b=g,f&&d.extend(b,f)):b=f?f:g,b};k.set=function(a){k[i]=a},k.set(j)}(skuid),function(a){function b(a){return"[object Date]"===Object.prototype.toString.call(a)}function c(a){E=a}function d(a){if(!a)return!1;if(b(a))return a;var c=a.split&&a.split("T"),d=c&&c.length&&c[0].split("-");return d&&3===d.length?new Date(d[0],d[1]-1,d[2]):!1}function e(c){if(c){if(b(c)){var d=1,e=c.getMonth()-0+d+"",f=c.getDate()+"";return e.length===d&&(e="0"+e),f.length===d&&(f="0"+f),c.getFullYear()+"-"+e+"-"+f}return a.utils.isString(c)&&3===c.split("-").length?c:null}return null}function f(b){if(!b)return"";var c;return c=a.utils.isDate(b)?e(b):b,1===c.split(" ").length?h(d(c)):g(d(c))}function g(a){return h(m(a))}function h(b){return b?C.datepicker.formatDate(a.utils.userLocale.dateFormat,b):""}function i(a){return k(a)}function j(a,b){if(!a&&0!==a)return!1;var c,d,e=Date.parse,f=[1,4,5,6,7,10,11],g=0;if(d=F.exec(a)){for(var h,i=0;h=f[i];++i)d[h]=+d[h]||0;d[2]=(+d[2]||1)-1,d[3]=+d[3]||1,"Z"!==d[8]&&d[9]!==b&&(g=60*d[10]+d[11],"+"===d[9]&&(g=0-g)),c=Date.UTC(d[1],d[2],d[3],d[4],d[5]+g,d[6],d[7])}else c=e?e(a):0/0;return c}function k(a){if(b(a))return a;var c=j(a);return isNaN(c)?!1:new Date(c)}function l(b){return b&&"function"==typeof b.toISOString?b.toISOString():b&&a.utils.isString(b)?b:null}function m(a){if(!a)return!1;var b=new Date(a.getTime());return b.setMinutes(b.getMinutes()-(E-D)),b}function n(a){if(!a)return!1;var b=new Date(a.getTime());return b.setMinutes(a.getMinutes()+(E-D)),b}function o(b){if(b){var c=b instanceof Date?b:k(b),d=m(c),e=a.utils.userLocale;if(d)return e.showTimeBeforeDate?q(e.timeFormat,d)+" "+h(d):h(d)+" "+q(e.timeFormat,d)}return""}function p(c,d){if("undefined"!=typeof d&&"undefined"!=typeof c){var e,f,g=a.utils.isString;return g(d)&&!g(c)&&b(c)?(e=c,f=d):(g(d)&&(d=k(d)),e=d,f=c),C.datepicker.formatDate(f,e)}return""}function q(b,c){if(!c&&0!==c)return"";a.utils.isString(c)&&(c=k(c));var d,e=function(a){var c=d+1<b.length&&b.charAt(d+1)===a;return c&&d++,c},f=function(a){return a.getHours()%12},g=function(a,b,c){var d=""+b;if(e(a))for(;d.length<c;)d="0"+d;return d},h="",i=!1;if(c)for(d=0;d<b.length;d++)if(i)"'"!==b.charAt(d)||e("'")?h+=b.charAt(d):i=!1;else switch(b.charAt(d)){case"a":h+=s(c);break;case"h":var j=f(c);0===j&&(j=12),h+=g("h",j,2);break;case"K":h+=g("h",f(c),2);break;case"k":h+=g("k",c.getHours()+1,2);break;case"H":h+=g("H",c.getHours(),2);break;case"m":h+=g("m",c.getMinutes(),2);break;case"s":h+=g("s",c.getSeconds(),2);break;case"S":h+=g("S",c.getMilliseconds(),3);break;case"Z":var l=Math.floor(Math.abs(D)/60),m=Math.abs(D)-60*l;10>l&&(l="0"+l),10>m&&(m="0"+m),h+=(0>D?"+":"-")+l+m;break;case"'":e("'")?h+="'":i=!0;break;default:h+=b.charAt(d)}return h}function r(c,d){if(c||0===c){if(a.utils.isString(c)){if(c=k(c),!c)return null;c=m(c)}else"number"==typeof c&&(c=new Date(c));return b(c)?d?Date.prototype[d].call(c):c:null}return null}function s(b){var c=a.time.amPm,d=r(b,"getHours");return null!==d?d>11?c[1]:c[0]:null}function t(a){var b=r(a,"getMonth");return null!==b?1+b:null}function u(a){var b=r(a,"getUTCMonth");return null!==b?1+b:null}function v(b){var c=r(b,"getMonth");return null!==c?a.time.monthNames[c]:null}function w(b){var c=r(b,"getMonth");return null!==c?a.time.monthNamesShort[c]:null}function x(a){var b=r(a,"getDay");return null!==b?1+b:null}function y(a){var b=r(a,"getUTCDay");return null!==b?1+b:null}function z(b){var c=r(b,"getDay");return null!==c?a.time.dayNames[c]:null}function A(b){var c=r(b,"getDay");return null!==c?a.time.dayNamesShort[c]:null}var B=a.time={},C=a.$,D=(new Date).getTimezoneOffset(),E=(new Date).getTimezoneOffset(),F=/^(\d{4}|[+\-]\d{6})(?:-(\d{2})(?:-(\d{2}))?)?(?:T(\d{2}):(\d{2})(?::(\d{2})(?:\.(\d{3}))?)?(?:(Z)|([+\-])(\d{2})(?::?(\d{2}))?)?)?$/;Date.prototype.toISOString||!function(){function a(a){return 10>a?"0"+a:a}Date.prototype.toISOString=function(){return this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+"."+(this.getUTCMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"}}(),C.each({getYear:"getFullYear",getDay:"getDate",getHour:"getHours",getMinute:"getMinutes",getSecond:"getSeconds",getMillisecond:"getMilliseconds",getUTCYear:"getUTCFullYear",getUTCDay:"getUTCDate",getUTCHour:"getUTCHours",getUTCMinute:"getUTCMinutes",getUTCSecond:"getUTCSeconds"},function(a,b){B[a]=function(a){return r(a,b)}}),C.extend(B,{formatDate:p,formatTime:q,getDayName:z,getDayNameShort:A,getDayOfWeek:x,getLocalDateTime:m,getMonth:t,getMonthName:v,getMonthNameShort:w,getParseDateTimeResult:j,getPeriod:s,getRealJSDateTimeFromLocal:n,getSFDate:e,getSFDateTime:l,getUTCDayOfWeek:y,getUTCMonth:u,makeFormattedDate:f,makeFormattedDateFromJS:g,makeFormattedDateFromLocal:h,makeFormattedLongDateTime:o,parseDateString:k,parseDateTimeString:k,parseSFDate:d,parseSFDateTime:i,setUserTimeZoneOffset:c})}(skuid),function(a){function b(a){i.extend(j,a)}function c(a,b){return j[a]||b||""}function d(b,c,d){var e=a.label.parse(b,c,d),f=e[0],g=e[1],h="";return i(g).each(function(b){h+=this;var c=f[b];c&&(h+=a.label.read(c.substring(c.indexOf(".")+1,c.length-1)))}),h}function e(b){var c="string"==typeof b,d=c?b:b.template,e=(c?Array.prototype.slice.call(arguments,1):b.data)||[],f=b&&b.leftMerge,g=b&&b.rightMerge,h=a.label.parse(d,f,g),j=h[0],k=h[1],l="";return i(k).each(function(a){l+=this;var b=j[a];b&&(l+=e[b.substring(1,b.length-1)])}),l}function f(a,b,c){b||(b="{"),c||(c="}");var d=b+"__"+c,e=d in k?k[d]:k[d]=new RegExp("\\"+b+"[^"+b+"\\"+c+"]+\\"+c,"g");return[a.match(e)||[],a.split(e)]}function g(){return j}var h=a.label={},i=a.$,j={},k={};window.SkuidLabels&&(b(window.SkuidLabels),delete window.SkuidLabels),h.add=b,h.read=c,h.labelize=d,h.merge=e,h.parse=f,h.getAll=g,h.map=j,a.$L=c}(skuid),function(a){var b=a.currency={},c={ALL:"Lek",ARS:"$",AWG:"f",AUD:"$",BSD:"$",BBD:"$",BYR:"p.",BZD:"BZ$",BMD:"$",BOB:"$b",BAM:"KM",BWP:"P",BRL:"R$",BND:"$",CAD:"$",KYD:"$",CLP:"$",CNY:"&yen;",COP:"$",CRC:"c",HRK:"kn",CZK:"Kc",DKK:"kr",DOP:"RD$",XCD:"$",EGP:"&pound;",SVC:"$",EEK:"kr",EUR:"&euro;",FKP:"&pound;",FJD:"$",GBP:"&pound;",GHC:"c",GIP:"&pound;",GTQ:"Q",GGP:"&pound;",GYD:"$",HNL:"L",HKD:"$",HUF:"Ft",ISK:"kr",IDR:"Rp",IMP:"&pound;",JMD:"J$",JPY:"&yen;",JEP:"&pound;",LVL:"Ls",LBP:"&pound;",LRD:"$",LTL:"Lt",MYR:"RM",MXN:"$",MZN:"MT",NAD:"$",ANG:"f",NZD:"$",NIO:"C$",NOK:"kr",PAB:"B/.",PYG:"Gs",PEN:"S/.",PLN:"zl",RON:"lei",SHP:"&pound;",SGD:"$",SBD:"$",SOS:"S",ZAR:"R",SEK:"kr",CHF:"CHF",SRD:"$",SYP:"&pound;",TWD:"NT$",TTD:"TT$",TRY:"TL",TRL:"&pound;",TVD:"$",USD:"$",UYU:"$U",VEF:"Bs",ZWD:"Z$"};b.getSymbol=function(a){var b=c[a];return b?b:"$"}}(skuid),function(a){function b(a,b){f[a]=b}function c(a){delete f[a]}function d(a){return f[a]}var e=a.snippet={},f={};e.registerSnippet=b,e.register=b,e.getSnippet=d,e.get=d,e.unregister=c}(skuid),function(a){var b,c,d=a.page={},e=a.$;d.params=function(a){if(""===a)return{};for(var b={},c=0;c<a.length;++c){var d=a[c].split("=");2==d.length&&(b[d[0]]=decodeURIComponent(d[1].replace(/\+/g," ")))}return b}(window.location.search.substr(1).split("&")),d.getAllProblems=c=function(){var b=[],c=a.component.getByType("skuidpage"),d={};return c&&c.length&&e.each(c,function(){this.problems&&this.problems.length&&e.each(this.problems,function(c,e){var f;e&&(f=a.utils.isString(e)?e:e.message),f&&!f[d]&&(d[f],b.push(e))})}),b},d.rebuildPageProblems=function(b){var f=c(),g=d.problemsWrapper,h=b?b.justUpdateWrapper===!0:!1;g&&(h||d.problemsContainer.empty(),f.length?(h||e.each(f,function(){this.isDisplayed=!1,d.displayProblem(this)}),g.css("display","block"),d.problemsIndicator.text(a.label.merge(a.$L("skuid_page_problems"),f.length)).append(e("<div>").append(e('<div class="ui-icon ui-icon-close">')).addClass("nx-page-problems-dismiss").on("click",function(){g.hide()}))):g.css("display","none"))},d.updateProblemsWrapper=b=function(){d.rebuildPageProblems({justUpdateWrapper:!0})},d.displayProblem=function(a){var b="_uniqueProblemMessages",c=this[b],f=a.message;if(c||(c=this[b]={}),!d.problemsContainer||a.isDisplayed||c[f])return!1;var g=e("<div>").addClass("nx-problem").appendTo(d.problemsContainer);return g.text(g.index()-0+1+". "+a.message),a.isDisplayed=!0,c[f]=a,!0}}(skuid),function(a){function b(a,b){h[a]=b}function c(a){return h[a]}function d(){var a=[];return g.each(h,function(b,c){a.push(c)}),a}function e(){return h}var f=a.componentType={},g=a.$,h={};f.get=c,f.register=b,f.list=d,f.map=e}(skuid),function(a){var b=a.component={},c=a.$,d={},e={},f=function(a){return"There is no Skuid Component Type called '"+a+"'"},g=function(b,d){var e=[],f=b.is("conditions")?b.children():b.children("conditions").first().children(),g=b.attr("rowid");if(f){var h,i;d&&(i=d.rows,h=d.row||i&&i.length&&i[0]||null),f.each(function(){var b=new a.model.Condition(c(this)),d=b.mergeField||"Id";if("contextrow"==b.type){var f=g;!f&&h&&(f=a.utils.getObjectProperty(h,d)||""),f&&(b.value=f)}else"contextrows"==b.type&&i&&i.length&&(b.values=c.map(i,function(b){return a.utils.getObjectProperty(b,d)||""}));e.push(b)})}return e},h=function(a){var b=a.type();!b||b in e||(e[b]=[]),e[b].push(a),d[a.id()]=a},i=function(a){return e[a]},j=function(a){return d[a]},k=function(b,d,e,g){var h,i,j;if(1==arguments.length){var k=arguments[0];b=k.element,d=k.definition,e=k.type,h=k.context,g=k.options,j=k.state,d||(d=k.xmlDefinition)}if(b?b.jquery||(b=c(b)):b=c("<div>"),d&&a.utils.isString(d)&&(d=a.utils.makeXMLDoc(d)),d.jquery||(d=c(d)),e||(e=d.first().prop("tagName")),d.length&&(d=d.first()),d&&(d.attr("uniqueid")&&(i=d.attr("uniqueid")),d.attr("cssclass")&&b.addClass(d.attr("cssclass"))),i||(i=a.utils.generateGUID()),b.prop("id",i),a.componentType.get(e)){var l=new m(b,e,c.extend(g,{state:j}));return d&&(l.xmlDefinition=d),l.conditionallyRender({context:h,xmlDefinition:d}),l}return f(e)},l=function(a,d,e,f){var g=[],h=[];return c.each(a,function(){var a=b.factory({definition:this,context:e,state:f});a&&a instanceof m&&(a.element&&h.push(a.element),g.push(a))}),d&&(d.append(h),c.each(h,function(){c(this).trigger("attach")})),g},m=function(b,d,e){e||(e={});var f=this;e.state&&c.extend(f,e.state),f.element=b,f._componentType=d,f._GUID=e.uniqueId||b.attr("id")||a.utils.generateGUID(),f.isRendered=!1,b.attr("data-rendered","false").data({rendered:!1,component:f}),h(f)};m.prototype={id:function(){return this._GUID},getId:function(){return this.id()},type:function(){return this._componentType},getType:function(){return this.type()},setType:function(a){return this._componentType=a,this},getElement:function(){return this.element},getPersonalizationService:function(){var b="_personalizationService",c=this[b];return c||(c=this[b]=a.personalization.createComponentService(this)),c},setParentPageId:function(a){var b=this;return b._parentPageId=a,b},getParentPage:function(){return d[this.getParentPageId()]},getParentPageId:function(){var a,b,c,f=this,g=f._parentPageId;if(g)return g;if(c=e.skuidpage,c&&1===c.length)return c[0].id();if(a=f.getParentComponentId(),a&&d[a]&&(b=f.getParentComponent(),b&&(g=b.getParentPageId())),g)return g;var h=f.element.closest(".nx-page");return h.length?h.data("component").id():c[0].id()},setParentComponentId:function(a){var b=this;return b._parentComponentId=a,b},getParentComponent:function(){return d[this.getParentComponentId()]},getParentComponentId:function(){return this._parentComponentId},render:function(b){var c,d,e=this,g=e.getType(),h=a.componentType.get(g);if(b||(b={}),!h)return f(g);if(b.context&&(e.context=c=b.context),b.xmlDefinition?e.xmlDefinition=d=b.xmlDefinition:d=e.xmlDefinition,e.element.empty&&h&&!h.onlyRenderOnce&&h.emptyBeforeRender!==!1&&e.element.empty(),!e.isBeingRendered){switch(e.isBeingRendered=!0,typeof h){case"function":h(e.element,d,e);break;case"object":if("render"in h){h.render(e.element,d,e);break}default:throw"Invalid Component Type definition. Component Type must be a JavaScript Object with a render() method."}e.isBeingRendered=!1}return e.isRendered=!0,e.element.attr("data-rendered","true").data("rendered",!0),e},unrender:function(){var b=this,d=b.getType(),e=a.componentType.get(d);return b.element.data&&c.each(b.element.data(),function(a,b){"component"!==a&&"object"!==a&&b&&"object"==typeof b&&b.widget&&b.widget._destroy&&b.widget._destroy()}),b.unregisterChildComponents(),b.element.empty&&e&&!e.onlyRenderOnce?b.element.removeAttr("style").empty():e&&e.onlyRenderOnce&&b.xmlDefinition.attr("domid")&&c("body").append(b.element.children().hide().detach()),b.isRendered=!1,b.element.attr("data-rendered","false").data("rendered",!1),b},unregisterChildComponents:function(){var b=this,d=this.childComponents;return d&&d.length&&(c.each(d,function(b,c){a.utils.removeEventSubscriptions(c.element),c.unregister&&c.unregister()}),d.length=0),b},conditionallyRender:function(b){var c=this;return a.utils.conditionallyRender(function(a,d,e,f){c.render(b),f&&f.eventSubscriptions&&(c._eventSubscriptions=f.eventSubscriptions)},function(){c.unrender()},c.xmlDefinition,c.element,c._GUID,b),c},createConditionsFromXml:function(b,c){var d=this,e=b||d.xmlDefinition,f=d.element,h=c&&c.context||d&&d.context,i=[];if(i=g(e,h),f){var j=e.attr("controllingcomponent");j&&(f.controllingComponent=a.component.getById(j)),f.conditions=i}return i},addProblem:function(a){var b=this;c(function(){var c=b.getParentPage(),d=b._GUID;!c||c.id()===d&&d||c.addProblem(a)})},addProblems:function(a){var b=this;c(function(){var c=b.getParentPage(),d=b._GUID;!c||c.id()===d&&d||c.addProblems(a)})},unregister:function(){var b,f=this,g=f.getType(),h=a.componentType.get(g),i=e[g],j=f._eventSubscriptions;f.id()in d&&delete d[f.id()],b=c.inArray(f,i),-1!==b&&i.splice(b,1),f.unregisterChildComponents(),j&&(c.each(j,function(){this.unsubscribe&&this.unsubscribe()}),delete f._eventSubscriptions),h&&h.onlyRenderOnce&&f.xmlDefinition.attr("domid")&&c("body").append(f.element.children().hide().detach())},createChildComponents:function(){var a=this,b=a.id(),d=l.apply(a,arguments);return c.each(d,function(a,c){c.setParentComponentId(b)}),a.childComponents?Array.prototype.push.apply(a.childComponents,d):a.childComponents=d,d}},c.extend(b,{Component:m,createChildComponents:l,createConditionsFromXml:g,getByType:i,getById:j,factory:k,register:h}),a.$C=j,a.componentType.register("skuidpage",{onlyRenderOnce:!0,render:function(b,d,e){function f(){var b;a.fontsloaded?z():(y(),b=a.events.subscribe("ui.fontsloaded",function(){a.events.unsubscribe(b),z()}))}var g,h=a?a.page:null,i="preventUnloadIfUnsavedChanges",k=e[i]="yes"===d.attr("unsavedchangeswarning"),l=d.children("models").first().children(),n=[],o=e.problems=[],p=a.region.get("__header"+(e._pageRecord?e._pageRecord.Id:"")),q=a.region.get("__footer"+(e._pageRecord?e._pageRecord.Id:"")),r=d.children("components").first().children(),s=[],t=a.page.updateProblemsWrapper,u=function(){h._unsavedChangesHandler=!0,c(window).on("beforeunload.skuid",function(){var b;return c.each(a.model.list(),function(){var c=this.getParentPage();return this.hasChanged&&this[i]&&(!c||c[i])?(b=a.label.read("unsaved_changes_warning"),!1):void 0}),b})},v=function(){var a=window.Visualforce&&Visualforce.remoting&&Visualforce.remoting.Util?Visualforce.remoting.Util.error:null,b=!1;a&&(Visualforce.remoting.Util.error=function(c,d){var e=function(){b||window.confirm('You need to log in again, your session has expired.\n\nPress "OK" to go to the login page now.\n\nPress "Cancel" to remain on this page. Refresh your browser to go to the login page.')?window.location.reload():b=!0};d&&-1!==d.message.indexOf("Logged in?")?e():d&&-1!==d.message.indexOf("Page not allowed for the profile")?e():d&&-1!==d.message.indexOf("Remoting request invalid")?e():a&&a(c,d)})},w=function(){var b=window.location.href.toLowerCase(),d=["/skuid__pagebuilder","/pagebuilder","/skuid__edittheme","themelesspage","page=pagebuilder"],e=!1;if(c.each(d,function(a,c){return-1!==b.indexOf(c)?(e=!0,!1):void 0}),!e){var f=c("<div>").prop("id","skuidEditBtnContainer"),g=c("<div>").prop("id","skuidEditBtn").appendTo(f);c("<div>").addClass("inline sk-icon sk-icon-configure").css("margin-right","4px").appendTo(g),c("<div>").addClass("skuidEditButtonLabel").text(a.$L("edit_page")).appendTo(g),f.css("display","block").on("mouseover",function(){f.not(":animated").animate({width:"90px"},400)}).on("mouseleave",function(){f.animate({width:"16px"},400)}).on("click",function(){window.open((a.isAura?"/skuid/pagebuilder.app":"/apex/skuid__PageBuilder")+"?id="+h.id,"_blank")}).appendTo("body")}},x=function(){var a,d,e,f=h.getAllProblems();h.problemsIndicator?a=h.problemsWrapper:(a=c("<div>").addClass("nx-page-problems-wrapper clearfix"),d=c("<div>").addClass("nx-page-problems-indicator nx-error").css({display:"inline-block","text-align":"left",padding:"7px"}).click(function(){e.toggle()}),e=c('<div class="nx-page-problems-container">').css({display:"none","white-space":"wrap"}),c.extend(h,{problemsIndicator:d,problemsWrapper:a,problemsContainer:e}),a.append(d,e),b.prepend(a)),f.length?c.each(f,function(){h.displayProblem(this)}):a.css("display","none")},y=function(){g=c('<div class="nx-page">').css({position:"relative",height:"200px","z-index":"100","background-color":"white"}).hide().insertBefore(b),c("<div>").css({position:"absolute",top:"50%",left:"50%",transform:"translateY(-50%) translateX(-50%)"}).append(c("<span>").text(a.$L("loading"))).appendTo(g),g.timeoutHandle=window.setTimeout(function(){g&&g.length&&(delete g.timeoutHandle,g.fadeIn(100))},300)},z=function(){var d={_parentPageId:e.id()},f=e.context;p&&(s=s.concat(a.component.createChildComponents(p.xmlDefinition.children("components").first().children(),b,f,d))),s=s.concat(a.component.createChildComponents(r,b,f,d)),q&&(s=s.concat(a.component.createChildComponents(q.xmlDefinition.children("components").first().children(),b,f,d))),h.updateProblemsWrapper();var i=function(a){a?b.fadeIn(a):b.show()};if(g){g.css({"margin-bottom":-g.outerHeight()});var j=function(){g.detach(),g=null};g.timeoutHandle?(window.clearTimeout(g.timeoutHandle),j(),i()):(g.fadeOut(200,j),i(200))}else i();b.css("display","block"),b.trigger("pageload"),a.responsive.handleResize(),a.events.publish("ui.reflow"),c.holdReady(!1);var k=c(".nx-field > :input:visible:not(.hasDatepicker)");k.first().focus();var l=c('a.zen-trigger[title="Publisher Type Overflow Menu"]'),m=l.next();l.click(function(){m.toggle()}),m.click(function(){m.hide()})};!h._unsavedChangesHandler&&k&&u(),e.isInclude||(v(),a.mainPageElement=b),a.utils.processStylesNode(d.children("styles"),b),e.addProblem=function(b,c){("string"==typeof b||b instanceof String)&&(b={message:b}),a.page.displayProblem(b)&&o.push(b),c!==!0&&t()},e.addProblems=function(a){a instanceof Array?c.each(a,function(a,b){e.addProblem(b,!0)}):e.addProblem(a,!0),t()},!h||!h.editable||h.runningOnForceSite||a.mobile||e.isInclude||(w(),x()),e&&(e.unregister=function(){o.length=0,m.prototype.unregister.call(e),s.length&&c.each(s,function(){this.unregister()}),a.page.rebuildPageProblems()}),e.getPageRecord=function(){return j(e.id())._pageRecord},e.getModels=function(b){return a.model.list().filter(function(a){return a.getParentPageId()===e.id()&&(b?a.id===b:!0)})},e.getModel=function(a){return e.getModels(a)},l&&l.length&&c.each(l,function(){new a.model.Model(c(this)).setParentPageId(e.id()).initialize().register()}),c.each(e.getModels(),function(a,b){b.processOnClient&&(b.doQuery||b.needsMetadataLoad)&&n.push(b)}),c.holdReady(!0),n.length?(y(),a.model.load(n,f)):f()}})}(skuid),function(a){var b=a.sfdc={},c=b.api={},d="34.0",e='Parameter "type" expected, e.g. "POST", "GET"',f='Parameter "url" expected, e.g. "/sobjects/Account", "/query/?q=select+Name+from+Account"',g="Missing object property: ",h=c.version=d,i="/services/data/v",j=b.weblink={},k=a.$,l=[],m={},n={},o={},p={},q=function(b){var c=a.page.language,d=[c];return c&&c.length>2&&d.push(c.substring(0,2)),{fields:[{id:"Name"},{id:"MasterLabel"},{id:"PageOrSobjectType"},{id:"NamespacePrefix"},{id:"OpenType"},{id:"LinkType"},{id:"Url"},{id:"Localization",type:"childRelationship",fields:[{id:"Value"}],conditions:[{field:"Language",type:"multiple",operator:"in",values:d}],recordsLimit:1,orderByClause:"NamespacePrefix NULLS FIRST"}],conditions:[{field:"DisplayType",operator:"IN",type:"multiple",values:["L","B"]},{field:"PageOrSobjectType",value:b},{field:"LinkType",operator:"IN",type:"multiple",values:["page","url"]}],objectName:"Weblink",order:"Name"}},r=function(a){a&&(a instanceof Array?a.length&&k.each(a,function(){l.push(this)}):l.push(this))},s=function(a){return a in m},t=function(b){var c,d,e=b.weblinkName,f=b.objectName,g=b.namespacePrefix,h=b.callback,i=k.Deferred();if(e&&f&&k.each(l,function(a,b){if(b.Name===e&&b.PageOrSobjectType===f){if(g===b.NamespacePrefix)return d=b,!1;b.NamespacePrefix&&(c=b)}}),!d&&c&&(d=c),d||b.didQuery===!0||s(f))i.resolve(),h&&h(d);else{var j=n[f],o=!1;j||(j=n[f]=[],o=!0),j.push(b),o&&a.remote().load(JSON.stringify(q(f)),function(a,b){m[f]=1;var c=JSON.parse(a),d=c[0];b.status?(d.data&&d.data.length&&r(d.data),k.each(j,function(a,b){b.didQuery=!0,t(b)})):(i.resolve(),j.length&&k.each(j,function(a,b){b.callback&&b.callback(null)})),delete n[f]},{escape:!1})}return i},u=function(a){var b=a.Localization;return b&&b.records?b.records[0].Value:a.MasterLabel},v=function(a){var b=[];return l.length&&k.each(l,function(){this.PageOrSobjectType===a&&b.push(this)}),b},w=function(b){b||(b={});var c,d,g,j,l,m=b.type,n=b.url,q=b.data,r=!q&&b.cache===!0,s=function(a){b.success&&b.success(a)},t=function(a,c,d){if(b.error)b.error(a,c,d);else{var e=a.responseJSON[0];window.alert("There was an error performing this "+m+" request:\n\nError code: "+e.errorCode+"\nMessage: "+e.message+"\n")}};if(!m)throw e;if(!n)throw f;return d=m+" "+n,(g=d in p)?r?(j=p[d],c=k.Deferred(),c.done(s).resolve(j),c.promise()):void delete p[d]:!q&&d in o?o[d].done(s).fail(t):(c={type:m,url:i+h+n,dataType:"json",headers:{"Content-Type":"application/json",Authorization:"Bearer "+a.utils.userInfo.sessionId},success:s,error:t},b.crossDomain&&(c.crossDomain=!0),q&&(c.data=JSON.stringify(q)),l=k.ajax(c),q||(o[d]=l,l.always(function(){delete o[d]}),r&&l.done(function(a){p[d]=a})),l)},x=function(a){a||(a={});var b,c=a.type,d=a.url,g=a.data;if(!c)throw e;if(!d)throw f;return b=c+" "+d,!g&&b in p?p[b]:void 0},y={StaticResource:{fields:{Name:{required:!0},Description:{required:!1},Body:{required:!0},CacheControl:{required:!0,defaultValue:"Public"},ContentType:{required:!0,defaultValue:"text/plain"}}},ApexPage:{fields:{Name:{required:!0},Markup:{required:!0},MasterLabel:{required:!0},ApiVersion:{required:!0,defaultValue:c.version}}},ApexClass:{fields:{Name:{required:!0},Body:{required:!0},ApiVersion:{required:!0,defaultValue:c.version}}}},z=function(a,b){this._type=a,"object"==typeof b&&k.extend(this,b)},A=function(a){a||(a={});var b=this,c=b.getFields(),d=b.getType(),e={},f=a.useToolingApi||"ApexClass"===d;return c&&k.each(c,function(a,c){var d=b[a];if(c.required&&("undefined"==typeof d||""===d)){if(!c.defaultValue)throw g+a;d=b[a]=c.defaultValue}e[a]=d}),w({type:"POST",url:"/"+(f?"tooling/":"")+"sobjects/"+d,data:e,success:function(c){if(c.success)b.Id=c.id,a.success&&a.success(c);else{var e=d+" could not be created due to errors:\n\n";k.each(c.errors,function(){e+=this+"\n"})}},error:function(b,c,e){if(a.error)a.error(b,c,e);else{var f=b.responseJSON;f&&f.length&&window.alert("Unable to create new "+d+" due to error:\n\nError code: "+f[0].errorCode+"\nMessage: "+f[0].message)}}})},B=function(a){a||(a={});var b=this,c=b.getFields(),d=b.getType(),e={};return c&&k.each(c,function(a){var c=b[a];"undefined"!=typeof c&&(e[a]=c)}),w({type:"PATCH",url:"/"+(a.useToolingApi?"tooling/":"")+"sobjects/"+d+"/"+b.Id,data:e,success:a.success,error:function(c,e,f){if(a.error)a.error(c,e,f);else{var g=c.responseJSON;g&&g.length&&window.alert("Unable to update "+d+" with Id "+b.Id+" due to error:\n\nError code: "+g[0].errorCode+"\nMessage: "+g[0].message)}}})},C=function(a){a||(a={});var b=this,c=b.getType(),d=a.useToolingApi||"ApexClass"===c;if(!b.Id)throw g+"Id";return w({type:"DELETE",url:"/"+(d?"tooling/":"")+"sobjects/"+c+"/"+b.Id,success:a.success,error:a.error})},D=function(a,b){return b||(b={}),w({type:"GET",url:"/"+(b.useToolingApi?"tooling/":"")+"query/?q="+encodeURIComponent(a),success:b.success,error:function(a,c,d){if(b.error)b.error(a,c,d);else{var e=a.responseJSON;e&&e.length&&window.alert("There was an error performing this query: "+e[0].message)}}})},E=function(a){return window.btoa(window.unescape(encodeURIComponent(a)))},F=function(b){var c=k.Deferred();return a.remote().doSearch(JSON.stringify(b),function(a,d){var e,f,g;d.status?(g=JSON.parse(a),f=g.sosl,e=g.error,g.results&&c.resolve({sosl:f,results:g.results,request:b})):e=d.message,e&&c.reject({error:"There was an error performing the requested Salesforce search: "+e,request:b,sosl:f})},{escape:!1}),c.promise()};z.prototype={insert:function(){return A.apply(this,arguments)},update:function(){return B.apply(this,arguments)},"delete":function(){return C.apply(this,arguments)},get:function(a){return this[a]},set:function(b,c){a.utils.isString(b)?this[b]=c:k.extend(this,b)},getType:function(){return this._type},getFields:function(){var a=y[this.getType()];return a?a.fields:null},getField:function(a){var b=this.getFields();return b?b[a]:null}},j.get=t,j.getLabel=u,j.getAllForObject=v,j.add=r,j.haveQueriedForObject=s,c.getCachedResult=x,c.makeRequest=w,c.query=D,c.escapeMetadataBody=E,c.SObject=z,b.search=F,j._buildQueryForObject=q}(skuid),function(a){function b(b,c){var d,g,h=e.Deferred(),i=h.promise(),j=b.body,k=e.extend({"User-Agent":navigator.userAgent},b.headers),l=a.utils.size;if(b.contentType&&(k["Content-Type"]=b.contentType),b.headers=k,"GET"===b.method&&!j){if(d=b.url+" - "+b.modelService+" - "+(l(k)?JSON.stringify(k):""),f[d])return f[d];f[d]=i}return c||(c={}),c.escape=!1,j&&!a.utils.isString(j)&&(b.body=JSON.stringify(j)),a.remote().proxy(JSON.stringify(b),function(b){try{b=JSON.parse(b),g=b.setCookies,g&&g.length&&(e.cookie.raw=!0,e.each(g,function(b,c){var d,f={};e.each(["path","secure","domain"],function(a,b){b in c&&(f[b]=c[b])}),"expires"in c&&(d=c.expires,f.expires=a.utils.isNumber(d)===!1?a.time.parseDateTimeString(d):parseInt(d,10)),e.cookie(c.name,c.value,f)}),e.cookie.raw=!1)}catch(c){}b&&!b.error?h.resolve(b):h.reject(b),delete f[d]},c),i}function c(b){var c=e.Deferred(),d=c.promise(),f=b.body;return delete b.body,b.data=f&&!a.utils.isString(f)?JSON.stringify(f):f,e.ajax(b).done(function(a,b,d){var e={statusCode:d.status,body:a,status:d.statusText};c.resolve(e)}).fail(function(a){var b={statusCode:a.status,body:a.responseText,status:a.statusText};c.resolve(b)}),d}var d=a.ajax={},e=a.$,f={};d.proxy=b,d.direct=c}(skuid),function(a){function b(b,c,d){var e=a.$.Deferred();return c?a.utils.isString(c)||(c=JSON.stringify(c)):c={},a.remote().runProcessPlugin(b,c,function(a,b){b.status?(a=JSON.parse(a),d&&d(a),e.resolve(a)):e.reject(b)},{escape:!1}),e.promise()}function c(b,c){var d=a.$.Deferred();return a.remote().describeProcessPlugin(b,function(a,b){b.status?(a=JSON.parse(a),c&&c(a),d.resolve(a)):d.reject(b)},{escape:!1}),d.promise()}var d=a.plugins={};d.run=b,d.describe=c}(skuid),function(a){var b=a.$,c=a.responsive={config:{resizeWaitTime:100}},d=function(){return a.utils.getCSSSizeObj.apply(this,arguments)},e=function(a,c){var e,f,g,h;if(c.columnGutter&&(e=d(c.columnGutter),e&&(f=e.number/2*-1+e.unit)),c.rowGutter&&(g=d(c.rowGutter),g&&(h=-1*g.number+g.unit)),a.css(f||h?{margin:(h||"0")+" "+(f||"0")+" 0 "+(f||"0")}:{margin:""}),"rigid"===c.layoutMode&&c.precision&&a.children().length>c.precision&&!a.children(".sm-grid-division-filler").length)for(var i=0;i<c.precision;i++)a.append(b("<div>").addClass("sm-card sm-grid-division sm-grid-division-filler").css({height:"0",padding:"0",margin:"0",border:"none",flex:"1 1 "+c.minWidth+"px"}))},f=function(a){a.css({margin:""}),b.each(a.children(),function(){h(this)})},g=function(a,b){b=b||{};var c,e,f,g,h,i,j,k,l,m;b.columnGutter&&(h=d(b.columnGutter),h&&(i=h.number/2+h.unit)),b.rowGutter&&(j=d(b.rowGutter),j&&(k=j.number+j.unit)),(k||i)&&a.css({margin:(k||"0")+" "+(i||"0")+" 0 "+(i||"0")}),"top"===b.verticalAlign?a.css({"-webkit-justify-content":"flex-start","justify-content":"flex-start"}):"center"===b.verticalAlign?a.css({"-webkit-justify-content":"flex-start","justify-content":"center"}):"bottom"===b.verticalAlign&&a.css({"-webkit-justify-content":"flex-start","justify-content":"flex-end"}),"specified"===b.behavior?a.css({width:b.width,"-webkit-flex":"none",flex:"none"}):"fit"===b.behavior?a.css({width:"","-webkit-flex":"none",flex:"none"}):(m=d(b.minWidth),l=d(b.parentMinWidth),c=b.relativeSize,e=b.relativeSize,m?f=m.number+m.unit:l&&(f=l.number*(b.relativeSize||1)+l.unit),g=c+" "+e+" "+f,a.css({"-webkit-flex":g,flex:g,width:""}))},h=function(a){a.css({margin:"",width:"","-webkit-flex":"none",flex:"none","-webkit-justify-content":"","justify-content":""})},i=function(a){var c,d=parseInt(a.data("voffset"),10),e=parseInt(a.data("vpercent"),10),f=parseInt(a.data("precision"),10);if((d||0===d)&&e||0===e?(c=(a.offsetParent().outerHeight()-d)*(e/100),a.addClass("sm-grid-fixed-vertical").css("height",c+"px")):a.removeClass("sm-grid-fixed-vertical").css("height",""),f){var g,h=0;a.children(".sm-grid-division-forcewrap").remove(),b.each(a.children(".sm-grid-division"),function(){var a,c=b(this),d=c.data("size"),e=c.data("component"),i=e&&e.xmlDefinition&&e.xmlDefinition.attr("type"),j=c[0].offsetTop;a=!i||"specified"!==i&&"fit"!==i?parseInt(d,10)||1:1,j!==g&&(h=0),h+=a,h>f&&(c.before(b("<div>").addClass("sm-grid-division-forcewrap")),j=c[0].offsetTop,h=a),g=j})}},j=function(){a.events.publish("ui.resize")},k=!1;b(window).on("resize orientationchange",function(){k!==!1&&clearTimeout(k),k=setTimeout(a.responsive.handleResize,a.responsive.config.resizeWaitTime)}),b.extend(c,{handleResize:j,prepareDivision:g,prepareGrid:e,processGrid:i,unMakeDivision:h,unMakeGrid:f})}(skuid),function(a){function b(b,c){if(!b)return!1;b&&a.utils.isString(b)&&(b=a.utils.makeXMLDoc(b)),b.jquery||(b=i(b));var d=b.attr("uniqueid");c&&("__header"===d||"__footer"===d)&&(d+=c),j[d]={xmlDefinition:b}}function c(a){return j[a]}function d(){var a=[];return i.each(j,function(b,c){a.push(c)}),a}function e(){return j}function f(a,b){a.unregisterChildComponents().createChildComponents(b.children(),a.element,a.context)}function g(b,d){var e,g=a.$C(b),h=c(d);h&&(e=h.xmlDefinition.children("components").first(),f(g,e))}var h=a.region={},i=a.$,j={};i.extend(h,{get:c,list:d,map:e,register:b,setContent:f,setContentByIds:g})}(skuid),function(skuid){function getUserInfo(){return skuid.utils.userInfo}function getSafeRelativeUrl(a){var b=a&&startsWith(a,"/"),c=skuid.page.sitePrefix;
return c&&"null"!==c&&b&&!startsWith(a,c)?c+a:a}function getDefaultImageUrl(a){return"/resource/skuid__DefaultPhotos/"+("org"===a?"Org":"Profile")+".jpg"}function getContextToUse(a,b){var c={};return a&&a.context&&$.extend(c,a.context),b&&$.extend(c,b),c.model||(a&&a.model?c.model=a.model:a&&a.list&&a.list.model&&(c.model=a.list.model)),c.row||(c.item&&c.item.row?c.row=c.item.row:a&&a.row?c.row=a.row:a&&a.item&&a.item.row&&(c.row=a.item.row)),c.list||a&&a.list&&(c.list=a.list),c.editor||a&&a.editor&&(c.editor=a.editor),c}function isApiEnabled(){return getUserInfo().isApiEnabled}function canUseSessionStorage(){if("nodata"===_canUseSessionStorage)try{_canUseSessionStorage="sessionStorage"in window&&null!==window.sessionStorage}catch(a){_canUseSessionStorage=!1}return _canUseSessionStorage}function hsh(a){var b,c,d,e=0;if(0===a.length)return e;for(b=0,c=a.length;c>b;b++)d=a.charCodeAt(b),e=(e<<5)-e+d,e|=0;return e}function getSessionHash(){return _sessionIdHash||(_sessionIdHash=hsh(getUserInfo().sessionId)),_sessionIdHash}function getSessionLanguage(){return getUserInfo().language}function cacheNeedsRefresh(a){return a.__uid!==getSessionHash()||a.__userLanguage!==getSessionLanguage()}function checkInCache(a){return a?(a.modstamp=(new Date).getTime(),a.__uid=getSessionHash(),void(a.__userLanguage=getSessionLanguage())):!1}function capitalizeFirst(a){return a.charAt(0).toUpperCase()+a.slice(1)}function combineUrls(a,b){return a||(a=""),b||(b=""),(endsWith(a,"/")?a.substring(0,a.length-1):a)+"/"+(startsWith(b,"/")?b.substring(1,b.length):b)}function _storage(a,b,c){if("undefined"==typeof a)return null;var d=utils["canUse"+capitalizeFirst(c)]();return"undefined"==typeof b?d?window[c][a]:$.cookie(a):d?window[c][a]=b:$.cookie(a,b)}function sessionStorage(a,b){return _storage(a,b,"sessionStorage")}function mergeNodeProperty(a,b,c,d){d||(d=_mergeSettings);var e=c&&c.model?c.row?MERGE_ROW:MERGE_MODEL:MERGE_GLOBAL,f=$("<div>"),g=a.attr(b);return"undefined"!=typeof g?(f.append(e==MERGE_ROW?merge(MERGE_ROW,g,d,c.model,c.row):e==MERGE_MODEL?merge(MERGE_MODEL,g,d,c.model):merge(MERGE_GLOBAL,g,d)),f.text()):void 0}function redirect(a){if(a){var b=a.model,c=a.row,d=a.url,e=a.title||"",f=a.window,g=b?c?MERGE_ROW:MERGE_MODEL:MERGE_GLOBAL,h=$.extend(_mergeSettings,a.mergeSettings||{}),i=window.sforce&&sforce.one?sforce.one:!1,j=window.sforce&&sforce.console&&sforce.console.isInConsole()?sforce.console:!1,k=d&&startsWith(d,"/");d&&(d=mergeAsText(g,d,h,b,c),i?i.navigateToURL(d,"blank"===f):j?k?(c&&b&&(startsWith(d,"/"+c.Id)||startsWith(d,"/"+c.Id.substring(0,15)))&&b.getRowById(c.Id)&&(e=b.getNameFieldValueForRow(c)),skuid.ui.openConsoleTabForUrl(d,e)):window.open(d):(k&&(d=getSafeRelativeUrl(d)),"blank"===f?window.open(d):"parent"===f?parent.location=d:window.location=d))}}function createPopupFromPopupXML(a,b,c){if(!a)return null;b||(b={}),c||(c={});var d=$("<div>").attr("title",mergeNodeProperty(a,"title",b,{createFields:!0,registerFields:!1})),e=[],f=[],g=!0,h=!0;return b.popup=d,("false"===a.attr("modal")||c.modal===!1)&&(g=!1),("false"===a.attr("resizable")||c.resizable===!1)&&(h=!1),a.children("components").first().children().each(function(){var a=skuid.component.factory({definition:this,context:b});e.push(a.element),f.push(a)}),d.append(e).dialog({close:function(){f&&$.each(f,function(){this.unregister&&this.unregister()}),d.dialog("destroy").remove(),c.close&&c.close.apply(this)},open:function(){c.open&&c.open.apply(this)},beforeClose:function(){c.beforeClose&&c.beforeClose.apply(this)},modal:g,resizable:h,width:a.attr("width")||"600px",buttons:c.buttons||[]}),d}function createPopupFromAction(a,b,c){var d=a.children("popup").first();return createPopupFromPopupXML(d,b,c)}function calculateReferenceMerges(a){a||(a={});var b,c,d,e,f,g={registerFields:!1},h=a.fieldMetadata;if(h&&(e=h.rel,f=h.id),!("template"in a||"fieldMetadata"in a))throw"skuid.utils.calculateReferenceText: Either fieldMetadata or a template must be provided.";if(a.template){var i=f.indexOf(".");d=f&&-1!=i?f.substring(0,i+1):"",c=a.template,g.fieldPrefix=d+e+"."}else{var j,k;if(-1!=h.ref.indexOf(",")||h.referenceTo&&h.referenceTo.length>=2){if(a.targetObject){var l=a.targetObject.split(".");j=l[l.length-1]}else j=h.referenceTo[0].objectName;k="Name"}else j=h.ref,k=a.model.service.getNameField(j);e?(-1!=f.indexOf(".")&&(e=f.substring(0,f.lastIndexOf(".")+1)+e),c="{{"+e+"."+k+"}}"):c="{{"+k+"}}"}return b=a.model.getRowMergeResult(a.row,c,g)}function calculateReferenceText(a){return calculateReferenceMerges(a).merges.text()}function getFieldRelationshipName(a,b){var c=a.split(".");c.pop();var d=c.join(".");return"REFERENCE"===b.displaytype?(d?d+".":"")+b.rel:d}function getTargetObject(a){return a.referenceTo[0]}function getFieldReference(a,b){return getFieldRelationshipName(a,b)+"."+getNameField(getTargetObject(b).objectName)}function getReferenceFieldNameFromRelationshipField(a){var b=a.split(".")[0];return endsWith(b,"__r")||endsWith(b,"__pr")?b.substring(0,b.length-1)+"c":b+"Id"}function getReferenceFieldRelationshipName(a){return endsWith(a,"__c")||endsWith(a,"__pc")?a.substring(0,a.length-1)+"r":a.substring(0,a.length-2)}function getUserInfoPropValue(a){var b=userInfoCamelCasings[a]||a,c=getUserInfo();return"ismulticurrencyorganization"===a?skuid.utils.isMultiCurrencyOrganization:b in c?c[b]:void 0}function makeConditionLogicString(a,b,c){var d,e=!0,f=b.length;if(c||(c={}),a?(d=a.toLowerCase().replace(/\s+/g,""),CONDITION_LOGIC_REGEX.test(d)||(e=!1)):e=!1,!e)throw"Invalid Condition Logic: "+a;for(c.customAndString&&(d=d.replace(/and/g,c.customAndString)),c.customOrString&&(d=d.replace(/or/g,c.customOrString));f>0;f--)d=d.replace(f,b[f-1]);return d}function evaluateConditionLogic(logic,returnValues){var result=eval(makeConditionLogicString(logic,returnValues,{customAndString:"&&",customOrString:"||"}));return result}function areConditionsMet(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v=!0,w=!1,x=!1;for(b||(b={}),s=b.context,u=b.logicType||"and","custom"===u?(t=b.logic,d=[]):"or"===u?x=!0:w=!0,a instanceof Array||(a=[a]),e=0;e<a.length;e++){if(c=!0,f=a[e],o=f.sourceType||FIELD_VALUE,p=o===FIELD_VALUE,q=f.sourceProperty,r=f.operator,n=f.type||FIELD_VALUE,g=null,h=null,j=null,l=f.value,m=f.values,p||endsWith(o,"property")){if(f.fieldModel){if(g=skuid.$M(f.fieldModel),g&&g.data)if(b.row&&b.model&&b.model.objectName===g.objectName)h=b.row;else if(g.data.length)h=g.data[0],f.fieldRow=h.Id;else if(p){var y=f.noSourceRowBehavior||"deactivate";if("deactivate"===y)continue;return"skipandrender"===y?!0:!1}}else b.row&&(h=b.row,b.model&&(g=b.model));"function"==typeof h&&(h=h())}if(p)i=getObjectProperty(h,f.field);else if("userinfo"===o)i=getUserInfoPropValue(f.sourceUserInfoType);else if("param"===o)i=skuid.page.params[f.sourceParam];else if("snippet"===o){var z,A=skuid.snippet.get(f.snippetName);A&&(z={},b.context&&$.extend(z,b.context),b.model&&(z.model=b.model),b.row&&(z.row=b.row),b.item&&(z.item=b.item),b.list&&(z.list=b.list),b.component&&(z.component=b.component),i=A(z))}else endsWith(o,"property")&&q&&g&&(inArray(q,["hasRows","hasNoRows"])>-1?(i=!(!g.data||!g.data.length),l="hasRows"===q,r="=",n=FIELD_VALUE):"rowproperty"===o?h?(n=FIELD_VALUE,l||l===!1||0===l||(l=!0),r||(r="="),"isCloned"===q?i=g.isRowUnsavedClone(h):"isNew"===q?i=g.isNewId(h.Id):"isSaved"===q?i=!g.isNewId(h.Id):"hasChanged"===q&&(i=g.isRowChanged(h))):c=!1:("data.length"===q&&(l=parseInt(l,10)),i=getObjectProperty(g,q)));if(k=null===i||""===i||"undefined"==typeof i,k&&(i=""),"userinfo"===n?l=getUserInfoPropValue(f.userInfoType):"param"===n&&(l=skuid.page.params[l]),s){var B,C;if("contextrow"===n&&s.row)B=f.mergeField||"Id",C=getObjectProperty(s.row,B),"undefined"!=typeof C&&(l=C);else if("contextrows"===n&&s.rows){B=f.mergeField||"Id";var D,E,F={};for(D=0;D<s.rows.length;D++)E=s.rows[D],C=getObjectProperty(E,B),"undefined"==typeof C||C in F||(F[C]=1);m=Object.keys(F)}}if("blank"===n)"!="===r?k&&(c=!1):k||(c=!1);else if(-1!==$.inArray(n,["multiple","contextrows"])){if(m&&m instanceof Array){var G,H="includes"===r,I=m.length;if("in"===r&&-1===inArray(i,m))c=!1;else if("not in"===r&&-1!==inArray(i,m))c=!1;else if("includes"===r||"excludes"===r)if(G=i.split(";"),G.length){var J,K;for(J=0;J<m.length;J++)if(K=m[J],-1!==inArray(K,G)){if(!H){c=!1;break}}else if(H){c=!1;break}}else H&&I&&(c=!1)}}else switch(r){case"!=":i===l&&(c=!1);break;case"gt":(l>i||i==l)&&(c=!1);break;case"lt":(i>l||i==l)&&(c=!1);break;case"gte":l>i&&(c=!1);break;case"lte":i>l&&(c=!1);break;case"starts with":startsWith(i,l,!0)||(c=!1);break;case"does not start with":startsWith(i,l,!0)&&(c=!1);break;case"ends with":endsWith(i,l,!0)||(c=!1);break;case"does not end with":endsWith(i,l,!0)&&(c=!1);break;case"contains":contains(i,l,!0)||(c=!1);break;case"does not contain":contains(i,l,!0)&&(c=!1);break;case"includes":-1===inArray(l,i.split(";"))&&(c=!1);break;case"excludes":-1!==inArray(l,i.split(";"))&&(c=!1);break;default:i!==l&&(c=!1)}if(w&&!c){v=!1;break}if(x){if(v=c,c)break}else t&&d.push(c)}return t&&d&&d.length&&(v=evaluateConditionLogic(t,d)),v}function doesRowMeetConditions(a,b,c){return areConditionsMet(b,{row:a,context:c})}function filterRowsByConditions(a,b,c){if(a&&a.length){var d=b&&b.length;return a.filter(function(a){return d?doesRowMeetConditions(a,b,c):!0})}return[]}function isMultiValueOperator(a){return a&&a.toLowerCase()in multiValueOperators}function isNumber(a){return!isNaN(a-0)}function adjustValueBasedOnQuotedness(a,b){var c=a;return void 0!==a&&(b?c=a.toString():"false"===a?c=!1:"true"===a?c=!0:isNumber(a)&&a!==!1&&a!==!0&&(c=-1!==a.toString().indexOf(".")?parseFloat(a):parseInt(a,10))),c}function getObjectProperty(a,b){if(a&&b){for(var c,d,e,f=b.split("."),g=0;g<f.length;){if(c=f[g],a){if(a instanceof Array&&"length"!==c){e=null;try{d=parseInt(c,10)}catch(h){e=h}if((e||isNaN(c))&&a.length){a=a[0];continue}if(d>=0){a=a[d],g++;continue}}if(c in a){a=a[c],g++;continue}}return null}return a}return null}function hasObjectProperty(a,b){if(a&&b){for(var c=b.split("."),d=0,e=!1;d<c.length;){if(!(a&&c[d]in a))return!1;a=a[c[d++]],e=!0}return e}return!1}function setObjectProperty(a,b,c){if(a&&b&&"undefined"!=typeof c){for(var d,e,f,g,h=b.split("."),i=0,j=h.length-1;j>i;){d=h[i];{if(!a)break;if(a instanceof Array){f=null;try{e=parseInt(d,10)}catch(k){f=k}!f&&!isNaN(d)&&e>=0&&(a=a[e])}else a=d in a?a[d]:a[d]={};i++}}a&&(a instanceof Array?isNaN(h[j])?a.push(c):a[h[j]]=c:(g={},g[h[j]]=c,$.extend(a,g)))}}function removeScriptTags(a){return a&&isString(a)?a.replace(RSCRIPT,""):a}function decodeXML(a){return a.replace(/&apos;/g,"'").replace(/&quot;/g,'"').replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&amp;/g,"&")}function decodeHTML(a){return isString(a)?a&&$("<div/>").html(a).text():a}function encodeHTML(a){return isString(a)?a&&String(a).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;"):a}function isString(a){return"string"==typeof a||a instanceof String}function isDate(a){return a instanceof Date}function nl2br(a){return a&&a.replace(/(\r\n|\n|\r)/gm,"<br>")}function lowercase(a){return a&&"string"==typeof a?a.toLocaleLowerCase?a.toLocaleLowerCase():a.toLowerCase():a}function stringComparison(a,b,c,d){return a&&b&&c?(d&&(b=lowercase(b),c=lowercase(c)),a(b,c)):!1}function endsWith(a,b,c){return stringComparison(function(a,b){return-1!==a.indexOf(b,a.length-b.length)},a,b,c)}function startsWith(a,b,c){return stringComparison(function(a,b){return 0===a.lastIndexOf(b,0)},a,b,c)}function contains(a,b,c){return stringComparison(function(a,b){return-1!==a.indexOf(b)},a,b,c)}function doArraysIntersect(a,b){for(var c=0;c<a.length;c++)if(inArray(a[c],b)>-1)return!0}function escapeCSVCell(a){return"undefined"!=typeof a?(a.indexOf(QUOTE)>-1&&(a=a.replace(/"/g,ESCAPED_QUOTE)),$.each(CHARS_THAT_MUST_BE_QUOTED,function(b,c){return a.indexOf(c)>-1?(a=QUOTE+a+QUOTE,!1):void 0})):a="",a}function escapeSelector(a){return a&&a.replace(/\./g,"\\.")}function escapeSingleQuotes(a){return a&&a.replace(/'/g,"\\'")}function getBodiesOfZIPResourceFiles(a,b){b||(b={});var c,d=$.Deferred(),e=!b||b.cache!==!1,f=function(a){var c={},e=b&&b.json===!0;$.each(a,function(a,b){var d=c[a]={};$.each(b,function(a,b){try{d[a]=e?JSON.parse(b):b}catch(c){}})}),d.resolve(c)};return e&&(_resourceBodiesCache||(_resourceBodiesCache={}),c={},$.each(a,function(a,b){var d,e=_resourceBodiesCache[a];return e?(d=c[a]={},$.each(b,function(a,b){return e[b]?void(d[b]=e[b]):(c=!1,!1)}),!!c):(c=!1,!1)})),c?f(c):skuid.remote().getBodiesOfZIPResourceFiles(JSON.stringify(a),function(a){if(a)try{a=JSON.parse(a)}catch(b){a=null}a&&!a.error?(e&&$.each(a,function(a,b){var c=_resourceBodiesCache[a];c||(c=_resourceBodiesCache[a]={}),$.each(b,function(a,b){c[a]=b})}),f(a)):d.reject(a&&a.error?a.error:a)},{escape:!1,buffer:b.buffer!==!1}),d.promise()}function getJSONBodiesOfZIPResourceFiles(a,b){return getBodiesOfZIPResourceFiles(a,$.extend({json:!0},b))}function getBodyOfZIPResourceFile(a,b,c,d){var e={},f=$.Deferred(),g=(b?b+"__":"")+a;return e[g]=[c],getBodiesOfZIPResourceFiles(e,d).done(function(a){if(a=a[g],a&&a[c]){if(a=a[c],d&&d.json===!0)try{a=JSON.parse(a)}catch(b){}f.resolve(a)}else f.reject()}).fail(function(a){f.reject(a)}),f.promise()}function getJSONBodyOfZIPResourceFile(a,b,c,d){return getBodyOfZIPResourceFile(a,b,c,$.extend({json:!0},d))}function getNameField(a){return skuid.adapter.adapters.salesforce.getNameField(a)}function getCache(a){var b=describeCache[a];return b?b:(b=sessionStorage(a),b?(b=JSON.parse(b),describeCache[a]=b,b):null)}function setCache(a,b){describeCache[a]=b,b&&!b.__isFailure&&sessionStorage(a,JSON.stringify(b))}function getMetadataForRecordTypes(a,b){if(isApiEnabled()){var c,d,e,f=b?!!b.length:!1,g=function(a){var b=getCache(a),c=!1,d=!1;return b?b.__isFailure?d=!0:(cacheNeedsRefresh(b)&&(c=!0),(!b.modstamp||b.modstamp<skuid.page.modstamp)&&(c=!0)):c=!0,{result:b,getNew:c,failed:d}},h=function(b){return"skuid_recordTypeMetadata_"+a+(b?"_"+b:"_all")},i=!1,j="b";if(f){if(d=[],e={recordTypeMappings:d},$.each(b,function(a,b){var e=h(b),f=g(e);return f.failed?(i=!0,!1):void(f.result&&!f.getNew?d.push(f.result):f.getNew&&(c||(c=[]),c.push(b)))}),i)return!1}else{var k=h(),l=g(k);if(l.failed)return!1;l.result&&!l.getNew?e=l.result:l.getNew&&(c=[])}if(c){c.unshift(j);var m,n;try{m=sforce.connection.describeLayout(a,c)}catch(o){return m={__isFailure:!0},checkInCache(m),c.length>1?$.each(c,function(a,b){b!==j&&setCache(h(b),m)}):setCache(h(),m),!1}n=m?toArray(m.recordTypeMappings):!1,n&&(f?$.each(n,function(a,b){checkInCache(b),setCache(h(b.recordTypeId),b),d.push(b)}):(checkInCache(m),setCache(h(),m),e=m))}return e}return!1}function getAPIDescribeLayout(a){if(isApiEnabled()){var b="skuid_describeLayout_"+a,c=getCache(b),d=!1;if(c?(cacheNeedsRefresh(c)&&(d=!0),(!c.modstamp||c.modstamp<skuid.page.modstamp)&&(d=!0)):d=!0,d)try{c=sforce.connection.describeLayout(a),checkInCache(c),setCache(b,c)}catch(e){}return c}return!1}function getAPIDescribeSObject(a){if(isApiEnabled()){var b="skuid_describeSObject_"+a,c=getCache(b),d=!1;if(c?(cacheNeedsRefresh(c)&&(d=!0),(!c.modstamp||c.modstamp<skuid.page.modstamp)&&(d=!0)):d=!0,d)try{c=sforce.connection.describeSObject(a),checkInCache(c),setCache(b,c)}catch(e){}return c}return!1}function getPicklistEntriesValidForRecordTypes(a,b,c){var d,e,f=function(a){a.value in d||(d[a.value]=1,e.push(a))},g=!1,h=getMetadataForRecordTypes(a,c);if(h){var i=h.recordTypeMappings;if(i){var j=[];$.each(toArray(i),function(){inArray(this.recordTypeId,c)>-1&&j.push(this)}),j.length&&(e=[],d={},$.each(j,function(a,c){var d=c.picklistsForRecordType;d&&$.each(toArray(d),function(){return this.picklistName===b?(g||(g=!0),this.picklistValues instanceof Array?$.each(this.picklistValues,function(){f(this)}):f(this.picklistValues),!1):void 0})}))}}return g?e:null}function highlightSFTab(a){var b,c=$(".bodyDiv"),d=$("ul#tabBar"),e=d.children("li.zen-active, li.active"),f=e.find("span.zen-assistiveText, span.assistiveText").detach(),g=skuid.utils.sfTabs[a];e.removeClass("zen-active primaryPalette primaryPalette active").find("a").attr("title",function(a,b){return b.replace(" - Selected","")}),a&&g&&(b=d.children("li").has('a[href="'+a+'"]')),b.length&&(b.first().addClass("zen-active active primaryPalette").find("a").attr("title",function(a,b){return b+" - Selected"}).after(f),g.color&&(b.css({"background-color":"#"+g.color,"border-color":"#"+g.color}),c.css("border-top-color","#"+g.color)))}function ifElse(a,b,c){return a?b:c}function insertAtIndex(a,b,c){0===c?a.prepend(b):a.children().eq(c-1).after(b)}function loadJS(a,b){return skuid.load.js(a,b)}function loadRichTextApi(a){if(skuid.CKEDITOR)return void a(skuid.CKEDITOR);if(loadRichTextApi.loading)return void loadRichTextApi.loading.done(function(){a(skuid.CKEDITOR)});loadRichTextApi.loading=$.Deferred();var b,c=getSafeRelativeUrl("/resource/"+skuid.version.date+"/skuid__CKEditor/ckeditor/ckeditor.js");loadJS(c,function(){b=skuid.CKEDITOR=window.CKEDITOR,loadRichTextApi.configured||(loadRichTextApi.configured=!0,b.disableAutoInline=!0),a(b),loadRichTextApi.loading.resolve()})}function loadCSS(a,b){return b.href=a,skuid.load.css(b,b.callback)}function getSearchOperatorForDisplayType(a,b,c){var d;return d="MULTIPICKLIST"===b?"="===a||"exact"===a?"=":"includes":"ID"===b||"Id"===c||endsWith(c,".Id")?"=":"exact"===a?"=":a}function createSearchSubConditions(a,b,c,d,e){e||(e={});var f,g=e.delimiter||" ",h=e.searchOperator||"contains",i=1;return b.subConditions=[],b.subConditionLogic="",f=e.tokenize?c.split(g):[c],$.each(f,function(c){var e=this+"",g=[];return e?($.each(d,function(c,d){var f=d.searchOperator||h,j=a.getField?a.getField(d.id):d;j||(j=d);var k=j&&j.displaytype?j.displaytype:!1,l="REFERENCE"===k?getFieldReference(d.id,d):d.id,m={name:"__default_searchbox_subcondition",type:"fieldvalue",field:l,inactive:!1};if(m.operator=getSearchOperatorForDisplayType(f,k,l),"MULTIPICKLIST"===k)"="===m.operator||"exact"===m.operator?m.value=e:m.values=[e];else if("ID"===k||"Id"===l||endsWith(l,".Id")){if(!e||18!==e.length&&15!==e.length)return!0;m.value=e}else m.value=e;if("REFERENCE"===k){var n=a.getField(l);n&&n.targetObjects&&(m.fieldTargetObjects=n.targetObjects)}else d.targetObjects&&(m.fieldTargetObjects=d.targetObjects);b.subConditions.push(m),g.push(i),i++}),b.subConditionLogic+="("+g.join("OR")+")",void(c<f.length-1&&(b.subConditionLogic+="AND"))):!0}),b}function extractFieldsFromTemplate(a,b){b||(b={});var c={},d=getMergeApi(),e=function(a){if(a instanceof Array)for(var f=0;f<a.length;f++){var g=a[f];if("name"===g[0]||"&"===g[0]||"#"===g[0]||"^"===g[0]){var h,i=g[1];""!==i&&(h=d[i],b.ignoreGlobals&&(h||-1!==i.indexOf("$")||-1!==i.indexOf("Model."))||b.ignoreFunctions&&"function"==typeof h||(c[i]=1))}g.length>=5&&g[4]instanceof Array&&e(g[4])}};return e(skuid.Mustache.parse(a,["{{","}}"])),e(skuid.Mustache.parse(a,["{{{","}}}"])),Object.keys(c)}function modelLookup(a,b,c,d){var e,f,g,h,i=skuid.$M(a),j=getDisplayTypeOfEntity(d);return i&&(e=i.getField(c),e&&(f=e.displaytype),f&&j&&f!==j&&("INTEGER"===f?d=parseInt(d,10):"DOUBLE"===f&&(d=parseFloat(d))),g=i.getRows().filter(function(a){return i.getFieldValue(a,c,!0)===d})),g&&g.length&&(h=i.getFieldValue(g[0],b,!0)),h}function getDisplayTypeOfEntity(a){if(null!==a)switch(typeof a){case"boolean":return"BOOLEAN";case"number":return a%1===0?"INTEGER":"DOUBLE";case"object":if(a){if(a instanceof Array)return"ARRAY";if(a instanceof Date)return"DATETIME"}return"OBJECT";case"string":if(Date.parse(a)){if(-1!==a.indexOf("T"))return"DATETIME";if(3===a.split("-").length)return"DATE"}else if(contains(a,"://"))return"URL";try{if(!isNaN(+a))return-1!==a.indexOf(".")?"DOUBLE":"INTEGER"}catch(b){}}return"STRING"}function evaluateFormula(a){var b={evaluateFormulas:!0,outputType:a.outputType},c=a.model,d=a.row,e=a.formula||"",f=c?d?MERGE_ROW:MERGE_MODEL:MERGE_GLOBAL;return getMergeResult(f,e,b,c,d)}function applyFormulaFunctions(a){return $.each(validFormulaFunctions,function(b,c){var d=0===c.args;a=a.replace(new RegExp(b+"\\("+(d?"\\s*\\)":""),"g"),c.output+"("+(d?")":""))}),a}function preparse(a){return[a.match(PREPARSE_REGEX)||[],a.split(PREPARSE_REGEX)]}function skuidField(){var a=this;return function(b,c){return("Id"in a?a.Id:"")+'">'+c(b)}}function urlEncode(){return function(a,b){return encodeURIComponent($("<div>").html(b(a)).text())}}function urlDecode(){return function(a,b){return decodeURIComponent($("<div>").html(b(a)).text())}}function _mergeInContext(a,b,c,d){c||(c={});var e=c.model,f=c.row,g=d||_defaultMergeSettings;return c&&(g.apiExtensions=c),f&&e?a(MERGE_ROW,b,g,e,f):e?a(MERGE_MODEL,b,g,e):a(MERGE_GLOBAL,b,g)}function mergeInContext(a,b,c){return _mergeInContext(merge,a,b,c)}function mergeAsData(a,b,c,d,e){return c||(c={}),c.asData=!0,b?getMergeResult(a,b,c,d,e):null}function mergeAsDataInContext(a,b){return _mergeInContext(mergeAsData,a,b)}function mergeAsTextInContext(a,b,c){return _mergeInContext(mergeAsText,a,b,c)}function mergeAsText(a,b,c,d,e){return c||(c={}),"undefined"==typeof c.nl2br&&(c.nl2br=!1),c.asText=!0,b?getMergeResult(a,b,c,d,e):""}function merge(a,b,c,d,e){return getMergeResult(a,b,c,d,e).merges}function getMergeApi(a){a||(a={});var b=a.mode||MERGE_GLOBAL,c=a.model,d=a.row,e=a.apiExtensions,f=getUserInfo(),g=skuid.page,h=window.sforce?sforce.connection:{},i=$.extend({},a.apiExtensions,{$Label:skuid.label.map,$Model:skuid.model.map(),$Param:g.params,$Api:{Session_Id:h.sessionId,Organization_Id:f.organizationId,User_Id:f.userId,Partner_Server_Url:h.partnerServerUrl,Enterprise_Server_Url:h.enterpriseServerUrl,Partner_Server_Urls:h.partnerServerUrls,Enterprise_Server_Urls:h.enterpriseServerUrls},$User:f,$Site:{CurrentSiteUrl:g.currentSiteUrl,Prefix:g.sitePrefix},urlEncode:urlEncode,encodeUrl:urlEncode,urlDecode:urlDecode,decodeUrl:urlDecode});if((b===MERGE_MODEL||b===MERGE_ROW)&&$.extend(i,{Model:{conditions:c.conditions,Data:c.data,data:c.data,Label:c.label,label:c.label,LabelPlural:c.labelPlural,labelPlural:c.labelPlural,fields:c.fields,Fields:c.fieldsMap,fieldsMap:c.fieldsMap,KeyPrefix:c.keyPrefix,keyPrefix:c.keyPrefix,ObjectName:c.objectName,objectName:c.objectName,id:c.id,updateable:c.updateable,createable:c.createable,deleteable:c.deleteable}}),b===MERGE_MODEL)$.extend(i,{SkuidField:skuidField});else if(b===MERGE_ROW){var j=c.data.indexOf(d)+1;$.extend(i,d,{first:1===j,last:j===c.data.length,index:j,SkuidField:skuidField})}return e&&$.extend(i,e),i}function getMergeResult(mode,template,options,model,row){var arg0=arguments[0];if(null!==arg0&&"object"==typeof arg0&&(mode=arg0.mode,template=arg0.template,options=arg0.options,model=arg0.model,row=arg0.row),row&&"function"==typeof row&&(row=row()),row||"row"!==mode||(model&&model.data&&model.data.length?row=model.data[0]:mode="model"),model||"model"!==mode||(mode="global"),!template&&""!==template)throw"Required argument 'template' was not provided.";if(!(mode&&mode.toLowerCase()in validModes))throw"Invalid merge mode. Valid modes are: global,model,row.";mode=mode.toLowerCase(),options||(options={});var m=model,fieldsMap=m?m.fieldsMap:null,subFieldsMap,asText=options.asText===!0,asData=options.asData===!0,outputType=options.outputType,evaluateFormulas=options.evaluateFormulas,mergeResult={fields:[]},parseResult=preparse(template),merges=parseResult[0],formats=parseResult[1],newTemplate="",childRelName=!1,index=-1,remainingFormats=formats.length,format,api,apiExtensions=options.apiExtensions,localDate;if(merges.length)api=getMergeApi({mode:mode,apiExtensions:apiExtensions,model:m,row:row});else if(asText||asData)return template;if(asData){if(1===merges.length&&""===formats.join("")){var fieldsInTemplate=extractFieldsFromTemplate(merges[0]);if(1===fieldsInTemplate.length)return getObjectProperty(api,fieldsInTemplate[0])}asText=!0}for(;remainingFormats>0;){format=formats[++index],remainingFormats--,newTemplate+=format;var token=merges[index];if(token){var isTriple="{{{"===token.substring(0,3),fieldName=token.substring(isTriple?3:2,token.lastIndexOf(isTriple?"}}}":"}}")),firstChar=fieldName.charAt(0),isSectionChar=-1!==["#","/","^"].indexOf(firstChar),isSpecialChar=isSectionChar||-1!==["&","!"].indexOf(firstChar),isSectionEndChar="/"===firstChar,isSectionStartChar=isSectionChar&&!isSectionEndChar,isDateTimeData=startsWith(fieldName,"$System")||startsWith(fieldName,"$Date")||startsWith(fieldName,"$Time"),dateTimeParts,isOtherModelMerge=startsWith(fieldName,"$Model.");if(options.fieldPrefix&&(fieldName=isSpecialChar?firstChar+options.fieldPrefix+fieldName.substr(1):options.fieldPrefix+fieldName,token="{{"+fieldName+"}}"),-1!==fieldName.indexOf(".records")&&(isSectionStartChar?childRelName=fieldName.substring(1,fieldName.indexOf(".records")):isSectionEndChar&&(childRelName=!1)),isDateTimeData){if(localDate=skuidTime.getLocalDateTime(new Date),"$System.Now"===fieldName)fieldName=isTriple?skuidTime.getSFDateTime(localDate):skuidTime.makeFormattedLongDateTime(localDate);else if(dateTimeParts=fieldName.split("."),1===dateTimeParts.length)fieldName="$Date"===fieldName?skuidTime.makeFormattedDateFromLocal(localDate):skuidTime.formatTime(getUserLocale().timeFormat,localDate);else switch(dateTimeParts[1]){case"Year":fieldName=localDate.getFullYear();break;case"Month":fieldName=localDate.getMonth()+1;break;case"Day":fieldName=localDate.getDate();break;case"DayOfWeek":fieldName=localDate.getDay();break;case"Hour":fieldName=localDate.getHours();break;case"Minute":fieldName=localDate.getMinutes()+1;break;case"Second":fieldName=localDate.getSeconds();break;case"Millisecond":fieldName=localDate.getMilliseconds();break;case"Period":fieldName=skuidTime.getPeriod(localDate)}newTemplate+=fieldName;continue}if(isTriple||evaluateFormulas||"&"===firstChar){if(evaluateFormulas){var fieldMetadata,fieldNameParseParts,fieldMetadataModel,previousFormatTrimmed=formats.length>=index?$.trim(formats[index]):null,nextFormatTrimmed=formats.length>=index?$.trim(formats[index+1]):null,adjacentFormatIsOperator;previousFormatTrimmed&&(previousFormatTrimmed=previousFormatTrimmed.substring(previousFormatTrimmed.length-1,previousFormatTrimmed.length)),nextFormatTrimmed&&(nextFormatTrimmed=nextFormatTrimmed.substring(0,1)),adjacentFormatIsOperator=$.inArray(nextFormatTrimmed,_operators)>-1||$.inArray(previousFormatTrimmed,_operators)>-1,contains(fieldName,".data.")?(fieldNameParseParts=fieldName.split("."),fieldMetadataModel=fieldNameParseParts.splice(0,isOtherModelMerge?4:3),fieldMetadataModel=isOtherModelMerge?skuid.$M(fieldMetadataModel[1]):m,fieldMetadata=fieldMetadataModel?fieldMetadataModel.getField(fieldNameParseParts.join(".")):!1):fieldMetadata=m.getField(fieldName);var valType=fieldMetadata.displaytype,outputAsNumber=inArray(valType,_numberTypes)>-1,outputAsBoolean="BOOLEAN"===valType,outputAsString=!outputAsBoolean&&!outputAsNumber,wrapInQuotes=outputAsString,isDateType=!1;fieldMetadata&&"childRelationship"!==fieldMetadata.type&&(isDateType=startsWith(valType,"DATE"),isDateType&&adjacentFormatIsOperator&&(wrapInQuotes=!1)),newTemplate+="{{#"+fieldName+"}}"+(wrapInQuotes?'"':""),newTemplate+=adjacentFormatIsOperator&&isDateType?"skuid.time.parseDate"+("DATETIME"===valType?"Time":"")+'String("{{{'+fieldName+'}}}")':"{{"+fieldName+"}}",newTemplate+=(wrapInQuotes?'"':"")+"{{/"+fieldName+"}}{{^"+fieldName+"}}",newTemplate+=outputAsNumber||adjacentFormatIsOperator&&isDateType?"0":outputAsBoolean?"false":'""',newTemplate+="{{/"+fieldName+"}}"}else newTemplate+="{{"+fieldName+"}}";continue}if(!isTriple){if("$System.Now"===fieldName){newTemplate+=skuidTime.makeFormattedLongDateTime(new Date);continue}if(mode!==MERGE_GLOBAL){var isValidField,isChildRel=isSectionChar&&childRelName&&fieldsMap&&childRelName in fieldsMap&&"childRelationship"===fieldsMap[childRelName].type;if(isChildRel)isValidField=!1;else if(childRelName&&!isSectionChar){var childRelField=fieldsMap[childRelName];subFieldsMap=childRelField.subFieldsMap,isValidField=subFieldsMap&&fieldName in subFieldsMap||"Id"===fieldName}else isValidField=fieldsMap&&fieldName in fieldsMap||"Id"===fieldName;if(isValidField){mode===MERGE_ROW?(newTemplate+='<span class="nx-merge" data-field="'+fieldName,newTemplate+=childRelName?'" data-parentfield="'+childRelName+'" data-parentrowid="'+row.Id+'" data-rowid="{{#SkuidField}}'+token+"{{/SkuidField}}</span>":'">'+token+"</span>"):newTemplate+='<span class="nx-merge" data-field="'+fieldName+(childRelName?'" data-parentfield="'+childRelName:"")+'" data-rowid="{{#SkuidField}}'+token+"{{/SkuidField}}</span>";continue}}}newTemplate+=token}}var doNotConvertNewlinesToBreaks=options.asText===!0&&options.nl2br!==!0||options.allowHTML===!0||options.nl2br===!1||evaluateFormulas,rawRender=skuid.Mustache.render(newTemplate,api),initialMerges=doNotConvertNewlinesToBreaks?rawRender:nl2br(rawRender),registerFields=!0,createFields=!0;if(evaluateFormulas){initialMerges=applyFormulaFunctions(initialMerges);var formulaResult;try{formulaResult=eval(initialMerges)}catch(e){return $(document.body).one("pageload",function(){skuid.component.getByType("skuidpage")[0].addProblem("Invalid syntax for field formula: "+template+". "+e)}),null}return"INTEGER"===outputType?parseInt(formulaResult,10):"CURRENCY"===outputType||"NUMBER"===outputType?parseFloat(formulaResult):"BOOLEAN"===outputType?!!formulaResult:"DATE"===outputType?skuidTime.getSFDate(formulaResult):"DATETIME"===outputType?skuidTime.getSFDateTime(formulaResult):formulaResult}options&&options.createFields===!1&&(createFields=!1,registerFields=!1),options&&options.registerFields===!1&&(registerFields=!1);var newmerges=$('<div class="nx-template">'+initialMerges+"</div>");return createFields&&$.each(newmerges.find(".nx-merge"),function(){var a,b=$(this),c=b.data("field"),d=b.data("parentfield"),e=b.data("parentrowid"),f=b.data("rowid");if(!f&&row&&(f=row.Id),d&&e&&f){var g=m.dataMap[e][d].records;$.each(g,function(b,c){return c.Id==f?(a=c,!1):void 0})}else a=m.dataMap[f];if(c&&a){var h={fieldId:c,editable:!1,register:registerFields};d&&(h.fieldContext=d);var i=new skuid.ui.Field(a,m,null,h);i.render(),mergeResult.fields.push(i),b.after(i.element),b.remove()}}),asText?newmerges.text():(mergeResult.merges=newmerges,mergeResult)}function outerHTML(a){return a.outerHTML||function(a){var b,c=document.createElement("div");return c.appendChild(a.cloneNode(!0)),b=c.innerHTML,c=null,b}(a)}function isPromise(a){var b=!0;return $.each(_requiredFunctions,function(c,d){return"function"!=typeof a[d]?(b=!1,!1):void 0}),b}function writeXmlToPageLayoutFields(a,b,c){var d;if(d=a?isString(a)?a:""+getXML(a):"",layoutFields.length){for(var e,f,g,h,i,j="",k=0,l=0,m=d.length,n=0,o=0,p={};o<layoutFields.length&&m>n;){if(e=layoutFields[o],f=b.getField(e).length,g=m>=k+f,j=d.substring(k,g?k+f:m),h=!1,g&&j.length&&""!==$.trim(j))for(i=j.length-1;i>-1;i--)if(""===$.trim(j[i]))h=!1;else{if(h){l=i+1;break}h=!0}else l=j.length;b.updateRow(c,e,j.substring(0,l)),k+=l,n+=f,o++}for(;o<layoutFields.length;)e=layoutFields[o],p[e]=null,o++;if(b.updateRow(c,p),m>n)throw"The total number of characters in this Page's Layout ("+m+") exceeds the maximum number of characters available for each Page ("+n+"). Please split out some of your content into other Pages, and then include these Pages within this Page."}}function getConversionRates(){return skuid.utils.conversionRates}function getRowCurrency(a){var b,c="CurrencyIsoCode",d=a.model,e=a.row,f=a.field,g=f.lastIndexOf("."),h=d.isAggregate,i=-1!==g?f.substring(0,g+1):"";return h?b=getConversionRates()[0].IsoCode:(b=d.getFieldValue(e,i+c,!0),b||(b=d.getFieldValue(e,c,!0))),b}function convertCurrency(a,b,c){var d,e=getConversionRates(),f=skuid.utils.conversionRatesMap;if(!e||!e.length)return a;if(d=e[0].IsoCode,f||(f=skuid.utils.conversionRatesMap={},$.each(e,function(a,b){f[b.IsoCode]=b})),f&&f[b]&&f[c]){var g,h=f[c];if(b!==d){var i=f[b];g=Math.pow(10,6),a=Math.round(a/i.ConversionRate*g)/g}return g=Math.pow(10,6),Math.round(a*h.ConversionRate*g)/g
}}function _setAttachmentBaseUrl(a){a&&(_attachmentBaseUrl=a.substring(0,a.indexOf("?")))}function getUrlFromAttachmentId(a){return _attachmentBaseUrl+"?file="+a+"&retURL="+encodeURIComponent(location.pathname+location.search)}function makeXMLDoc(a){return $($.parseXML(a)).children().first()}function getXML(a){return a.xml?a.xml:(new XMLSerializer).serializeToString(a)}function size(a){var b,c=0;for(b in a)a.hasOwnProperty(b)&&c++;return c}function delayInputCallback(a,b,c){var d,e,f="change";c=c||{},c.dataPropertyName?a.data("curval",a.val()):d=a.val(),f+=_ie?9===_ie?" selectionchange keyup":9>_ie?" keyup":" keyup input":" keyup input",a.on(f,function(f){if(!a.prop("disabled")){var g=a.val(),h=function(){if(c.dataPropertyName&&(d=a.data(c.dataPropertyName)),g===a.val()&&g!==d){var e=d;c.dataPropertyName?a.data(c.dataPropertyName,g):d=g,b&&b(g,e)}};clearTimeout(e),"change"===f.type?h():e=setTimeout(h,400)}})}function delayEventCallback(a){if(a&&a.eventType){var b,c=a.eventType,d=a.delay||400,e=a.callback,f=a.context||$(window);f.on(c,function(){clearTimeout(b),b=setTimeout(function(){e&&e()},d)})}}function registerPlugin(a,b){$.fn[a]=function(c){return b[c]?b[c].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof c&&c?void $.error("Method "+c+" does not exist on jQuery."+a):b.init.apply(this,arguments)}}function registerBlurHandler(a,b){var c=function(d){$(d.target).closest(a).length||($("html").off("click.skuidBlur",c),b())};$("html").on("click.skuidBlur",c)}function generateGUID(){return _GUID++}function compressInt(a){for(var b="";;)if(b=compressionArray[63&a]+b,a>>>=6,0===a)break;return b}function generateUniqueId(a){a||(a={});var b=a.prefix,c=""+compressInt(Date.now());return c.substr(0,c.length-2),(b?b:"sk")+"-"+c+"-"+generateGUID()}function createMapForArray(a,b,c,d,e){return e=e||{addKeyRelationships:!0},a&&$.each(a,function(){var a=this;a[c]={},a[b]&&$.each(a[b],function(){var b,f=this;$.each(d instanceof Array?d:[d],function(){if(b=f[this],b&&"undefined"!=b&&(a[c][b]=f,e.addKeyRelationships&&isString(b)&&-1!==b.indexOf("."))){for(var d=b.split("."),g=0,h=a[c];g<d.length-1;)d[g]in h||(h[d[g]]={}),h=h[d[g++]];h[d[g]]=f}})})}),a}function toArray(a){return a instanceof Array?a:[a]}function removeEventSubscriptions(a){a&&a.data("eventSubscriptions")&&($.each(a.data("eventSubscriptions"),function(){skuid.events.unsubscribe(this)}),a.removeData("eventSubscriptions"))}function conditionallyRender(a,b,c,d,e,f){return f||(f={}),conditionallyDo(function(){var b,g=d.data("rendered");return g?!1:(b=a(c,d,e,f),d.data("rendered",!0),b)},function(){var a,g=d.data("rendered");return g?(a=b(c,d,e,f),d.data("rendered",!1),a):!1},f.renderConditions?f.renderConditions:c.children("renderconditions"),d,f)}function conditionallyDo(a,b,c,d,e){function f(a){return areConditionsMet(a,{row:p,model:q,logicType:l,logic:m})}function g(c){c?e.event=c:"event"in e&&delete e.event,r||(r=!0,f(o)?a(e):b(e),r=!1)}function h(a){var b,c=q&&p&&q.id&&(!a.fieldModel||a.fieldModel===q.id),d=c?q.id:a.fieldModel?a.fieldModel:q?q.id:null,e=c?p:a.fieldRow?a.fieldRow:p?p:null;if("object"==typeof e)b=getObjectProperty(e,"Id");else if("function"==typeof e){var f=e();b=f&&f.Id}else b=e;return{modelId:d,rowId:b}}function i(){o.length=0,j={};var a,b,c=d.data("eventSubscriptions");if(s.length){if($.each(s,function(a,b){skuid.events.unsubscribe(b)}),c&&c.length)for(a=c.length-1;a>=0;a--){b=c[a];for(var e=0;e<s.length;e++)b===s[e]&&c.splice(a,1)}s.length=0}n.each(function(){var a=new skuid.model.Condition($(this));o.push(a)}),o.length&&($.each(o,function(a,b){var c,d,e=h(b),f=e.modelId,g=e.rowId,i=b.field,k=b.sourceType;f&&(c=j[f],c||(c=j[f]={}),g?(d=c[g],d||(d=c[g]={})):"fieldvalue"===k&&(c.__conditionsNeedRows=!0),"hasChanged"===b.sourceProperty?"modelproperty"===k?c.__any=!0:d&&(d.__any=!0):d&&i&&(contains(i,".")&&(i=getReferenceFieldNameFromRelationshipField(i)),d[i]||(d[i]=1)))}),s.push(t("row.updated",function(a){var b,c=j[a.modelId],d=!1;c&&(b=c[a.rowId],b&&($.each(b,function(b){return hasObjectProperty(a.updates,b)?(d=!0,!1):void 0}),!d&&b.__any&&(d=!a.rowHadPriorChanges)),d||(c.__any?d=!a.modelHadPriorChanges:c.__conditionsNeedRows&&(delete c.__conditionsNeedRows,i(),d=!0))),d&&g({name:"row.updated",data:a})})),s.push(t("row.created",function(a){a.modelId in j&&g({name:"row.created",data:a})})),s.push(t("row.deleted",function(a){a.modelId in j&&g({name:"row.deleted",data:a})})),s.push(t("row.undeleted",function(a){a.modelId in j&&g({name:"row.undeleted",data:a})})),s.push(t("models.saved",function(a){var b=!1;$.each(j,function(c,d){if(c in a.models){b=!0;var e=a.insertResults;e&&e.length&&$.each(e,function(a,b){var c=b.oldId,e=b.id;b.success&&c&&e&&c in d&&(d[e]=d[c],delete d[c])})}}),b&&g({name:"models.saved",data:a})})),s.push(t("models.cancelled",function(a){$.each(j,function(b){return b in a.models?(g({name:"models.cancelled",data:a}),!1):void 0})})),s.push(t("models.loaded",function(a){$.each(j,function(b){return b in a.models?(g({name:"models.loaded",data:a}),!1):void 0})}))),s.length&&(c&&c.length?c.push.apply(c,s):d.data("eventSubscriptions",s))}e||(e={});var j,k=e.context||{},l=c.attr("logictype"),m=c.attr("logic"),n=c.children(),o=[],p=e.row?e.row:k.row,q=e.model?e.model:k.model,r=!1,s=e.eventSubscriptions=[],t=skuid.events.subscribe;return i(),(o.length?f(o):!0)?a(e):b(e)}function getUserLocale(){return skuid.utils.userLocale}function getHourOptions(a,b,c){var d,e=getUserLocale().timeFormat,f=e.toLowerCase(),g=f.indexOf("a"),h=f.indexOf("h"),i=[],j=new Date;for(-1!=g&&(e=h>g?"a"+e.charAt(h):e.charAt(h)+"a"),a=a||0,b=b||24,d=a;b>=d;d++)j.setHours(d,0,0,0),i.push({value:d,label:skuidTime.formatTime(e,j),isSelected:c===d});return i}function niceExpand(a,b,c,d){c=c||0;var e,f,g,h=a.scrollParent(),i=h[0],j=i.scrollTop,k=i.clientHeight,l=j+k;if(!d&&$(b).is(":visible"))b.hide();else if(b.show(),e=a[0].offsetHeight,g=a[0].offsetTop-c,f=g+e,f>=l-1){var m=Math.min(f-k+18,g);m>j&&(_ie||h.animate({scrollTop:m},500))}}function scrollTo(a,b){b=b||0;var c=a.scrollParent(),d=c[0],e=d.clientHeight,f=a[0].offsetHeight,g=a[0].offsetTop+f-b,h=g-e+18;_ie||c.animate({scrollTop:h},500)}function addResizeHandler(a,b){delayEventCallback({eventType:"resize orientationchange",delay:b,callback:a})}function processStylesNode(a,b,c){b.element&&(b=b.element);var d={};c=c||{},c.removeInlineStyles&&b.removeAttr("style"),a.find("styleitem").each(function(){var a,b=$(this),e=b.attr("property"),f=b.attr("value"),g=b.attr("type");"background"===g&&"image"===b.attr("bgtype")?(!c.whitelist||c.whitelist&&-1!==c.whitelist.indexOf("background-image"))&&(a=computeImageUrl({source:b.attr("bg-source"),resourceName:b.attr("bg-resource"),resourcePath:b.attr("bg-path"),url:b.attr("bg-url")}),a&&(d["background-image"]="url("+a+")")):e&&(!c.whitelist||c.whitelist&&-1!==c.whitelist.indexOf(e))&&(d[e]=f||"")}),$.isEmptyObject(d)||b.css(d)}function computeImageUrl(a){var b,c,d=a.source,e=a.resourceName,f=a.resourcePath,g=a.model,h=a.row,i=a.field,j=a.url;return"staticresource"===d?(e&&(b="/resource/"+e),f&&(b+=startsWith(f,"/")?f:"/"+f,b=h&&g?mergeAsText("row",b,{createFields:!1},g,h):mergeAsText("global",b,{createFields:!1}))):"attachment"===d&&g&&h?(c=g.getFieldValue(h,i),c&&(b=getUrlFromAttachmentId(c))):("url"===d||"external"===d)&&(b=h&&g?mergeAsText("row",j,{createFields:!1},g,h):mergeAsText("global",j,{createFields:!1})),b}function getCSSSizeObj(a,b){var c;return b=b||{},a&&(c=a.toString().match(/^([\d]*\.?[\d]+)([^\d]*)$/)),c?(c[1]=c[1].indexOf(".")>=0?parseFloat(c[1]):parseInt(c[1],10),{original:c[0],number:c[1],unit:c[2]?c[2]:b.defaultUnit||"px"}):!1}function getCacheTimestamp(){return skuid.dev?skuid.version.date:(new Date).getTime()}function uploadBlob(a,b,c,d,e){var f,g,h=$.Deferred(),i=getSafeRelativeUrl("/services/data"+a),j="wootwootboundary";return e||(e=d.name),f=new Blob(["--boundary_"+j+'\nContent-Disposition: form-data; name="entity_content";\nContent-Type: application/json\n\n'+JSON.stringify(b)+"\n\n--boundary_"+j+"\nContent-Type: "+d.type+'\nContent-Disposition: form-data; name="'+c+'"; filename="'+d.name+'"\n\n',d,"\n\n--boundary_"+j+"--"],{type:'multipart/form-data; boundary="boundary_'+j+'"'}),g=new XMLHttpRequest,g.upload.addEventListener("progress",function(a){h.notify(a)},!1),g.open("POST",i,!0),g.setRequestHeader("Authorization","Bearer "+getUserInfo().sessionId),g.setRequestHeader("Accept","application/json"),g.onreadystatechange=function(){4==g.readyState&&(g.status>=200&&g.status<300?h.resolve(g):h.reject(g))},g.send(f),h.promise()}function SelectItem(a){var b=this;if(b._GUID="SelectItem-"+generateGUID(),!a)throw"You must provide a configuration object when creating a new SelectItem.";if(!("value"in a))throw"Value is required.";$.extend(b,a),"label"in a||(b.label=b.value),b.isSelected||(b.isSelected=!1)}function SelectList(){this.items=[],this.itemsMap={},this.selectedIndex=this.selectedKey=!1}function KeyValueService(a){a||(a={});var b=this;b._get=a.get,b._set=a.set,b.key=b._createKey({id:a.id,type:a.type})}function TemplateComponent(a,b){var c=this;return c.element=a,c.options=b||{},c.editor=new skuid.ui.Editor(a,{showHeader:!1,showMessages:!1,customContentClass:"nx-editor-contents-template"}),b.model&&(c.model=b.model,c.editor.registerModel(c.model)),!c.conditions&&b.conditions&&(c.conditions=b.conditions),b.controllingComponent||(c.editor.handleSave=function(a){a&&c.render()},c.editor.handleCancel=function(){c.render()},c.editor.handleDataRefresh=function(){c.render()},c.editor.handleChange=function(){c.render()}),c.render(),c}function FileUploader(a){this.options=a,this.canUpload=!1,this.progressDiv=$("<div>").addClass("nx-file-progress");var b=hasFileAPISupport&&isApiEnabled()&&getUserInfo().isAuthenticated;this.dragAndDrop=b,"field"===a.storeAs||"record"===a.storeAs?this.canUpload=!0:b&&(this.canUpload=!0),this.iframe=$(b?'<input style="display:none;" type="file" id="'+generateUniqueId()+'">':'<iframe style="display:none;" src="" frameborder="0">')}function FileComponent(a,b){function c(){var a=isApiEnabled();return a||hasFileAPISupport?a&&!hasFileAPISupport?"Your browser does not support HTML5 file uploads.":!a&&hasFileAPISupport?"You do not have permission to upload files using the API.":void 0:"You either do not have permission to upload files using the API, or your browser does not support HTML5 file uploads."}var d=this;if(d.elem=a,d.elem.data("object",d),d.options=b,d.buttonText=b.label||$L("upload"),d.cacheBuster=b.cacheBuster,a.addClass("nx-fileupload"),d.model=b.model,d.row=b.row,("record"===b.storeAs||"chatterfeed"===b.storeAs||"field"===b.storeAs)&&!d.row)return a.text("No record found for file component."),!1;if(a.off("imageuploadcomplete imageuploadstarted mouseenter mouseleave click"),"record"===b.storeAs||"chatterfeed"===b.storeAs){if(!d.model.accessible)return a.text("You do not have permission to upload files to this record."),!1;if(d.model.isNewId(d.row.Id)){a.text("This record must be saved before you can upload files.");var e=skuid.events.subscribe("models.saved",function(c){d.model.id in c.models&&(d.model.isNewId(d.row.Id)||(a.empty(),new FileComponent(a,b),skuid.events.unsubscribe(e)))});return!1}d.uploader=new FileUploader(b),d.uploader.canUpload?(d.canCreateOrUpdateImage=!0,d.uploader.attach(d),d.uploader.setSource(d.row.Id,d.elem.attr("id"))):a.text(c())}else if("chatterfiles"===b.storeAs||"contentdocument"===b.storeAs)d.uploader=new FileUploader(b),d.uploader.canUpload?(d.canCreateOrUpdateImage=!0,d.uploader.attach(d),d.row&&d.uploader.setSource(d.row.Id,d.elem.attr("id"))):a.text(c());else if("staticresource"==b.storeAs)d.uploader=new FileUploader(b),d.uploader.canUpload?(d.canCreateOrUpdateImage=!0,d.uploader.attach(d)):a.text(c());else if("field"===b.storeAs){if(d.objField=b.idField,!d.objField)return a.text("No image field was specified."),!1;d.imageId=d.model.getFieldValue(d.row,d.objField),d.lookupFieldName=d.objField.substr(0,d.objField.length-1)+"r",d.attachmentIdFieldName=d.lookupFieldName+".skuid__AttachmentId__c",d.attachmentNameFieldName=d.lookupFieldName+".Name";var f=d.model.getField(d.objField);if(d.attId=d.model.getFieldValue(d.row,d.attachmentIdFieldName),d.attName=d.model.getFieldValue(d.row,d.attachmentNameFieldName),d.recomputeFlag=d.model.getFieldValue(d.row,d.lookupFieldName+".skuid__NeedsRecompute__c"),"Yes"===d.recomputeFlag)return d.recomputeId(),d;d.canCreateOrUpdateImage=d.model.accessible&&(d.options.editable||d.options.deleteable)&&(d.model.updateable&&f.editable||d.imageId),d.canCreateOrUpdateImage&&(d.uploader=new FileUploader(b),d.uploader.canUpload&&(d.uploader.attach(d),d.uploader.setSource(d.row.Id,d.elem.attr("id"),d.objField)))}if(d.uploader&&d.uploader.canUpload||(d.canCreateOrUpdateImage=!1),d.status=$("<div>").addClass("nx-fileupload-status").css({"float":"none",display:"inline-block"}).appendTo(a).hide(),d.statustext=$("<div>").appendTo(d.status),"filename"===b.displayAs||"record"===b.storeAs){var g,h;if(d.canCreateOrUpdateImage!==!1&&d.uploader&&(h=$("<div>"),d.progressParentDiv=h,skuid.mobile?(h.addClass("sm-button").css("display","inline-block"),g=new skuid.mobile.ui.Button({icon:"fa-plus",label:d.buttonText,element:h,iconColor:"green"}),h.on("tap",function(){d.uploader.pickFile()})):h.text(d.buttonText).css("vertical-align","top").skooButton({icon:"sk-icon-upload"}).click(function(){d.uploader.pickFile()}),h.appendTo(a)),skuid.mobile||(d.status.addClass("nx-actionselect nx-status").css({"vertical-align":"bottom","margin-left":"4px","word-break":"break-all"}),d.statustext.addClass("nx-actionselect-text")),d.model&&d.model.updateable&&b.deleteable){if(skuid.mobile){d.deletebutton=$('<div class="sm-button">');var i=new skuid.mobile.ui.Button({icon:"fa-minus",element:d.deletebutton,iconColor:"red"});d.deletebutton.on("tap",function(){i.startProcessing(),d.deleteImage()}),a.on("imagedeletecomplete",function(){i.stopProcessing()})}else d.deletebutton=$('<div class="sk-icon inline sk-icon-delete">').css({border:"3px solid #EEE","vertical-align":"top","background-color":"#EEE","margin-top":"3px",cursor:"pointer"}),d.deletebutton.click(function(){d.deleteImage()});d.deletebutton.css("display","inline-block").appendTo(a)}a.on("imageuploadstarted",function(a,b){d.dragAndDrop||(d.attName=b.fileName),d.setStatus(skuid.label.merge($L("uploading"),b.fileName)),d.status.off("click.skuid"),g&&g.startProcessing()}),g&&a.on("imageuploadcomplete",function(){g.stopProcessing()})}else"image"===b.displayAs&&(d.progressParentDiv=d.elem,d.elem.children(".nx-edithover").remove(),d.elem.addClass("nx-attachmentimage"),d.defaultImageSrc=getDefaultImageUrl(d.options.defaultImage||"person"),d.image=$("<img>").addClass("nx-attachmentimage-image").css("max-width","100%").appendTo(a),d.canCreateOrUpdateImage!==!1&&d.elem.on("mouseenter",function(){d.options.editable&&d.uploader&&d.elem.append($("<div>").addClass("nx-edithover sk-icon inline sk-icon-edit").css({"background-color":"white",opacity:"0.8",border:"4px solid white"}).click(function(a){d.elem.find(".nx-error").remove(),d.uploader&&d.uploader.pickFile(),a.stopPropagation()})),d.attId&&d.options.deleteable&&d.elem.append($("<div>").addClass("nx-edithover sk-icon inline sk-icon-delete").css({cursor:"pointer","background-color":"white",opacity:"0.8",border:"4px solid white",left:"4px"}).click(function(a){d.elem.find(".nx-error").remove(),d.deleteImage(),a.stopPropagation()}))}).on("mouseleave",function(){d.elem.find("div.nx-edithover").remove()}),d.elem.on("click",function(){if(d.attId){var a=$("<img>").attr("src",getUrlFromAttachmentId(d.attId)+(d.cacheBuster?"&cachebuster="+d.cacheBuster:"")).css({"max-height":"600px","max-width":"800px"});a.load(function(){var b=$("<div>").attr("title",encodeHTML(d.attName)).append(a).dialog({close:function(){$(this).remove()},modal:!0,width:"auto",resizable:!1,open:function(){$(".ui-widget-overlay").on("click",function(){b.dialog("close")})},dialogClass:"nx-imageview"})})}}),a.on("imageuploadstarted",function(a,b){b.fileName&&b.fileName!==d.attName}));a.on("imageuploadcomplete",function(a,c){var e,f,g;c&&c.newAttachmentId&&(d.attId=c.newAttachmentId,d.imageId=c.newImageId,d.syncModel(),d.draw()),c&&c.message?(e={text:c.message,hideIn:2},d.attId&&d.attName?"image"!==b.displayAs&&(e.complete=function(){d.setStatus(d.attName)}):!d.attId&&d.attName&&(d.attName=""),d.setStatus(e)):("field"!==b.storeAs&&(d.setStatus({text:$L("upload_successful"),hideIn:2}),"staticresource"==b.storeAs&&b.snippetName&&skuid.snippet.get(b.snippetName)(c)),f={record:"Attachment",chatterfeed:"ContentVersion",chatterfiles:"ContentVersion",contentdocument:"ContentVersion"},b.storeAs in f&&(g=[],$.each(skuid.model.list(),function(){this.objectName===f[b.storeAs]&&(g.push(this),this.cancel())}),skuid.model.updateData(g)))}),d.draw()}var $=skuid.$,utils=skuid.utils={},skuidTime=skuid.time,$L=skuid.$L,inArray=$.inArray,toClass={}.toString,MERGE_GLOBAL="global",MERGE_MODEL="model",MERGE_ROW="row",FIELD_VALUE="fieldvalue",QUOTE='"',ESCAPED_QUOTE='""',CHARS_THAT_MUST_BE_QUOTED=[",",'"',"\n"],RSCRIPT=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,CONDITION_LOGIC_REGEX=/^([and|or|\d|\(|\)]+)$/,PREPARSE_REGEX=/\{{2,3}[^\{\}]+\}{2,3}/g,_canUseSessionStorage="nodata",hasFileAPISupport=window.File&&window.FileReader&&window.FileList&&window.Blob&&window.XMLHttpRequest,_sessionIdHash,_mergeSettings={createFields:!1,registerFields:!1},_defaultMergeSettings={createFields:!0,registerFields:!1},validModes={global:1,model:1,row:1},_numberTypes=["INTEGER","NUMBER","PERCENT","CURRENCY"],_operators=["+","-","*","/"],userInfoCamelCasings={defaultcurrency:"defaultCurrency",firstname:"firstName",lastname:"lastName",organizationid:"organizationId",organizationname:"organizationName",profileid:"profileId",profilename:"profileName",sessionid:"sessionId",userid:"userId",username:"userName",userroleid:"userRoleId",usertype:"userType"},multiValueOperators={includes:1,excludes:1,"in":1,"not in":1},_resourceBodiesCache,describeCache={},_requiredFunctions=["then","done","fail"],layoutFields=["skuid__Layout__c","skuid__Layout2__c","skuid__Layout3__c","skuid__Layout4__c","skuid__Layout5__c"],_attachmentBaseUrl,_ie=function(){for(var a,b=3,c=document.createElement("div"),d=c.getElementsByTagName("i");c.innerHTML="<!--[if gt IE "+ ++b+"]><i></i><![endif]-->",d[0];);return b>4?b:a}(),_GUID=2,compressionArray="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz_-".split(""),dateType="date",numberType="number",stringType="string",validFormulaFunctions={ABS:{output:"Math.abs",defaultState:"ABS(number)",t:numberType},AMPM:{output:"skuid.time.getPeriod",defaultState:"AMPM(datetime)",t:dateType},CEIL:{output:"Math.ceil",defaultState:"CEIL(val)",t:dateType},TODAY:{output:"(function(){var d = new Date();d.setHours(0,0,0,0);return d;})",t:dateType,defaultState:"TODAY()",args:0},DAY:{output:"skuid.time.getDay",defaultState:"DAY(date)",t:dateType},DAY_NAME:{output:"skuid.time.getDayName",defaultState:"DAY_NAME(date)",t:dateType},DAY_NAME_SHORT:{output:"skuid.time.getDayNameShort",defaultState:"DAY_NAME_SHORT(date)",t:dateType},DAY_OF_WEEK:{output:"skuid.time.getDayOfWeek",defaultState:"DAY_OF_WEEK(date)",t:dateType},DAY_OF_WEEK_UTC:{output:"skuid.time.getUTCDayOfWeek",defaultState:"DAY_OF_WEEK_UTC(date)",t:dateType},FLOOR:{output:"Math.floor",defaultState:"FLOOR(val)",t:numberType},FORMAT_DATE:{output:"skuid.time.formatDate",defaultState:"FORMAT_DATE(format,date)",t:dateType,args:2},FORMAT_TIME:{output:"skuid.time.formatTime",defaultState:"FORMAT_TIME(format,datetime)",t:dateType,args:2},HOUR:{output:"skuid.time.getHour",defaultState:"HOUR(datetime)",t:dateType},HOUR_UTC:{output:"skuid.time.getUTCHour",defaultState:"HOUR_UTC(datetime)",t:dateType},IF:{output:"skuid.utils.ifElse",defaultState:"IF(logic_test,value_if_true,value_if_false)",t:"boolean",args:3},MILLISECOND:{output:"skuid.time.getMillisecond",defaultState:"MILLISECOND(datetime)",t:dateType},MINUTE:{output:"skuid.time.getMinute",defaultState:"MINUTE(datetime)",t:dateType},MINUTE_UTC:{output:"skuid.time.getUTCMinute",defaultState:"MINUTE_UTC(datetime)",t:dateType},MODEL_LOOKUP:{output:"skuid.utils.modelLookup",defaultState:"MODEL_LOOKUP(Lookup_Model_Id,Model_Field_To_Return,Model_Field_To_Search,Search_Value)",args:4},MONTH:{output:"skuid.time.getMonth",defaultState:"MONTH(date)",t:dateType},MONTH_UTC:{output:"skuid.time.getUTCMonth",defaultState:"MONTH_UTC(date)",t:dateType},MONTH_NAME:{output:"skuid.time.getMonthName",defaultState:"MONTH_NAME(date)",t:dateType},MONTH_NAME_SHORT:{output:"skuid.time.getMonthNameShort",defaultState:"MONTH_NAME_SHORT(date)",t:dateType},NOW:{output:"new Date",t:dateType,defaultState:"NOW()",args:0},ROUND:{output:"Math.round",defaultState:"ROUND(val)",t:numberType},SECOND:{output:"skuid.time.getSecond",defaultState:"SECOND(datetime)",t:dateType},SECOND_UTC:{output:"skuid.time.getUTCSecond",defaultState:"SECOND_UTC(datetime)",t:dateType},VALUE:{output:"parseFloat",defaultState:"VALUE(text)",t:stringType},YEAR:{output:"skuid.time.getYear",defaultState:"YEAR(date)",t:dateType},YEAR_UTC:{output:"skuid.time.getUTCYear",defaultState:"YEAR_UTC(date)",t:dateType}};SelectItem.prototype.id=function(){return this._GUID},SelectList.prototype={getItems:function(){return this.items},addItem:function(a,b){var c,d=this,e=d.items;if(!a._GUID)throw"Invalid SelectItem.";if(-1!==inArray(a,e))throw"Item is already in the List.";a.isSelected&&d.selectedIndex!==!1&&(e[d.selectedIndex].isSelected=!1),b?e.unshift(a):e.push(a),c=b?0:e.length-1,a.isSelected?(d.selectedIndex=c,d.selectedKey=a.value):b&&d.selectedIndex!==!1&&d.selectedIndex++,d.itemsMap[a.value]=a,d.selectedIndex===!1&&(d.selectedIndex=c,d.selectedKey=a.value,a.isSelected=!0)},getSelected:function(){return this.selectedIndex===!1?null:this.items[this.selectedIndex]},addItems:function(a,b){var c=this;a&&$.each(a,function(){c.addItem(this,b)})},size:function(){return this.items?this.items.length:0},removeItemAtIndex:function(a){this._validateIndex(a);var b=this.items[a],c=b.isSelected;b&&(b.value&&b.value in this.itemsMap&&delete this.itemsMap[b.value],this.items.splice(a,1),b.isSelected=!1),c!==!1&&(this.selectedIndex=!1,this.selectedKey=!1,this.size()>0&&this.selectItemAtIndex(0))},getItemAtIndex:function(a){return this.items[a]},getItemById:function(a){return $.grep(this.items,function(){return this.id()===a})},selectItemAtIndex:function(a){if(this._validateIndex(a),this.selectedIndex!==!1){if(a===this.selectedIndex)return!0;this.items[this.selectedIndex].isSelected=!1}this.items[a].isSelected=!0,this.selectedIndex=a,this.selectedKey=this.items[a].value},unselectItemAtIndex:function(a){this._validateIndex(a),a===this.selectedIndex&&(this.items[a].isSelected=!1,this.selectedIndex=!1,this.selectedKey=!1)},_getItemIndex:function(a){var b;if(b=isNumber(a)?a:this.indexOf(a),-1!==b)return b;throw"Invalid Item"},selectItem:function(a){this.selectItemAtIndex(this._getItemIndex(a))},unselectItem:function(a){this.unselectItemAtIndex(this._getItemIndex(a))},removeItem:function(a){this.removeItemAtIndex(this._getItemIndex(a))},indexOf:function(a){return!(a instanceof SelectItem)&&a.value&&a.value in this.itemsMap&&(a=this.itemsMap[a.value]),a?inArray(a,this.items):-1},contains:function(a){return-1!==this.indexOf(a)},_validateIndex:function(a){if(a>=this.size()||0>a)throw"Invalid Index";return!0}},KeyValueService.prototype={_createKey:function(a){if(a&&a.id)switch(a.type){case"component":return"skuid.component("+a.id+")";case"model":return"skuid.model("+a.id+")";default:return"string"==typeof a.type?a.type+"("+a.id+")":a.id}},getSettings:function(){var a=this.key,b=this._get();return a&&b&&a in b?$.extend(!0,{},b[a]):{}},updateSettings:function(a,b){var c=this.key,d=this._get(),e=$.extend(!0,{},d[c],a);if(b&&b.removeNulls===!0){var f=200,g=0,h=function(a){var b,c;if(!(g>f)){c=[];for(b in a)c.push(b);$.each(c,function(b,c){"undefined"==typeof a[c]||null===a[c]?delete a[c]:"object"==typeof a[c]&&(g++,h(a[c]),g--)})}};h(e)}d[c]=e,this._set(d)}},TemplateComponent.prototype={unregister:function(){this.editor&&this.model&&this.editor.unregister()},render:function(){var a,b=this,c=b.model,d=b.options||{},e=d.templateBody||"",f=d.context,g=b.conditions,h={allowHTML:d.allowHTML,registerFields:!1};b.editor.contents.empty(),c?(a=g&&g.length?filterRowsByConditions(c.data,g,f):f&&c&&f.model&&f.row&&f.model===c?[f.row]:filterRowsByConditions(c.data,null,f),!d.isMultiRow&&a&&a.length?(a&&a.length>1&&d.onlyShowFirstRow===!0&&(a=[a[0]]),$.each(a,function(a,d){d&&b.editor.contents.append(c.mergeRow(d,e,h))})):b.editor.contents.append(c.mergeModel(e,h))):b.editor.contents.append(merge(MERGE_GLOBAL,e,h))}},FileUploader.prototype={setSource:function(a,b,c){this.dragAndDrop||this.iframe.attr("src",(skuid.page.runningOnForceSite?skuid.page.currentSiteUrl:"/")+"apex/UploadImage?id="+a+(c?"&objfield="+c:"")+"&elid="+b)},pickFile:function(){this.dragAndDrop?this.iframe.click():this.iframe.contents().find("input[type=file]").click()},startProgress:function(){this.fileComponent.progressParentDiv&&this.fileComponent.progressParentDiv.append(this.progressDiv)},handleProgress:function(a){if(this.fileComponent.progressParentDiv){var b=Math.round(a.loaded/a.total*100);100>b&&this.progressDiv.css("width",b+"%")}},endProgress:function(){var a=this;this.fileComponent.progressParentDiv&&(this.progressDiv.css("width","100%"),setTimeout(function(){a.progressDiv.detach()},1e3))},remotingUpload:function(a,b){var c=new FileReader,d=this.options,e=b.elem;c.readAsDataURL(a),c.onload=function(a){return function(c){var f,g,h,i=c.target.result,j=[],k={},l={},m={};i=i.substring(i.indexOf(",")+1),k.id="imageAttachmentUpload",k.changes={},k.type="Attachment",l.id="imageImageInsert",l.changes={},l.type="skuid__Image__c",m.id="updateObject",m.changes={},m.type=b.model.objectName,g=d.description?mergeAsTextInContext(d.description,{row:b.row,model:b.model},{createFields:!1}):"",h=d.filename?mergeAsTextInContext(d.filename,{row:b.row,model:b.model},{createFields:!1}):a.name,"field"===d.storeAs?b.attId&&b.imageId?(k.changes[b.attId]={Body:i,Name:h,ContentType:a.type,Description:g},j.push(k),f="AttachmentUpdate"):b.imageId?(k.changes[1]={ParentId:b.imageId,Body:i,Name:h,ContentType:a.type,Description:g},j.push(k),f="CreateAttachment"):(l.changes[1]={},k.changes[2]={ParentId:"1",Body:i,Name:h,ContentType:a.type,Description:g},m.changes[b.row.Id]={},m.changes[b.row.Id][b.objField]="1",j.push(l),j.push(k),j.push(m),f="CreateFileAndAttachment"):"record"===d.storeAs&&(k.changes[1]={ParentId:b.row.Id,Body:i,Name:h,ContentType:a.type,Description:g},j.push(k),f="CreateAttachment"),e.trigger("imageuploadstarted",{fileName:h}),skuid.remote().save(JSON.stringify({operations:j,rollbackOnAnyError:!0}),function(a,c){if(c.status){var d,g,i,j=new Date;b.cacheBuster=j.getTime(),"AttachmentUpdate"===f?a.updateResults&&a.updateResults.length&&a.updateResults[0].success?(d=a.updateResults[0].id,g=b.imageId):i="Failure Updating Attachment":"CreateAttachment"===f?a.insertResults&&a.insertResults.length&&a.insertResults[0].success?(d=a.insertResults[0].id,g=b.imageId):i="Failure Creating Attachment":"CreateFileAndAttachment"===f&&(a.insertResults&&2===a.insertResults.length&&a.updateResults&&1===a.updateResults.length?a.insertResults[0].success&&a.insertResults[1].success&&a.updateResults[0].success?(d=a.insertResults[1].id,g=a.insertResults[0].id):i="Failure Creating File and Attachment (1)":i="Failure Creating File and Attachment (2)"),b.attName=h,e.trigger("imageuploadcomplete",{newAttachmentId:d,newImageId:g,message:i})}else e.trigger("imageuploadcomplete",{message:c.message})})}}(a)},restUpload:function(a,b){var c=this.options,d=b.elem,e=this,f=c.description?mergeAsTextInContext(c.description,{row:b.row,model:b.model},{createFields:!1}):"",g=c.filename?mergeAsTextInContext(c.filename,{row:b.row,model:b.model},{createFields:!1}):a.name,h=c.feedtext?mergeAsTextInContext(c.feedtext,{row:b.row,model:b.model},{createFields:!1}):"";if(d.trigger("imageuploadstarted",{fileName:a.name}),skuid.isAura)return d.trigger("imageuploadcomplete",{message:"Cannot upload large files in Lightning"}),!1;if("record"===c.storeAs)e.startProgress(),uploadBlob("/v33.0/sobjects/Attachment",{ParentId:b.row.Id,Name:a.name,ContentType:a.type,Description:f},"Body",a,g).then(function(c){var f=JSON.parse(c.response).id;e.endProgress(),b.attName=a.name,d.trigger("imageuploadcomplete",{newAttachmentId:f})},function(a){var b,c="Could not upload file";if(a&&a.response)try{b=JSON.parse(a.response),b&&b.message&&isString(b.message)&&(c+=": "+b.message)}catch(f){}e.endProgress(),d.trigger("imageuploadcomplete",{message:c})},function(a){e.handleProgress(a)});else if("field"===c.storeAs){var i="/v33.0/sobjects/Attachment";e.startProgress();var j=function(){var c=$.Deferred();if(b.imageId)c.resolve(b.imageId);else{var d=[],e={id:"imageImageInsert",changes:{1:{}},type:"skuid__Image__c"},f={id:"updateObject",changes:{},type:b.model.objectName};f.changes[b.row.Id]={},f.changes[b.row.Id][b.objField]="1",d.push(e,f),skuid.remote().save(JSON.stringify({operations:d,rollbackOnAnyError:!0}),function(d,e){var f,g="";e.status?(d.globalErrors&&d.globalErrors.length?g+=d.globalErrors.join(", "):d.insertResults&&1===d.insertResults.length&&d.updateResults&&1===d.updateResults.length?d.insertResults[0].success&&d.updateResults[0].success?f=d.insertResults[0].id:($.each(d.insertResults[0].errors,function(){g+=this.message}),$.each(d.updateResults[0].errors,function(){g+=this.message})):g+="Error Uploading File",b.attName=a.name,f?c.resolve(f):c.reject(g)):c.reject(e.message)})}return c.promise()};j().then(function(c){b.attId&&c&&(i+="/"+b.attId+"?_HttpMethod=PATCH");var h={Name:g,ContentType:a.type,Description:f};!b.attId&&c&&(h.ParentId=c),uploadBlob(i,h,"Body",a,g).then(function(f){var g,h;b.attId?(h=new Date,b.cacheBuster=h.getTime(),g=b.attId):g=JSON.parse(f.response).id,e.endProgress(),b.attName=a.name,d.trigger("imageuploadcomplete",{newAttachmentId:g,newImageId:c})},function(a){var b,c="Could not upload file";if(a&&a.response)try{b=JSON.parse(a.response),b=b[0],b=b.message}catch(f){b&&isString(b)&&(c+=": "+b)}e.endProgress(),d.trigger("imageuploadcomplete",{message:c})},function(a){e.handleProgress(a)})},function(a){var b="Could not upload file";a&&isString(a)&&(b=a),e.endProgress(),d.trigger("imageuploadcomplete",{message:b})})}else if("chatterfeed"===c.storeAs){e.startProgress();var k=skuid.page?skuid.page.community:null,l=k?k.id:null;uploadBlob("/v33.0"+(l?"/connect/communities/"+l:"")+"/chatter/feed-elements",{body:{messageSegments:[{type:"Text",text:h}]},capabilities:{content:{description:f,title:a.name}},feedElementType:"FeedItem",subjectId:b.row.Id},"feedElementFileUpload",a,g).then(function(){if(e.endProgress(),d.trigger("imageuploadcomplete"),window.chatter){var a=chatter.getFeed(),b=a.getConfig();a.refresh({feedType:b.feedType,isFullRefresh:!0,params:b})}},function(a){var b="Could not upload file";a&&a.response&&(b=JSON.parse(a.response)[0].message),e.endProgress(),d.trigger("imageuploadcomplete",{message:b})},function(a){e.handleProgress(a)})}else"chatterfiles"===c.storeAs?(e.startProgress(),uploadBlob("/v33.0/sobjects/ContentVersion",{Origin:"H",PathOnClient:g,Description:f},"VersionData",a,g).then(function(){e.endProgress(),d.trigger("imageuploadcomplete")},function(a){e.endProgress();var b="Could not upload file";a&&a.response&&(b=JSON.parse(a.response)[0].message),d.trigger("imageuploadcomplete",{message:b})},function(a){e.handleProgress(a)})):"contentdocument"===c.storeAs&&(e.startProgress(),uploadBlob("/v33.0/sobjects/ContentVersion",{Origin:"C",PathOnClient:g,Description:f},"VersionData",a,g).then(function(){e.endProgress(),d.trigger("imageuploadcomplete")},function(a){var b="Could not upload file";a&&a.response&&(b=JSON.parse(a.response)[0].message),e.endProgress(),d.trigger("imageuploadcomplete",{message:b})},function(a){e.handleProgress(a)
}))},fileAPIUpload:function(a,b){var c=new FileReader,d=b.elem;d.trigger("imageuploadstarted",{fileName:a.name}),a&&c.readAsDataURL(a),c.onloadend=function(){var b=c.result.split(",")[1],e=a.name.split("."),f="";e.length>1&&(f=e.pop().toUpperCase());var g=e.join("")+f,h=g.match(/[a-z]|[A-Z]|[0-9]/g);g=h?h.join(""):"unnamedResource";var i={Name:g,ContentType:"application/"+f,Body:b,CacheControl:"Public"};$.ajax({type:"POST",url:"/services/data/v32.0/sobjects/StaticResource",headers:{"Content-Type":"application/json",Authorization:"Bearer "+getUserInfo().sessionId},data:JSON.stringify(i),dataType:"json",success:function(a){d.trigger("imageuploadcomplete",{record:$.extend(i,a)})},error:function(){var a=$.Deferred(),b="SELECT Id FROM StaticResource WHERE Name='"+g+"'";skuid.sfdc.api.query(b).success(function(b){if(b.records&&b.records[0]){var c=window.confirm('Static Resource "'+g+'" already exists, do you want to overwrite it?');if(c){i.Id=b.records[0].Id;var e=new skuid.sfdc.api.SObject("StaticResource",i);$.when(e.update()).done(function(){d.trigger("imageuploadcomplete",{record:i})}).fail(a.reject)}else a.reject()}else a.reject()}).fail(a.reject),a.done(function(){d.trigger("imageuploadcomplete",{record:i})}).fail(function(){d.trigger("imageuploadcomplete",{message:"Upload Failed"})})}})}},attach:function(a){var b,c,d,e,f=this,g=a.elem,h=f.options;f.iframe.appendTo(g),f.element=g,f.fileComponent=a,f.dragAndDrop&&(c=$(document.body),d=$("<div>").addClass("nx-file-droppable").text(a.buttonText),e=function(b){b.preventDefault();var c=b.originalEvent.dataTransfer?b.originalEvent.dataTransfer.files:b.target.files;if(!c||!c.length)return!1;var d=c[0];("field"===h.storeAs||"record"===h.storeAs)&&d.size<65e4?f.remotingUpload(d,a):"staticresource"===h.storeAs?f.fileAPIUpload(d,a):f.restUpload(d,a)},f.iframe.on("click",function(a){this.value=null,a.stopPropagation()}).on("change",e),g.on("dragover",function(a){a.stopPropagation(),a.preventDefault(),a.originalEvent.dataTransfer.dropEffect="copy"}).on("dragenter",function(){d.addClass("nx-file-dropping")}).on("dragleave",function(){d.removeClass("nx-file-dropping")}).on("drop",e),c.on("dragenter."+h._GUID,function(a){a.preventDefault(),b=a.target,g.append(d)}).on("dragover."+h._GUID,function(a){a.preventDefault()}).on("dragleave."+h._GUID,function(a){b===a.target&&(d.detach(),d.removeClass("nx-file-dropping"))}).on("drop."+h._GUID,function(a){return a.preventDefault(),a.stopPropagation(),d.detach(),d.removeClass("nx-file-dropping"),b=null,!1}))},unregister:function(a){var b=a.options._GUID;$(document.body).off("dragenter."+b+" dragleave."+b+" drop."+b)}},FileComponent.prototype={draw:function(){var a=this,b=getUrlFromAttachmentId(a.attId+(a.cacheBuster?"&cachebuster="+a.cacheBuster:""));"filename"===a.options.displayAs||"record"===a.options.storeAs?a.attId&&a.attName&&a.objField?(a.setStatus(a.attName),a.status.off("click.skuid").on("click.skuid",function(){window.open(b,"ViewFile")}),a.options.deleteable&&a.deletebutton&&a.deletebutton.show()):(a.deletebutton&&a.deletebutton.hide(),a.status.hide()):"image"===a.options.displayAs&&(a.attId?a.image.attr("src",b):a.image.attr("src",a.defaultImageSrc),a.status&&a.status.hide())},setStatus:function(a){var b,c,d,e=this,f=e.status,g=e.statustext;a&&(isString(a)?b=a:(b=a.text,c=a.hideIn,d=a.complete)),f&&g&&(e.statusTimeout&&clearTimeout(e.statusTimeout),skuid.ui.setStatus(f,g,b),c>=0&&(e.statusTimeout=setTimeout(function(){f.animate({opacity:0},{duration:2e3,complete:d||function(){f.hide()}})},1e3*c)))},deleteImage:function(){var a=this,b={id:"objdelete",changes:{},type:a.model.objectName},c={id:"imagedelete",changes:{},type:"skuid__Image__c"},d=a.row.Id;b.changes[d]={},b.changes[d][a.objField]="",c.changes[a.imageId]={__deleted:"true"},a.setStatus($L("deleting")),skuid.remote().save(JSON.stringify({operations:[b,c]}),function(b,c){if(c.status){var d=a.attId;a.attId=null,a.attName=null,a.imageId=null,a.elem.trigger("imagedeletecomplete",{oldAttId:d}),a.syncModel(),a.draw()}else a.setStatus({text:c.message,hideIn:2,complete:function(){a.draw()}})})},recomputeId:function(){var a=this,b={id:"imagerecompute",changes:{},type:"skuid__Image__c"};b.changes[a.imageId]={skuid__NeedsRecompute__c:"Initiate"},skuid.remote().save(JSON.stringify({operations:[b]}),function(){a.model.updateData(function(){a=new FileComponent(a.elem,a.options)})})},unregister:function(){this.elem&&this.elem.remove&&this.elem.remove(),this.uploader&&this.uploader.unregister(this)},syncModel:function(){var a=this,b={},c=a.row,d={};if(b[c.Id]=d,a.objField){if((a.imageId!==c[a.objField]||a.attId!==a.model.getFieldValue(c,a.lookupFieldName+".skuid__AttachmentId__c",!0))&&(d[a.objField]=a.imageId),a.imageId){var e=c[a.lookupFieldName]||{};$.extend(e,{skuid__AttachmentId__c:a.attId,Name:a.attName}),d[a.lookupFieldName]=e,$.extend(c,d)}else delete c[a.objField],delete c[a.lookupFieldName];size(d)&&a.model.notifyFieldsOfChange(b,{initiatorId:a})}}},$.extend(utils,{addResizeHandler:addResizeHandler,adjustValueBasedOnQuotedness:adjustValueBasedOnQuotedness,applyFormulaFunctions:applyFormulaFunctions,areConditionsMet:areConditionsMet,calculateReferenceMerges:calculateReferenceMerges,calculateReferenceText:calculateReferenceText,canUseSessionStorage:canUseSessionStorage,capitalizeFirst:capitalizeFirst,combineUrls:combineUrls,computeImageUrl:computeImageUrl,conditionallyDo:conditionallyDo,conditionallyRender:conditionallyRender,contains:contains,convertCurrency:convertCurrency,createMapForArray:createMapForArray,createPopupFromPopupXML:createPopupFromPopupXML,createPopupFromAction:createPopupFromAction,createSearchSubConditions:createSearchSubConditions,decodeHTML:decodeHTML,decodeXML:decodeXML,delayEventCallback:delayEventCallback,delayInputCallback:delayInputCallback,doArraysIntersect:doArraysIntersect,doesRowMeetConditions:doesRowMeetConditions,encodeHTML:encodeHTML,endsWith:endsWith,escapeCSVCell:escapeCSVCell,escapeSelector:escapeSelector,escapeSingleQuotes:escapeSingleQuotes,evaluateFormula:evaluateFormula,extractFieldsFromTemplate:extractFieldsFromTemplate,filterRowsByConditions:filterRowsByConditions,generateGUID:generateGUID,generateUniqueId:generateUniqueId,getAPIDescribeSObject:getAPIDescribeSObject,getAPIDescribeLayout:getAPIDescribeLayout,getBodiesOfZIPResourceFiles:getBodiesOfZIPResourceFiles,getBodyOfZIPResourceFile:getBodyOfZIPResourceFile,getCacheTimestamp:getCacheTimestamp,getCSSSizeObj:getCSSSizeObj,getContextToUse:getContextToUse,getDefaultImageUrl:getDefaultImageUrl,getDisplayTypeOfEntity:getDisplayTypeOfEntity,getFieldReference:getFieldReference,getFieldRelationshipName:getFieldRelationshipName,getHourOptions:getHourOptions,getJSONBodiesOfZIPResourceFiles:getJSONBodiesOfZIPResourceFiles,getJSONBodyOfZIPResourceFile:getJSONBodyOfZIPResourceFile,getMergeApi:getMergeApi,getMergeResult:getMergeResult,getMetadataForRecordTypes:getMetadataForRecordTypes,getNameField:getNameField,getObjectProperty:getObjectProperty,getPicklistEntriesValidForRecordTypes:getPicklistEntriesValidForRecordTypes,getReferenceFieldNameFromRelationshipField:getReferenceFieldNameFromRelationshipField,getReferenceFieldRelationshipName:getReferenceFieldRelationshipName,getRowCurrency:getRowCurrency,getSafeRelativeUrl:getSafeRelativeUrl,getSearchOperatorForDisplayType:getSearchOperatorForDisplayType,getTargetObject:getTargetObject,getUrlFromAttachmentId:getUrlFromAttachmentId,getUserInfoPropValue:getUserInfoPropValue,getXML:getXML,hasObjectProperty:hasObjectProperty,highlightSFTab:highlightSFTab,ifElse:ifElse,insertAtIndex:insertAtIndex,isApiEnabled:isApiEnabled,isMultiValueOperator:isMultiValueOperator,isNumber:isNumber,isPromise:isPromise,isString:isString,isDate:isDate,layoutFields:layoutFields,loadJS:loadJS,loadRichTextApi:loadRichTextApi,loadCSS:loadCSS,makeConditionLogicString:makeConditionLogicString,makeXMLDoc:makeXMLDoc,merge:merge,mergeAsDataInContext:mergeAsDataInContext,mergeAsTextInContext:mergeAsTextInContext,mergeAsText:mergeAsText,mergeInContext:mergeInContext,mergeNodeProperty:mergeNodeProperty,niceExpand:niceExpand,nl2br:nl2br,outerHTML:outerHTML,processStylesNode:processStylesNode,redirect:redirect,registerBlurHandler:registerBlurHandler,registerPlugin:registerPlugin,removeEventSubscriptions:removeEventSubscriptions,removeScriptTags:removeScriptTags,scrollTo:scrollTo,sessionStorage:sessionStorage,setObjectProperty:setObjectProperty,size:size,startsWith:startsWith,toArray:toArray,toClass:toClass,validFormulaFunctions:validFormulaFunctions,modelLookup:modelLookup,writeXmlToPageLayoutFields:writeXmlToPageLayoutFields,_ie:_ie,_setAttachmentBaseUrl:_setAttachmentBaseUrl,FileUploader:FileUploader,FileComponent:FileComponent,KeyValueService:KeyValueService,SelectList:SelectList,SelectItem:SelectItem,TemplateComponent:TemplateComponent})}(window.skuid),function(a){function b(a){return a&&a.fields&&a.fields.length&&f.each(a.fields,function(a,b){var c,d,e,g=b.referenceTo;"REFERENCE"===b.displaytype&&g&&g.length&&!b.ref&&(b.relationshipName=b.rel,c=[],d=[],e={c:"createable",o:"objectName",l:"label",k:"keyPrefix",p:"labelPlural",s:"searchable"},f.each(g,function(a,b){b.o&&(c.push(b.o),d.push(b.k),f.each(e,function(a,c){b[c]=b[a],delete b[a]}),b.accessible=!0)}),c.length&&(b.ref=c.join(",")),d.length&&(b.refprefix=d.join(",")))}),a}function c(a){return e.adapters[a]}function d(){return h}var e=a.adapter={},f=a.$,g=a.utils,h={},i=function(a){f.extend(this,a);var b=this.name;if(!b)throw"Adapter name is required.";if(b in h)throw'Adapter "'+b+'" has already been defined.';h[b]=this},j={name:"salesforce",_newId:1,_nameFieldsByObject:{Case:"CaseNumber",ContentDocument:"Title",ContentVersion:"Title",FeedItem:"Title",Idea:"Title",Solution:"SolutionName",Task:"Subject",Event:"Subject",PartnerNetworkConnection:"ConnectionName",CustomPermission:"MasterLabel"},_objectsWithoutNameFields:{CampaignMember:1,AccountContactRole:1,OpportunityContactRole:1,ContractContactRole:1,CaseContactRole:1,CaseComment:1,CaseSolution:1,OpportunityLineItem:1},prefillMetadataForObject:function(a){b(a.data)},getNameField:function(a){var b;return a&&(b=g.isString(a)?a:a.objectName),b&&b in j._nameFieldsByObject?j._nameFieldsByObject[b]:b in j._objectsWithoutNameFields||b&&g.endsWith(b,"__x")?"Id":"Name"},save:function(b){var c=f.Deferred(),d={"[object Object]":1,"[object Array]":1};return f.each(b.operations,function(a,b){f.each(b.changes,function(a,b){f.each(b,function(a,c){(g.endsWith(a,"__r")||g.endsWith(a,"__pr")||g.toClass.call(c)in d)&&delete b[a]})})}),a.remote().save(JSON.stringify(b),function(a,b){b.status?c.resolve(a):c.reject(b.message)},{escape:!1}),c.promise()},load:function(b){var c=f.Deferred(),d=["registeredConditions","registeredEditors","registeredFields","registeredFieldsByRowThenField","registeredItems","registeredItemsByRow","registeredLists","originals","data","dataMap","changes","fieldsMap","debug","soql","recordTypeInfos","actions","service"],e=f.map(b,function(a){var b={};for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return f.each(d,function(){this in b&&delete b[this]}),b});return a.remote().load(JSON.stringify(e),function(a,b){b.status?(a=JSON.parse(a),c.resolve(a)):c.reject(b.message)},{escape:!1}),c.promise()},isNewId:function(a){return!(g.isString(a)&&(15===a.length||18===a.length))},getNewId:function(){return""+j._newId++},getObjectList:function(){var b=f.Deferred(),c=a.utils.sObjectList;return c?b.resolve(c):b.reject(),b.promise()},buildEntityMetadataRequest:function(a){var b=a.targetEntity;return!b&&a.model&&a.model.attr&&(b=a.model.attr("sobject")),{objectName:b}},getEntityMetadataLoadingMessageFromBreadcrumb:function(a){return"Loading metadata for object "+a.endsobject+"..."},getEntityMetadataCacheKey:function(a){return a.objectName},getEntityMetadata:function(c){var d=f.Deferred(),e=c.entities,h=c.ignoreMetadataOverrides?"true":"false",i=[];return e?f.each(e,function(c,d){var e=f.Deferred(),j=g.isString(d)?d:d.objectName;i.push(e.promise()),a.remote().getModelMetadata(JSON.stringify({sObjectName:j,loadChildRelationships:"true",loadPicklistValues:"false",ignoreMetadataOverrides:h}),function(a,c){if(c.status){var d=JSON.parse(a);d?d instanceof Array&&d.length?e.resolve(f.map(d,function(a){return b(a),a})):(b(d),e.resolve(d)):e.resolve(d)}else e.reject("There was an error retrieving metadata for object: "+j+": "+c.message)},{escape:!1})}):d.reject("No SObject provided."),f.when.all(i).then(function(a){d.resolve(a)},function(){d.reject("Unable to retrieve metadata for all requested objects.")}),d.promise()},initialize:b,properties:{composer:{supports:{childRelationships:!0},canFieldsBeSelected:function(a){return a.breadcrumb.endsobject?!0:"Select an SObject for this Model"}},canAutoGenerateConditionsFromFields:!0,validConditionTypes:["fieldvalue","multiple","param","userinfo","blank","modelmerge","join"],canConditionsBeGrouped:!0}};i.prototype.prop=function(a){return this.properties?g.getObjectProperty(this.properties,a):null},e.Adapter=i,e.adapters=h,e.getAll=e.map=d,e.getAdapter=e.get=c,new i(j)}(skuid),function(a){var b=a.service={},c={},d=a.utils,e=a.$,f="salesforce",g=d.isString,h=d.mergeAsTextInContext,i=d.contains,j={},k=function(){return window.location.origin+(a.isAura?"/skuid/oauthcallback.app":"/apex/skuid__oauthcallback")},l=function(a,b){var c=a.authMethod,e=a.providerName;if(!c)return a.url;if(d.startsWith(c,"oauth")){var f=a.providerType;return f?("other"!==f?f:e)+(b?"::"+b:""):e}return"apex"===c?e:void 0},m=function(b){var d=b.name,g=b.adapterName;if(e.extend(this,b),this.adapter=a.adapter.getAdapter(g||f),this.entityMetadataCache={},d in c)throw'Service"'+d+'" has already been defined.';c[d]=this},n=function(a){return a&&0!==a.length?a.length>1?a:1===a.length?a[0]:void 0:null};m.prototype={save:function(a){return this.adapter.save(a,{service:this})},load:function(a){return this.adapter.load(a,{service:this})},isNewId:function(a){return this.adapter.isNewId(a)},getNewId:function(){return this.adapter.getNewId()},getNameField:function(a){return this.adapter.getNameField({objectName:a,service:this})},getAdapter:function(){return this.adapter},getObjectList:function(){return this.adapter.getObjectList({service:this})},buildEntityMetadataRequest:function(a){var b=this.adapter.buildEntityMetadataRequest(a);return b.service=this,b},getEntityMetadataLoadingMessageFromBreadcrumb:function(a){var b=this.adapter.getEntityMetadataLoadingMessageFromBreadcrumb(a);return b.service=this,b},prefillMetadataForObject:function(a,b){b._isPreload=!0;var c=this.adapter.prefillMetadataForObject;c&&c({object:a,data:b,service:this}),d.createMapForArray([b],"fields","fieldsMap",["id","name"]),this.cacheEntityMetadata(this.getEntityMetadataCacheKey(a),b)},populateBreadcrumbFromEntityMetadata:function(a){var b=this,c=b.getAdapter(),d=c.populateBreadcrumbFromEntityMetadata;return d?(a.service=b,d(a)):a.crumb},getEntityMetadataCacheKey:function(a){var b=this;return d.isString(a)?a:b.adapter.getEntityMetadataCacheKey?(a.service||(a.service=b),b.adapter.getEntityMetadataCacheKey(a)):void 0},cacheEntityMetadata:function(a,b){this.entityMetadataCache[a]=b},getCachedEntityMetadata:function(b){var c,d,f,g=this,h=g.entityMetadataCache;return b?(c=b.entities?b.entities:a.utils.isString(b)?[{objectName:b}]:[b],e.isArray(c)||(c=[c]),d=e.map(c,function(a){var b=g.getEntityMetadataCacheKey(a),c=h[b];return c}),f=g.processEntityMetadataRequests({entities:c,results:d}),n(f)):h},createHTTPRequest:function(a){a||(a={});var b,c,f=this,j=f.authentication,k=e.extend({},f.requestHeaders,a.headers),l={},m=e.extend({model:a.model},a.apiExtensions,a.context),n=i(p,"?"),o=f.requestBodyParameters,p=a.url,q=a.contentType,r=a.body;return j&&j.success&&(m.$Auth={Response:{Body:j.responseBody,Headers:j.responseHeaders}}),f.requestUrlParameters&&e.each(f.requestUrlParameters,function(a,b){a&&b&&(n?p+="&":(p+="?",n=!0),p+=a+"="+encodeURIComponent(h(b,m,{createFields:!1})))}),p=h(p,m,{createFields:!1}),e.each(k,function(a,b){var c=b&&g(b)?h(b,m,{createFields:!1}):b;l[a]=c}),(o&&d.size(o)||r&&d.size(r))&&(q&&i(q,"json")&&!d.isString(r)?(c={},o&&e.extend(c,o),r&&e.extend(c,r)):c=r),b={url:p,headers:l,method:a.method,modelService:f.name},c&&(b.contentType=q,b.body=c),b.method||(b.method=c?"POST":"GET"),j&&j.success&&(b.isAuthenticated=!0),b},processEntityMetadataRequests:function(a){var b,c,d=this,e=a.entities,f=a.results,g=d.getAdapter().processEntityMetadataRequest;if(g){for(c=[],b=0;b<e.length;b++){var h=f[b];c.push(h?g({entity:e[b],result:h}):null)}return c}return f},getEntityMetadata:function(a){var b,c,f=this,g=e.Deferred(),h=a.entities,i=a.ignoreCache||!1,j=[],k=[];return h&&(e.isArray(h)||(h=[h]),e.each(h,function(a,c){c.service=f,b=null,i||(b=f.getCachedEntityMetadata(c)),b&&!b._isPreload?k.push(b):j.push(c)})),j.length?(c={entities:j,service:f,ignoreCache:i},f.adapter.getEntityMetadata(c).then(function(a){e.each(a,function(a,b){f.cacheEntityMetadata(f.getEntityMetadataCacheKey(j[a]),b)}),e.each(f.processEntityMetadataRequests({entities:j,results:a}),function(a,b){k.push(b),d.createMapForArray([b],"fields","fieldsMap",["id","name"])}),g.resolve(n(k))},function(a){g.reject(a)})):g.resolve(n(k)),g.promise()},getPendingAuthenticationRequest:function(){return j[l(this.authentication)]},isAuthenticated:function(){var a=this.authentication;return!a||a.success},authenticate:function(b,c){function f(a){a&&d.size(a)&&e.each(a,function(b,c){g(c)?e.each(y,function(d,e){i(c,d)&&(a[b]=c.replace(d,e))}):"object"==typeof c&&f(c)})}function h(a){var b;g(a)?b=a:a&&a.error&&(g(a.error)?b=a.error:a.error&&a.error.message&&(b=a.error.message)),D.reject(b||"Authentication Failed")}function m(){D.resolve(C)}var n,o,p,q,r,s,t,u,v,w,x,y,z,A,B=this,C=B.authentication,D=e.Deferred(),E=B.useApexProxy;if(C)if(o=C.method,p=C.verb||"POST",n=C.url,z=C.username,A=C.password,n&&d.startsWith(n,"/")&&B.serviceUrl&&(n=d.combineUrls(B.serviceUrl,n)),"oauth"===o&&C.success&&(w=C.responseHeaders.scope.split(","),x=c?c.scopes:b.scopes,x&&(x=x.split(",")),x&&x.length&&e.each(x,function(a,b){return-1===e.inArray(b,w)?(C.success=!1,!1):void 0})),C.success)m();else if("sharedunpw"===o){if(q={url:n,headers:C.requestHeaders,method:p,modelService:B.name},u=C.requestBody,s=l(C),t=j[s])return t;E||(r=q.headers,y={"{{$Auth.Username}}":z,"{{$Auth.Password}}":A},f(r),f(u)),u&&(q.contentType=C.requestBodyContentType||"application/x-www-form-urlencoded",q.body=JSON.stringify(u)),v=a.ajax[E?"proxy":"direct"](q,{buffer:!1}).done(function(a){C.responseHeaders=a.headers;try{C.responseBody=JSON.parse(a.body)}catch(b){C.responseBody=a.body}C.success=!0,m()}).fail(function(a){C.success=!1,h(a)}).always(function(){delete j[s]}),j[s]=v.promise()}else if("sharedbasicauth"===o)z&&A?(B.requestHeaders.Authorization="Basic "+btoa(z+":"+A),C.success=!0,m()):z?A||(C.success=!1,h({error:"No Password provided."})):(C.success=!1,h({error:"No Username provided."}));else if("oauth"===o){var F=function(a){return a&&a.refresh_token},G=function(){var f=C.providerType;"other"===f&&(f=C.providerName);var g={},i={force:!1},n=a.oauth(f),o=n?n.getAuthResponse():null,p=(C.defaultScopes||"").split(","),q=(B.scopes||"").split(","),r=(c&&c.scopes?c.scopes:b.scopes||"").split(","),u={};return e.each(p.concat(q,r),function(a,b){b&&!u[b]&&(u[b]=1)}),d.size(u)&&(i.scope=Object.keys(u).join(",")),E||(C.grantType="implicit"),"implicit"!==C.grantType&&(i.response_type="code"),!n.isSessionValid()&&F(o)&&(i.display="none"),s=l(C,i.scope||""),(t=j[s])?t.done(m).fail(h):(a.oauth.services[f]?g[f]=C.clientId:(g[f]={id:C.clientId,oauth:{version:"2.0",auth:C.url,grant:C.tokenUrl}},"code"===i.response_type&&(g[f].oauth.response_type="code")),a.oauth.init(g,{redirect_uri:k()}),v=a.oauth.login(f,i).then(function(a){C.responseHeaders=a.authResponse,C.success=!0,m(),delete j[s]},function(a){C.success=!1,h(a),delete j[s]}),void(j[s]=v))};a.oauth?G():d.loadJS("/resource/"+d.getCacheTimestamp()+"/skuid__OAuthClientJS"+(a.dev?"Max":"")).done(function(){a.oauth=window.hello,delete window.hello}).done(G)}else if("apex"===o){if(q={headers:C.requestHeaders,method:"GET",modelService:B.name},s=l(C),t=j[s])return t;v=a.ajax.proxy(q,{buffer:!1}).done(function(a){C.responseHeaders=a.headers;try{C.responseBody=JSON.parse(a.body)}catch(b){C.responseBody=a.body}C.success=!0,m()}).fail(function(a){C.success=!1,h(a)}).always(function(){delete j[s]}),j[s]=v.promise()}else m();else m();return D.promise()},invalidateAuthentication:function(){var b=this.authentication,c=b.providerType;if(b&&b.success&&(b.success=!1,b.responseHeaders=null,"oauth"===b.method)){var d=a.oauth("other"===c?b.providerName:c);d&&d.logout&&d.logout()}return this}},new m({name:f,adapterName:f}),b.getService=function(a){return c[a||f]},b.Service=m,b.map=function(){return c}}(skuid),function(a){function b(){return a.utils}function c(a){return b().isString(a)}function d(a){return b().size(a)}function e(b,d,e){var f=c(b)?b:b.id,g=!c(d),h=g?d.name:d;return e||(e=a.page.id),"apex__"+(g&&d.customCookie?d.customCookie:"nx-page-"+e+"-model-condition-"+f+"-"+h)}function f(a){return b().isMultiValueOperator(a)}function g(){return $||($=b().getXML(b().makeXMLDoc("<value/>")[0]).length),$}function h(b){var c=b.service;return c||(b.service=c=a.service.getService(b.serviceName||fb)),c}function i(a,b){return b?b+"("+a+")":a}function j(a,b,c,d,e){typeof c.attr(d)!==cb?a[b]=c.attr(d):typeof e!==cb&&(a[b]=e)}function k(a,c,d){return a&&(a=ab.trim(a).toUpperCase()),c&&c.length&&!a&&(a="",ab.each(c,function(b){a+=b+1+"AND"}),b().endsWith(a,"AND")&&(a=a.substring(0,a.length-3))),a&&!b().startsWith(a,"(")&&d&&(a="("+a+")"),a}function l(a){var c,d,e,f,g,i,j,l=a.model,m=a.xml,n=m.children("conditions"),o=m.children("havings"),p=m.children("actions");l.processOnClient="true"===m.attr("processonclient"),l.serviceName=m.attr("service")||fb,c=h(l),d=c.getAdapter(),e=d?d.name:fb,f=d?"local"===d.prop("runtime.metadataSource"):!1,ab.extend(l,{id:m.attr("id"),objectName:m.attr("sobject"),type:m.attr("type"),createRowIfNoneFound:"true"===(m.attr("createrowifnonefound")||"false"),preventUnloadIfUnsavedChanges:"false"!==m.attr("unloadwarningifunsavedchanges"),recordsLimit:m.attr("limit")||null,orderByClause:m.attr("orderby"),rTypeFor:m.attr("rtypfor"),doQuery:"false"!==m.attr("query"),doClone:"yes"===m.attr("doclone"),readonly:m.attr("readonly"),pathToContent:m.attr("pathtocontent"),fields:ab.map(m.children("fields").children(),function(a){return new U({model:l,xml:ab(a)})}),conditions:ab.map(n.children(),function(a){return new T(ab(a))}),havings:ab.map(o.children(),function(a){return new T(ab(a))}),methods:ab.map(m.children("methods").children(),function(a){return new V(ab(a))})}),e===fb&&(l.queryAllRows="true"===m.attr("queryallrows"),l.forView="true"===m.attr("forview")),p.length&&(l.actions=ab.map(p.children("action"),function(a){return new X(ab(a))})),l.serviceName===fb&&(l.needsMetadataLoad=!0),!l.pathToContent&&l.methods&&l.methods.length&&(g=l.methods.filter(function(a){return"query"===a.type&&a.pathToContent}),g.length&&(l.pathToContent=g[0].pathToContent)),i=m.attr("label"),j=m.attr("labelplural"),l.label||(l.label=i?b().mergeAsText("global",i):l.id),l.labelPlural||(l.labelPlural=j?b().mergeAsText("global",j):l.id),l.serviceUrl=m.attr("serviceurl")||m.attr("endpoint"),l.verb=m.attr("verb"),m.attr("scopes")&&(l.scopes=m.attr("scopes")),n.length&&(l.conditionLogic=k(n.attr("logic"),l.conditions)),o.length&&(l.havingLogic=k(o.attr("logic"),l.havings))}function m(a,c,d,e){var f=d.attr(e),g=!1;return f&&(g=b().escapeSingleQuotes(f),a[c]=g),g}function n(a){return-1!==ab.inArray(a.type,[db,eb])}function o(b,c){var d="DATE"===c,e="DATETIME"===c,f="BOOLEAN"===c,g=typeof b;if(d||e){if(d&&!a.time.parseSFDate(b)||e&&!a.time.parseSFDateTime(b)){var h=new Date;return"TODAY"===b||"NOW"===b||("YESTERDAY"===b?h.setTime(h.getTime()-864e5):"TOMORROW"===b?h.setTime(h.getTime()+864e5):h=!1),h?e?a.time.getSFDateTime(h):a.time.getSFDate(h):null}}else{if(f&&"boolean"!==g&&null!==b)return"true"===b.toLowerCase()||"number"===g&&0!==b?!0:!1;if(-1!==ab.inArray(c,["DOUBLE","CURRENCY","PERCENT"])&&"number"!==g&&null!==b&&"undefined"!==g)try{b=parseFloat(b)}catch(i){}else if("INTEGER"===c&&"number"!==g&&null!==b&&"undefined"!==g)try{b=parseInt(b,10)}catch(i){}}return b}function p(a,b){a&&b&&a._GUID&&!(a._GUID in b)&&(b[a._GUID]=a)}function q(a,b){a&&b&&a._GUID&&a._GUID in b&&delete b[a._GUID]}function r(a,c){var d,e="aggregate"===a.type,f=[],g=b().createMapForArray;return a.isAggregate=e,d=a.getAdapter(),d&&d.initialize&&d.initialize(a),a.fields&&ab.each(a.fields,function(a,b){n(b)===!0&&b.subFields&&f.push(b),b.uiOnly&&b.calculated&&(b.createable=b.editable=!1)}),f.length&&g(f,"subFields","subFieldsMap","id"),g([a],"fields","fieldsMap",["id","name"]),e?J(a):(y(a),A(a)),g([a],"data","dataMap","Id"),D(a),K(a),a.needsMetadataLoad||c&&c.createDefaultRowIfNeeded===!1||z(a),a.evaluateFormulaFields({preventTrackChanges:!0}),a.isInitialized=!0,a}function s(b){return a.adapter.adapters.salesforce.isNewId(b)}function t(){return a.adapter.adapters.salesforce.getNewId()}function u(a){var b;return b=c(a)?a:a.Id}function v(a,b){if(a=b._findRow(a)){var c=u(a);return!(!c||!c.length||-1===c.indexOf("clone_"))}return!1}function w(a,b){var c;return c=b instanceof W?b:new W(b),c.register(a),c}function x(a){var b;return b=c(a)?G(a):a,b?(b.unregister(),b):void 0}function y(a){var b=a;if(b.doClone&&b.realToFakeIdMap&&b.data&&b.data.length){var c={};b.conditions&&ab.each(b.conditions,function(a,d){var e=d.field,f=d.value,g=b.getField(e);if(g&&g.createable&&(-1!==e.indexOf(".")||!f&&f!==!1&&0!==f||ab.each(b.data,function(a,b){e in b||(b[e]=f)}),g.displaytype===bb&&"modelmerge"===d.type&&d.model)){var h=G(d.model);h&&h.realToFakeIdMap&&(c[e]=h)}}),b.dataMap||(b.dataMap={}),ab.each(b.data,function(a,c){var d,e=c.Id;e&&e in b.realToFakeIdMap&&(c.Id=d=b.realToFakeIdMap[c.Id],b.dataMap[d]=c,delete b.dataMap[e])}),b.fields&&ab.each(b.fields,function(a,d){if(d.displaytype===bb){var e=[];c[d.id]?e.push(c[d.id].realToFakeIdMap):ab.each(d.referenceTo,function(a,b){var c=ib[b.keyPrefix];c&&c.length&&ab.each(c,function(a,b){b.realToFakeIdMap&&e.push(b.realToFakeIdMap)})}),e.length&&ab.each(b.data,function(a,b){ab.each(e,function(a,c){return b[d.id]in c?(b[d.id]=c[b[d.id]],!1):void 0})})}}),ab(function(){var a={};b.data&&b.data.length&&b.fields&&b.fields.length&&ab.each(b.data,function(c,d){var e={};ab.each(b.fields,function(a,c){e[c.id]=b.getFieldValue(d,c.id,!0)}),a[d.Id]=e}),b.updateRows(a,{alwaysAddChanges:!0,notifyFields:!1})})}}function z(a){var b=a.data&&a.data.length<1,c="createRowIfNoneFound";b&&a[c]===!0&&(!a.doQuery||a.doQuery&&a.lastLoadTime)&&(a.createRow(),delete a[c])}function A(a){a.adapterName===fb&&ab.each(a.data,function(a,b){b.Id15=b.Id?b.Id.substring(0,15):null})}function B(a,b,c,d){var e=6378.137,f=(c-a)*Math.PI/180,g=(d-b)*Math.PI/180,h=Math.sin(f/2)*Math.sin(f/2)+Math.cos(a*Math.PI/180)*Math.cos(c*Math.PI/180)*Math.sin(g/2)*Math.sin(g/2),i=2*Math.atan2(Math.sqrt(h),Math.sqrt(1-h)),j=e*i;return 1e3*j}function C(a,b){var c=a.type,d=a.mergeField;if("modelmerge"===c&&a.model&&d&&!a.inactive){var e=G(a.model);if(e&&e.data&&e.data.length)if(f(a.operator)){var g=[];ab.each(e.data,function(){g.push(e.getFieldValue(this,d,!0))}),a.values=g}else{var h=a.row;(!h||0>h||h>=e.data.length)&&(a.row=0);var i=e.getFieldValue(e.data[a.row],d,!0);null!==i&&a.value!==i&&(a.value=i)}}if("userlocation"===a.locationSource&&!a.inactive&&!a.latitudeValue){var j=a.locationDelta?parseInt(a.locationDelta,10):100,k={enableHighAccuracy:!0,timeout:15e3,maximumAge:36e5};navigator.geolocation?(ab.blockUI({message:"Determining your current location...",onOverlayClick:ab.unblockUI}),navigator.geolocation[("false"===a.locationChangeBehavior?"getCurrent":"watch")+"Position"](function(c){ab.unblockUI();var d,e,f=c.coords,g=f.latitude,h=f.longitude;d=a.latitudeValue,e=a.longitudeValue,b.isProcessing||d&&e&&!(d&&e&&B(g,h,d,e)>=j)||(a.latitudeValue=g,a.longitudeValue=h,b.updateData())},function(c){ab.blockUI({message:"Unable to determine your current location: "+c.message,timeout:2e3}),"noquery"===a.locationNoValueBehavior?b.emptyData():(a.inactive=!0,b.updateData())},k)):ab.blockUI({message:"Your browser does not support GeoLocation. Some features may not work.",timeout:2e3})}}function D(a){a.conditions||(a.conditions=[]),ab.each(a.conditions,function(b,c){C(c,a)})}function E(){var a=[];return ab.each(hb,function(b,c){a.push(c)}),a}function F(){return hb}function G(a){var b=hb[a];return b}function H(a){return ib[a]}function I(b){var c=b?b.pageId:!1,d=c?a.$C(c):!1,e=d?d.getModels():hb;ab.each(e,function(a,b){r(b,{createDefaultRowIfNeeded:!1}),b.trigger("load")}),ab.each(e,function(a,b){b.needsMetadataLoad||z(b),delete b.realToFakeIdMap}),a.events.publish("skuid.models.initialized",[{pageId:c,models:e}])}function J(a){a.isAggregate&&a.data&&ab.each(a.data,function(b,c){c.Id=a.getNewId()})}function K(c){var d=c?c.actions:null,e=c?c.id:null,f=b().startsWith,g="_eventSubscriptions",h=c[g];h||(h=c[g]=[]),h.length&&(ab.each(h,function(b,c){a.events.unsubscribe(c)}),h.length=0),d&&d.length&&ab.each(d,function(d,g){var i=g.events,j=g.actions,k=g.fields;"string"==typeof j&&(j=b().makeXMLDoc(j)),i.length&&ab.each(i,function(d,g){h.push(a.events.subscribe(g,function(d){var h=!1;if(f(g,"models.")&&d.models[e]&&("models.saved"!==g||d.totalsuccess)?h=!0:f(g,"row.")&&d.modelId===e&&(h="row.updated"===g&&k&&k.length?b().doArraysIntersect(Object.keys(d.updates),k):!0),h){var i=ab.extend({model:G(e),initiatorId:e},d),l=a.actions.runActionsNode,m=a.component.getByType("skuidpage");m&&m.length?l(j,c,i):ab(document.body).one("pageload",function(){l(j,c,i)})}}))})})}function L(b,e){e||(e={});var g,h=!1,i=ab.Deferred(),j={},k={},l={},m={},n={},o=[],p={},q=e.rollbackOnAnyError,r="models.saved",s={};if(q===!0&&(k.rollbackOnAnyError=!0),ab.each(b,function(){var a,b=this,c=b.service,e=c.name,f=s[b.id]={};return b.id in l||b.isBeingSaved?!0:(l[b.id]=b,b.isBeingSaved=!0,a={id:b.id,type:b.objectName,updates:[]},m[e]||(m[e]=[],n[e]=c),m[e].push(b),j[e]||(j[e]=[]),ab.each(b.changes,function(a,c){c.__deleted&&b.isNewId(a)&&(f[a]=c,delete b.changes[a])}),o=o.concat(this.validateRequiredFields()),a.changes=b.changes,b.fields&&ab.each(b.fields,function(){this.type!==db&&this.query!==!1&&a.updates.push({id:this.id,targetObjects:this.targetObjects})}),void(b.hasChanged&&d(b.changes)&&(j[e].push(a),h=!0)))}),o.length&&(h=!1),h){var t=[],u={},v=[],w={event:r,models:l,initiatorId:e.initiatorId,insertResults:[],updateResults:[],deleteResults:[],totalsuccess:!0,messages:[]},x={};ab.each(j,function(b,e){var h=ab.Deferred(),i=m[b],j=n[b];t.push(h.promise()),k.operations=e,j.save(k).then(function(b){var e,j={},k={},m=function(a,b,c){ab.each(a,function(){this.rowId=c,this.model=b,v.push(this)})};b.totalsuccess=!0,ab.each(i,function(a,b){k[b.id]=!0}),ab.each(["delete","insert","update"],function(a,c){ab.each(b[c+"Results"],function(a,c){var d=c.source,e=l[d],f=c.id||c.oldId;c.success||(b.totalsuccess=!1,k[d]=!1,m(c.errors,e,f)),m(c.messages,e,f)})}),ab.each(v,function(a,b){var c,d,e=b.fields,f=b.model;if(e&&e.length)for(c=0;c<e.length;c++)d=f.getField(e[c]),e[c]={id:d.id,label:d.label}}),q&&b.totalsuccess||!q?(ab.each(b.deleteResults,function(a,b){if(b.success){var c=b.source;x[c]||(x[c]={}),x[c][b.id]=b.id}}),ab.each(b.insertResults,function(a,b){if(b.success){var d,e,f,g,h=b.source,i=l[h],k=b.oldId,m=b.id,n=b.record,o=i.registeredFieldsByRowThenField,p=i.registeredItemsByRow;if(n&&c(n))try{n=b.record=JSON.parse(n)}catch(q){}k in i.changes&&delete i.changes[k],k in i.originals&&delete i.originals[k],d=i.getRowById(k),j[k]=d,d.Id=m,i.adapterName===fb&&(d.Id15=m?m.substring(0,15):m),i.dataMap[m]=d,delete i.dataMap[k],e=k in o?o[k]:!1,f=k in p?p[k]:!1,e!==!1&&(o[m]=e,delete o[k]),f!==!1&&(p[m]=f,delete p[k]),n&&(g=u[h],g||(g=u[h]={}),g[d.Id]=n)}}),ab.each(b.updateResults,function(a,b){if(b.success){var d,e,f=b.id,g=b.record,h=b.source,i=l[h];
if(f in i.changes&&delete i.changes[f],f in i.originals&&delete i.originals[f],d=i.getRowById(f),g){if(c(g))try{g=b.record=JSON.parse(g)}catch(j){}e=u[h],e||(e=u[h]={}),e[d.Id]=g}}}),g={},ab.each([x,s],function(){d(this)&&ab.each(this,function(a,b){d(b)&&(g[a]||(g[a]=[]),ab.each(b,function(b){g[a].push(b)}))})}),d(g)&&(ab.each(g,function(b,c){a.$M(b).abandonRows(c,{notify:!1})}),g=null,x=null,s=null),d(u)&&ab.each(u,function(a,b){l[a].updateRows(b,{preventSetActive:!1,preventTrackChanges:!0})}),e=a.model.list(),ab.each(e,function(){var a=this,b=a.conditions,c={};a.hasChanged&&ab.each(a.changes,function(b,d){ab.each(d,function(d,e){if(e){var f,g,h=j[e];h&&(f=a.getField(d),f&&f.displaytype===bb&&(g=c[b],g||(g=c[b]={}),g[d]=h.Id,g[f.rel]=h))}})}),b&&b.length&&ab.each(b,function(a,b){if("modelmerge"===b.type){var c,d=G(b.model),e=b.mergeField,g=d&&e?d.getField(e):null;(g&&g.displaytype===bb||"Id"===e)&&(f(b.operator)?(c=b.values,c&&c.length&&ab.each(c,function(a,b){var d=j[b];d&&(c[a]=d.Id)})):b.value&&b.value in j&&(b.value=j[b.value].Id))}}),d(c)&&a.updateRows(c,{preventSetActive:!1,preventTrackChanges:!1})}),ab.each(e,function(){this.evaluateFormulaFields({preventTrackChanges:!0})})):q&&!b.totalsuccess&&d(s)&&ab.each(s,function(b,c){var d=a.$M(b).changes;ab.each(c,function(a,b){d[a]=b})}),ab.each(i,function(a,b){b.hasChanged=!k[b.id],ab.each(b.registeredEditors,function(a,c){c._GUID in p||(p[c._GUID]=c),c.hadErrors!==!0&&(c.hadErrors=b.hasChanged)})}),ab.each(i,function(a,b){b.isBeingSaved=!1}),h.resolve({insertResults:b.insertResults,updateResults:b.updateResults,deleteResults:b.deleteResults,totalsuccess:b.totalsuccess})},function(a){ab.each(i,function(){this.isBeingSaved=!1}),ab.each(i,function(a,b){ab.each(b.registeredEditors,function(a,c){c._GUID in p||(p[c._GUID]=c),c.hadErrors!==!0&&(c.hadErrors=b.hasChanged)})}),w.totalsuccess=!1,c(a)&&(a=[a]),ab.each(a,function(a,b){v.push({message:b,severity:"ERROR"})}),h.reject(a)})}),ab.when.all(t).then(function(b){ab.each(l,function(a,b){ab.each(b.registeredLists,function(){this.render({resetItemModes:!0,resetPagination:!0,changedRows:u[b.id],destroyDeletedRows:!0})})}),ab.each(b,function(a,b){ab.merge(w.insertResults,b.insertResults),ab.merge(w.updateResults,b.updateResults),ab.merge(w.deleteResults,b.deleteResults),b.totalsuccess===!1&&(w.totalsuccess=!1),v&&v.length&&(w.messages=ab.merge(w.messages,ab.map(v,function(a){return a.message})))}),a.events.publish(r,[w]),i.resolve(w),e.callback&&e.callback(w)},function(b){var d=[];ab.each(b,function(){c(this)&&d.push(this)}),v&&v.length&&(w.messages=ab.merge(w.messages||[],ab.map(v,function(a){return a.message}))),a.events.publish(r,[w]),i.reject(d)}).always(function(){d(p)&&(ab.each(p,function(){this.handleSave(!this.hadErrors,w),this.hadErrors=!1}),ab.each(p,function(){this.clearInlineErrors(),e.initiatorId&&this._GUID!==e.initiatorId||this.handleMessages(v,{initiatorId:e.initiatorId}),ab.each(v,function(){var a=this,b=a.model.registeredFieldsByRowThenField[a.rowId];b&&!b[0]&&(b=[b]),b&&b.length&&ab.each(b,function(){var b=this;a.fields&&ab.each(a.fields,function(){var c=this;ab.each(b,function(){var b=this;ab.each(b,function(){this.id===c.id&&this.handleMessage(a)})})})})})}))})}else{var y=o.length>0,z={event:r,models:l,initiatorId:e.initiatorId};z.totalsuccess=!y,q&&!z.totalsuccess?d(s)&&ab.each(s,function(b,c){var d=a.$M(b).changes;ab.each(c,function(a,b){d[a]=b})}):d(s)&&(g={},ab.each(s,function(a,b){d(b)&&(g[a]||(g[a]=[]),ab.each(b,function(b){g[a].push(b)}))}),d(g)&&ab.each(g,function(b,c){a.$M(b).abandonRows(c,{notify:!1})})),y&&(z.messages=ab.map(o,function(a){return a.message}));var A={};ab.each(l,function(a,b){var c=(!q||q&&z.totalsuccess)&&d(s)&&d(s[a]),e=b.registeredEditors,f=b.registeredLists;b.isBeingSaved=!1,b.hasChanged=d(b.changes),e&&d(e)&&ab.each(e,function(a,b){b._GUID in p||(p[b._GUID]=b)}),c&&f&&d(f)&&ab.each(f,function(a,b){b._GUID in A||(A[b._GUID]=b)})}),d(p)&&ab.each(p,function(){this.handleSave(z.totalsuccess,z),e.initiatorId&&this._GUID!==e.initiatorId||this.handleMessages(o,z)}),y&&ab.each(o,function(){var a=this;ab.each(a.model.registeredFieldsByRowThenField[a.rowId],function(){var b=this;a.fields&&ab.each(a.fields,function(){var c=this;ab.each(b,function(){this.id===c.id&&this.handleMessage(a)})})})}),d(A)&&ab.each(A,function(){this.render({resetPagination:!0,resetItemModes:!0,destroyDeletedRows:!0})}),a.events.publish(r,[z]),e.callback&&e.callback(z),i.resolve(z)}return i.promise()}function M(b,c){if(b){b instanceof Array||(b=[b]),c||(c={});var e,f={},g={};ab.each(b,function(a,b){var h={},i={},j=[];ab.each(b.changes,function(a){b.originals[a]||(a||"0"===a)&&j.push(b.getRowById(a))}),b.abandonRows(j),e=b.changes,b.changes={},ab.each(b.originals,function(a){var c=b.getRowById(a),d=i[a]={};b.isNewId(a)?(ab.each(c,function(a){return"Id"===a||"Id15"===a?!0:void(d[a]="")}),h[a]={Id:a}):ab.each(this,function(a,e){"__notdeleted"===a&&b.undeleteRow(c,{notify:!1}),d[a]=e})}),d(i)&&b.updateRows(i,{preventSetActive:!1,preventTrackChanges:!0});var k=jQuery.extend(!0,{},b.originals);b.originals=h,b.hasChanged=!1,b.evaluateFormulaFields({preventTrackChanges:!0}),b.notifyFieldsOfChange(k,c),b.registeredLists&&ab.each(b.registeredLists,function(){this._GUID in f||(f[this._GUID]=this)}),b.registeredEditors&&ab.each(b.registeredEditors,function(){this._GUID in g||(g[this._GUID]=this)})}),ab.each(f,function(a,b){b.render({resetItemModes:!0,resetPagination:!0,changedRows:e,destroyDeletedRows:!0})});var h={},i="models.cancelled",j={event:i,models:h,initiatorId:c.initiatorId};return ab.each(b,function(a,b){h[b.id]=b}),ab.each(g,function(a,b){b.handleCancel&&b.handleCancel(j)}),a.events.publish(i,[j]),b}}function N(a,b,c){return c=c||{},ab.extend(c,{loadAllMetadata:!0}),R(a,b,c)}function O(a,b,c){return R(a,b,c)}function P(a,b){return R(a,b,{syncOnly:!0})}function Q(a,b){return R(a,b,{addOnly:!0})}function R(e,f,g){g=g||{};var h=ab.Deferred(),i={},j={},k={},l={},m="models.loaded";if(ab.each(e,function(){var a=this,b=a.getService(),c=b.name;if(a.hasChanged)throw"Model '"+a.id+"' has unsaved changes. To update this model's data, you must first save or cancel the changes.";if(g.syncOnly){var d=a.getConditionByName("_sync",!1);if(!a.fieldsMap.IsDeleted){var e={id:"IsDeleted"};a.fields.push(e),a.fieldsMap.IsDeleted=e}d||(d={name:"_sync",type:"fieldvalue",field:"LastModifiedDate",inactive:!1,operator:"gte",encloseValueInQuotes:!1},a.addCondition(d)),a.setCondition(d,a.lastSyncTime),a.queryAllRows=!0}g.addOnly||(delete a.offsetPageNumber,delete a.offsetPageSize),a.isProcessing++,l[a.id]=++a.calloutIterator,i[c]||(i[c]=[],j[c]=b),i[c].push(a)}),d(i)){var n=[],o=[],p={},q={event:m,models:p,initiatorId:g.initiatorId};ab.each(i,function(d,e){var f=ab.Deferred(),h=j[d];n.push(f),h.load(e).always(function(){var a=(new Date).getTime();ab.each(e,function(b,c){c.isProcessing--,c.lastQueryTime=a})}).done(function(c){var d=c,h={};ab.each(d,function(a,c){var d,f=e[a];if("function"==typeof f.lastSuccessfulCallout&&(f.lastSuccessfulCallout=f.lastSuccessfulCallout()),!(l[f.id]>f.lastSuccessfulCallout))return!0;if(f.lastSuccessfulCallout=l[f.id],g.loadAllMetadata||f.needsMetadataLoad)f.needsMetadataLoad&&delete f.needsMetadataLoad,c.actions||delete c.actions,ab.extend(f,c),f.initialize(),d=f.data;else{if(g.syncOnly){var i=f.getConditionByName("_sync",!1),j=[];f.deactivateCondition(i),f.queryAllRows=!1,ab.each(c.data,function(){this.IsDeleted?f.removeRowById(this.Id):j.push(this)}),d=f.adoptRows(j,{notify:!1})}else d=g.addOnly?f.adoptRows(c.data,{doAppend:!0,notify:!1}):f.data=c.data||[];f.isAggregate?J(f):(c.realToFakeIdMap&&(f.realToFakeIdMap=c.realToFakeIdMap),y(f),z(f),A(f)),f.conditions&&c.conditions&&ab.each(f.conditions,function(a,b){var d=c.conditions[a];d&&(b.values=d.values),ab.extend(b,d)}),b().createMapForArray([f],"data","dataMap","Id"),f.canRetrieveMoreRows=c.canRetrieveMoreRows,f.recordsLimit=c.recordsLimit,f.lastSyncTime=c.lastSyncTime,f.debug=c.debug,f.soql=c.soql}h[a]=d}),ab.each(d,function(a){e[a].evaluateFormulaFields({preventTrackChanges:!0,updatedRows:h[a]})}),h={},ab.each(e,function(b,c){p[c.id]=c,ab.each(c.getDependentConditions(),function(b,c){ab.each(c,function(c,d){C(d,a.model.getModel(b))})})}),f.resolve(q)}).fail(function(a){c(a)?o.push({message:a,severity:"ERROR"}):a instanceof Array&&ab.each(a,function(a,b){o.push({message:b,severity:"ERROR"})}),ab.each(e,function(){var a=this;a.registeredEditors&&ab.each(a.registeredEditors,function(a,b){b._GUID in k||(k[b._GUID]=b)})}),f.reject(a)})}),ab.when.all(n).done(function(){ab.each(p,function(a,b){b.registeredItems&&ab.each(b.registeredItems,function(){this.fields&&ab.each(this.fields,function(){this.destroy()})}),b.registeredFields&&ab.each(b.registeredFields,function(){this.render&&this.render(),b.unregisterField(this)}),b.registeredLists&&ab.each(b.registeredLists,function(){this.render({doNotCache:!0,initiatorId:g.initiatorId})}),b.registeredEditors&&ab.each(b.registeredEditors,function(a,b){b._GUID in k||(k[b._GUID]=b)})}),ab.each(k,function(a,b){b.handleDataRefresh&&b.handleDataRefresh({updatedModels:ab.map(p,function(a){return a})})}),a.events.publish(m,[q]),f&&f(q),h.resolve(q)}).fail(function(b){var e,i=[],j=!1;ab.each(b,function(a,b){b instanceof Array?(ab.merge(i,b),j=!0):c(b)&&i.push(b)}),d(k)?ab.each(k,function(){g.initiatorId&&this._GUID!==g.initiatorId||this.handleMessages(o,{initiatorId:g.initiatorId})}):a.component.getByType("skuidpage")[0].addProblems(i),e=j===!1&&1===i.length?i[0]:i,f&&f(e),h.reject(e)})}return h.promise()}function S(b,c){c||(c={});var d={};ab.each(b,function(a,b){b.registeredFields&&ab.each(b.registeredFields,function(){b.unregisterField(this)}),b.registeredItems&&ab.each(b.registeredItems,function(){this.destroy()}),b.registeredLists&&ab.each(b.registeredLists,function(){this.render({doNotCache:!0})}),b.registeredEditors&&ab.each(b.registeredEditors,function(a,b){b._GUID in d||(d[b._GUID]=b)})}),ab.each(d,function(a,c){c.handleDataRefresh&&c.handleDataRefresh({updatedModels:b})});var e={},f="models.loaded",g={event:f,models:e,initiatorId:c.initiatorId};ab.each(b,function(a,b){e[b.id]=b}),a.events.publish(f,[g])}function T(c,d){var e,f,h,i,l,m,n,o=this,p=d?d.getAdapter():null;if(p&&p.setDefaultConditionState?p.setDefaultConditionState(o):(o.sourceType="fieldvalue",o.type="fieldvalue",o.operator="=",o.inactive=!1,o.encloseValueInQuotes=!0),c)if(c.jquery&&c.attr){if(n=c,f="false"!==n.attr("enclosevalueinquotes"),e=b().adjustValueBasedOnQuotedness,h=n.attr("sourcetype"),h&&h!==o.sourceType?o.sourceType=h:h=o.sourceType,l=n.attr("fieldmodel"),"fieldvalue"===h){if(o.field=n.attr("field"),m=n.attr("nosourcerowbehavior"),m&&(o.noSourceRowBehavior=m),l){o.fieldModel=l;var q,r=a.$M(l);r&&r.data&&r.data.length&&(q=r.data[0],o.fieldRow=q.Id)}}else"param"===h?o.sourceParam=n.attr("sourceparam"):"snippet"===h?o.snippetName=n.attr("snippet"):"userinfo"===h?o.sourceUserInfoType=n.attr("sourceuserinfotype"):b().endsWith(h,"property")&&(o.sourceProperty=n.attr("sourceproperty"),l&&(o.fieldModel=l));o.operator=n.attr("operator")||"=",o.type=n.attr("type")||"fieldvalue",o.encloseValueInQuotes=f,o.value=e(n.attr("value"),f),o.state=n.attr("state"),o.inactive="true"===n.attr("inactive")||!1,o.mergeField=n.attr("mergefield"),i=o.type,ab.each(["name","fieldFunction","fieldTargetObjects","label","model","noValueBehavior","customCookie","units","locationSource","locationModel","latitudeField","longitudeField","locationNoValueBehavior","locationChangeBehavior","locationDelta"],function(a,b){j(o,b,n,b.toLowerCase())});var s=n.attr("row");if(s){try{s=parseInt(s,10)}catch(t){}s||(s=0)}if(o.row=s,"userinfo"===i)o.userInfoType=n.attr("userinfotype"),o.mergeField=o.userInfoType||o.value,o.value=null;else if("modelmerge"===i)o.mergeField=n.attr("mergefield")||o.value,o.value=null;else if("multiple"===i){var u=o.values=[];n.children("values").first().children().each(function(){var a=b().getXML(this);a.length>g()?(a=b().decodeXML(a.substring(7,a.length-8)),u.push(e(a,f))):u.push("")})}else if("join"===i){o.joinObject=n.attr("joinobject"),o.joinField=n.attr("joinfield");var v=n.children("conditions"),w=n.children("condition");v.length&&(o.subConditions=ab.map(v.children(),function(a){return new T(ab(a))})),w.length&&(o.subConditions=ab.map(w,function(a){return new T(ab(a))})),o.subConditionLogic=k(n.attr("logic"),o.subConditions)}}else ab.extend(o,c);"param"===o.type?(o.value in a.page.params?o.value=a.page.params[o.value]:delete o.value,o.value||(o.value="","noquery"===o.noValueBehavior?d.doQuery=!1:"deactivate"===o.noValueBehavior&&(o.inactive=!0,o.originalInactive=!0)),o.originalValue=o.value,o.type="fieldvalue"):"fieldvalue"===o.type&&o.name in a.page.params&&(o.originalValue=o.value,o.value=a.page.params[o.name],o.inactive=!1),void 0===o.originalInactive&&(o.originalInactive=o.inactive),void 0===o.originalValue&&(o.originalValue=o.value)}function U(a){var c,d,e,f,g,h,i,l,n,o,p,q,r,s,t,u,v=a.xml,w=a.field||{},x="true"===v.attr("uionly"),y=a.model,z=a.adapter?a.adapter:y?y.getAdapter():null,A=z?"local"===z.prop("runtime.metadataSource"):!1,B="true"===v.attr("overridemetadata");if(c=w.id=b().escapeSingleQuotes((y&&y.pathToContent?y.pathToContent+".":"")+v.attr("id")),j(w,"targetObjects",v,"targetobjects"),m(w,"name",v,"name"),m(w,"function",v,"function"),j(w,"type",v,"type"),m(w,"orderByClause",v,"orderby"),w.sortable="true"===v.attr("sortable"),w.query="false"!==v.attr("query"),(x||A)&&(w.accessible=!0),x&&(w.uiOnly=!0),B&&(w.overrideMetadata=!0),(B||x||A)&&(j(w,"displaytype",v,"displaytype"),v.attr("label")&&(w.label=v.attr("label")),v.attr("helptext")&&(w.inlineHelpText=v.attr("helptext")),w.createable=w.editable="true"!==v.attr("readonly"),d=w.displaytype,"FORMULA"===d&&(d=w.displaytype=v.attr("returntype"),w.calculated=!0,x&&(w.createable=w.editable=!1,v.attr("readonly","true")),n="formula",o=v.children(n).first(),p=o&&o.length?b().getXML(o.get(0)):"",p=p.length>n.length+3?b().decodeXML(p.substring(n.length+2,p.length-n.length-3)):null,w.formula=p),"PICKLIST"===d||"MULTIPICKLIST"===d?(g=v.children("picklistentries").children(),g.length&&(w.picklistEntries=ab.map(g,function(a){var b=ab(a);return{value:b.attr("value"),label:b.attr("label"),defaultValue:"true"===(b.attr("defaultValue")||"false"),active:!0}}))):ab.inArray(d,["DOUBLE","CURRENCY","PERCENT"])>-1?(e=v.attr("precision"),null===e&&x?w.precision=8:null!==e&&(w.precision=parseInt(e,10)),f=v.attr("scale"),null===f&&x?w.scale=2:null!==f&&(w.scale=parseInt(f,10))):"INTEGER"===d?(h=v.attr("digits"),null===h&&x?w.digits=8:null!==h&&(w.digits=parseInt(h,10))):"TEXTAREA"===d||"TEXT"===d?(i=v.attr("digits"),null===i&&x?w.length=255:null!==i&&(w.length=parseInt(i,10))):d===bb&&(l=v.attr("targetobjects"),l&&(q=l.split(","),w.isNamePointing=q.length>1,w.relationshipName=w.rel=c+"__r",w.referenceTo=ab.map(q,function(a){return{accessible:!0,objectName:a}}),w.ref=l)),j(w,"defaultValue",v,"defaultValue")),ab.inArray(w.type,-1!==[db,eb])&&(r=v.children("fields").first(),u=v.children("conditions").first(),r.length>0&&(s=w.subFields=[],r.children("field").each(function(){var b=ab(this);s.push(new U({xml:b,field:a.field,model:a.model,adapter:a.adapter}))})),w.type===db)){if(t=v.attr("limit"),t||"0"===t)try{w.recordsLimit=parseInt(t,10),w.recordsLimit&&w.recordsLimit<1&&(w.recordsLimit=1)}catch(C){}w.subConditions=ab.map(u.children(),function(a){return new T(ab(a))}),w.subConditionLogic=k(u.attr("logic"),w.subConditions)}return w}function V(a){var b=a.attr("type"),c={verb:a.attr("verb"),endpoint:a.attr("endpoint"),type:b,pathToContent:a.attr("pathtocontent"),scopes:a.attr("scopes"),sendChanges:a.attr("sendchanges"),successIf:a.attr("successif"),successField:a.attr("successfield"),successValue:a.attr("successvalue")};return"insert"===b&&(c.insertResponse=a.attr("insertresponse"),c.createdRecordIdLocation=a.attr("createdrecordidlocation")),c.sendChanges&&(c.changeMapping=a.attr("changemapping"),c.changeMappingPrefix=a.attr("changemappingprefix")),c}function W(d){var e=this;if(d){if(c(d))try{d=b().makeXMLDoc(d)}catch(f){ab(document.body).one("pageload",function(){a.component.getByType("skuidpage")[0].addProblem("Unable to create Model: invalid Model XML string provided to Model constructor.")})}d.jquery?l({model:e,xml:d}):ab.extend(e,d)}e.conditions||(e.conditions=[]),e.fields||(e.fields=[]),e.data||(e.data=[]),e.changes={},e.originals={},e.registeredFields={},e.registeredFieldsByRowThenField={},e.registeredItems={},e.registeredItemsByRow={},e.registeredLists={},e.registeredEditors={},e.hasChanged=!1,"preventUnloadIfUnsavedChanges"in e||(e.preventUnloadIfUnsavedChanges=!0),e.isProcessing=0,e.calloutIterator=0,e.lastSuccessfulCallout=0,e.events={},h(e)}function X(a){var b=a.children("actions"),c=a.children("fields").first().children("field"),d=a.children("events").first().children("event"),e={};return b.length&&(e.actions=b),c.length&&(e.fields=ab.map(c,function(a){return a.textContent})),d.length&&(e.events=ab.map(d,function(a){return a.textContent})),e}function Y(a){var b,d,e=a[0],f={};return a.length<2?!1:(c(a[1])?(d={},d[a[1]]=a[2],b=a[3]):(d=a[1],b=a[2]),f[e.Id]=d,this.updates=f,void(this.options=b))}function Z(a,b){this.list=a,this.map=b}var $,_=a.model={},ab=a.$,bb="REFERENCE",cb="undefined",db="childRelationship",eb="array",fb="salesforce",gb="__hadPriorChanges",hb={},ib={},jb=1;Z.prototype={indexOf:function(a){var b=-1;return ab.each(this.list,function(c,d){return d.fieldName&&d.fieldName===a||d.fieldId===a?(b=c,!1):void 0}),b},size:function(){return this.list.length}},W.prototype={getService:function(){return h(this)},getAdapter:function(){return this.getService().getAdapter()},setParentPageId:function(a){var b=this;return b._parentPageId=a,b},getParentPage:function(){return a.$C(this._parentPageId)},getParentPageId:function(){return this._parentPageId},hasMetadataLoaded:function(){return!this.needsMetadataLoad},setMetadataHasLoaded:function(){return this.needsMetadataLoad=!1,this},isSingleRow:function(){var a=this,b=!1;return a.conditions&&a.conditions.length&&ab.each(a.conditions,function(a,c){return c.field&&"id"===c.field.toLowerCase()&&c.type&&"param"===c.type?(b=!0,!1):void 0}),b},getField:function(a,b){var c=this.fieldsMap,d=c;if(d&&(d=a in c?c[a]:!1,!d&&b&&b in c)){var e=c[b];e.type===db&&e.subFieldsMap&&a in e.subFieldsMap&&(d=e.subFieldsMap[a])}return d},getFieldValue:function(a,c,d){var e=b().getObjectProperty(a,c);return d?e:b().encodeHTML(e)},getFieldValues:function(a,b,c){var d=[],e=this;return ab.each(b,function(){d.push(e.getFieldValue(a,this,c))}),d},getFirstRow:function(){return this.data[0]},getRowById:function(a){return a in this.dataMap?this.dataMap[a]:!1},getNameField:function(){var a=this.getAdapter().getNameField;return a?a(this):void 0},getNameFieldValueForRow:function(a,c){var d,e=this,f=e.objectName,g=e.getNameField();return e.adapterName===fb&&f&&-1!==ab.inArray(f,["Lead","User","Contact"])?d=b().mergeAsText("row","{{#Name}}{{{Name}}}{{/Name}}{{^Name}}{{{FirstName}}} {{{LastName}}}{{/Name}}",{createFields:!1},e,a):g&&(d=e.getFieldValue(a,g,!0)),d&&c!==!0&&(d=b().encodeHTML(d)),d},load:function(a){return N([this],a)},updateData:function(a,b){return O([this],a,b)},sync:function(a){return P([this],a)},getMoreData:function(a){return Q([this],a)},loadNextOffsetPage:function(a){var b=this;if(b.canRetrieveMoreRows&&!b.isProcessing){if(b.offsetPageNumber&&b.offsetPageSize)b.offsetPageNumber++;else if(b.offsetPageSize=b.recordsLimit>2e3?2e3:b.recordsLimit||100,b.data.length>0){var c=b.offsetPageSize>0?Math.ceil(b.data.length/b.offsetPageSize):1;b.offsetPageNumber=c>1?c:2}else b.offsetPageNumber=1;b.getMoreData(function(){a&&a()})}},loadAllRemainingRecords:function(a){a=a||{};var b=this,c=b.recordsLimit,d=function(){if(b.canRetrieveMoreRows){var e=b.data.length;a.stepCallback&&a.stepCallback(e+1,e+c),b.loadNextOffsetPage(d)}else a.finishCallback&&a.finishCallback(b.data.length)};d()},getRows:function(a){return b().filterRowsByConditions(this.data,a)},adoptRow:function(a,b){var c=this.adoptRows([a],b);return c&&c.length?c[0]:null},adoptRows:function(a,c){c||(c={});var d=this,e=[];return ab.each(a,function(a,f){f.Id||(f.Id=b().generateGUID());var g=d.getRowById(f.Id);g?ab.extend(g,f):(c.doAppend?d.data.push(f):d.data.unshift(f),d.dataMap[f.Id]=f,g=f),e.push(g)}),c.notify!==!1&&d.notifyEditorsOfDataRefresh(),e},abandonRow:function(a){return this.abandonRows([a]),a},abandonRows:function(a,b){var c=this,e=c.changes,f=c.originals,g=c.registeredItemsByRow,h=c.registeredFieldsByRowThenField,i=[],j=!(b&&b.notify===!1);if(a&&a.length)return ab.each(a,function(a,b){var d=c._findRow(b);d&&i.push(d)}),i.length&&ab.each(i,function(a,b){var d=b.Id,i=ab.inArray(b,c.data),k=e?e[d]:!1,l=f?f[d]:!1;k&&delete e[d],l&&delete f[d],-1!=i&&(c.data.splice(i,1),delete c.dataMap[d]),j||c.registeredLists&&ab.each(c.registeredLists,function(){this.handleRowDeletion&&this.handleRowDeletion(d)}),d in g&&(ab.each(g[d],function(){c.unregisterItem(this)}),delete g[d]),d in h&&(ab.each(h[d],function(a,b){b.length&&ab.each(b,function(){c.unregisterField(this)})}),delete h[d])}),0===d(c.changes)&&(c.hasChanged=!1),j&&c.notifyEditorsOfDataRefresh(),a},emptyData:function(){var a=this,b=a.data;return a.data=[],a.dataMap={},a.changes={},a.originals={},a.hasChanged=!1,a.notifyEditorsOfDataRefresh(),ab.each(a.registeredItemsByRow,function(b,c){ab.each(c,function(){a.unregisterItem(this)})}),a.registeredItemsByRow={},ab.each(a.registeredFieldsByRowThenField,function(b,c){ab.each(c,function(b,c){ab.each(c,function(){a.unregisterField(this)})})}),a.registeredFieldsByRowThenField={},b},abandonAllRows:function(){return this.emptyData()},createRow:function(c){c||(c={});var d=this,e=d.hasChanged,f={Id:d.getNewId()},g={};if(c.editModeForNewItems&&(g.editModeForNewItems=!0),d.adapterName===fb&&(f.Id15=f.Id),d.hasChanged=!0,c.doAppend?d.data.push(f):d.data.unshift(f),d.dataMap[f.Id]=f,"ignoreDefaults"in c==!1||c.ignoreDefaults!==!0){var h,i,j=function(c){if(!c.inactive&&c.field&&"id"!==c.field.toLowerCase()&&"null"!=c.value){var e,g=d.getField(c.field),h=g?g.displaytype:null,i=c.operator||"=";if(g&&g.createable&&("="===i||"starts with"===i))if(C(c,d),e=c.value,"="===i&&h===bb){var j=g.rel,l=b().getNameField(g.ref),m=c.nameFieldValue||!1;if(m||"RecordType"!==g.ref||ab.each(d.recordTypeInfos,function(){return this.recordTypeId===e?(m=this.name,!1):void 0}),!m){if(c.model){var n=a.$M(c.model);n&&n.data.length&&ab.each(n.data,function(a,b){return e===b.Id||e===b.Id15?(m=b,!1):void 0})}if(!m){var p=b().getFieldReference(c.field,g);ab.each(k,function(a,b){b===c||b.field!==p||b.inactive||!b.value||c.operator&&"="!==c.operator||(m=b.value)})}if(!m&&(ab.each(d.data,function(){return this[c.field]&&(this[c.field]===e||this[c.field].length&&this[c.field].length>=15&&this[c.field].substr(0,15)===e)&&d.getFieldValue(this,j)?(m=d.getFieldValue(this,j,!0),!1):void 0}),!m)){var q=g.referenceTo,r=[];q&&q.length&&ab.each(q,function(){r.push(this.keyPrefix)}),r.length>1&&e&&e.length>=15&&(r=[e.substring(0,3)]),ab.each(r,function(b,c){var d=a.model.getModelsByKeyPrefix(c);d&&d.length&&ab.each(d,function(){var a=this,b=!1;return ab.each(a.data,function(){return this.Id&&this.Id===e||this.Id15&&this.Id15===e?(m=this,b=!0,!1):void 0}),b?!1:void 0})})}}var s={};if(m){var t;"object"==typeof m?t=m:(t={},t[l]=m),s[j]=t}s[c.field]=e,d.updateRow(f,s)}else{if(e=o(e,h),b().startsWith(h,"DATE")&&!e)return!0;d.updateRow(f,c.field,e)}}},k=[],l=c.additionalConditions,m=d.recordTypeInfos&&d.recordTypeInfos.length>1,n=[];if(d.conditions&&d.conditions.length&&ab.each(d.conditions,function(a,b){k.push(b)}),l&&l.length&&ab.each(l,function(a,b){k.push(b)}),m&&ab.each(d.recordTypeInfos,function(){return this.isDefaultRecordTypeMapping?(h=this.recordTypeId,!1):void 0}),d.createable&&k&&ab.each(k,function(a,b){!b.inactive&&b.field&&"RecordTypeId"===b.field&&b.value&&"null"!=b.value&&b.value.length>=15&&(h=b.value,n.unshift(a))}),h){var p=h.substring(0,15),q={};ab.each(d.recordTypeInfos,function(){return this.recordTypeId.substring(0,15)===p?(i=this,h=this.recordTypeId,!1):void 0}),q.RecordTypeId=h,i&&(q.RecordType={Name:i.name}),d.updateRow(f,q,{preventSetActive:!0})}n.length&&ab.each(n,function(){k.splice(this,1)}),d.fields&&ab.each(d.fields,function(a,c){var e,g,i=!1,j=c.displaytype;c.createable&&(m&&b().endsWith(j,"PICKLIST")&&(g=b().getPicklistEntriesValidForRecordTypes(d.objectName,c.id,[h]),g&&g.length&&ab.each(g,function(a,b){return"true"===b.defaultValue?(e=b.value,i=!0,!1):void 0})),i||(e=c.defaultValue),e&&0!==e&&"null"!=e&&("BOOLEAN"===j&&(e=e===!0||"true"===e),d.updateRow(f,c.id,e,{preventSetActive:!0})))}),k&&ab.each(k,function(a,b){j(b)})}f.Id in d.changes||(d.changes[f.Id]={}),d.evaluateFormulaFields({updatedRows:[f],updates:d.changes[f.Id]}),d.registeredLists&&ab.each(d.registeredLists,function(){c.initiatorId&&this._GUID===c.initiatorId||this.handleNewRow(f,g)}),d.notifyEditorsOfChange({hadPriorChanges:e,changes:d.changes[f.Id]});var r="row.created",s={modelId:d.id,rowId:f.Id,row:f,initiatorId:c?c.initiatorId:null,event:r};return ab.extend(s,g),a.events.publish(r,[s]),f},updateRow:function(){var a=new Y(arguments),b=this.updateRows(a.updates,a.options);return b&&b.length?b[0]:b},updateRows:function(a,c){var e,f,g,h,i=this,j=i.hasChanged,k=[],l=b().setObjectProperty;return a?(c||(c={}),c.preventTrackChanges||(c.preventTrackChanges=!1),f=c.notifyFields,typeof f===cb&&(f=!0),g=c.notify,typeof g===cb&&(g=!0),ab.each(a,function(a,d){var f,g,h=i.getRowById(a),j=i.isNewId(a);return h?void ab.each(d,function(a,d){var m,n,p,q=i.getField(a),r=!(q&&q.id&&(c._ignoreMetadata?0:j?!q.createable:!q.editable)||c.preventTrackChanges),s=q&&q.displaytype===bb&&!d,t=i.getFieldValue(h,a,!0);if(s&&(m=b().getReferenceFieldRelationshipName(a)),n=q&&q.displaytype?o(d,q.displaytype):d,(t===n||n!==n)&&!c.alwaysAddChanges)return!0;if(r&&(a&&(f||(e||(e={}),e[h.Id]={},f=i.changes[h.Id],e[h.Id][gb]=!!f,f||(f=i.changes[h.Id]={})),p=n,l(f,a,p),l(e[h.Id],a,p),s&&delete f[m]),i.hasChanged||c.preventSetActive||(i.hasChanged=!0),!i.isNewId(h.Id))){g||(g=i.originals[h.Id],g||(g=i.originals[h.Id]={}));var u=b().getObjectProperty(g,a,!0);null===u&&"object"==typeof u&&(l(g,a,i.getFieldValue(h,a,!0)),s&&l(g,m,i.getFieldValue(h,m,!0)))}l(h,a,n),s&&delete h[m],k.push(h)}):!0}),e&&(h=!1,ab.each(e,function(a,b){return b&&d(b)>1?(h=!0,!1):void 0}),h&&(i.evaluateFormulaFields({updatedRows:k,updates:a}),g!==!1&&i.notifyEditorsOfChange({hadPriorChanges:j,changes:e}),f!==!1&&g!==!1&&i.notifyFieldsOfChange(e,{initiatorId:c.initiatorId,hadPriorChanges:j}))),k):!1},notifyFieldsOfChange:function(b,c){var d=this,e=d.registeredFieldsByRowThenField;c=c||{},ab.each(b,function(b,f){var g=f[gb];delete f[gb],ab.each(f,function(a,d){b in e&&a in e[b]&&ab.each(e[b][a],function(){c.initiatorId&&this._GUID===c.initiatorId||this.handleChange&&this.handleChange(d,a)})});var h="row.updated";a.events.publish(h,[{event:h,modelId:d.id,rowId:b,row:d.getRowById(b),updates:f,rowHadPriorChanges:g,modelHadPriorChanges:c.hadPriorChanges,initiatorId:c?c.initiatorId:null}])})},_findRow:function(a){var b=this,c=typeof a;return"string"===c?b.getRowById(a):"number"===c?b.data[a]:a},deleteRows:function(b,c){c||(c={});var d=this,e={},f=d.hasChanged,g=c.notify!==!1,h="row.deleted";return b||(b=d.data),b.length&&(d.hasChanged=!0,ab.each(b,function(a,b){if(b=d._findRow(b)){var f,h=b.Id,i=d.changes[h];i||(d.changes[h]={},i=d.changes[h]),i.__deleted=!0,b.__deleted=!0,d.isNewId(h)||(f=d.originals[h],f||(d.originals[h]={},f=d.originals[h]),f.__notdeleted=!0),h in d.registeredItemsByRow&&ab.each(d.registeredItemsByRow[h],function(){c&&c.initiatorId&&this._GUID===c.initiatorId||this.handleMarkRowForDeletion&&this.handleMarkRowForDeletion(b)}),g&&(e[h]={__deleted:!0,__notdeleted:!1})}}),g&&(d.notifyEditorsOfChange({hadPriorChanges:f,changes:e}),ab.each(e,function(b){a.events.publish(h,[{event:h,modelId:d.id,rowId:b,row:d.getRowById(b),initiatorId:c?c.initiatorId:null,modelHadPriorChanges:f}])}))),d},deleteRow:function(a,b){return this.deleteRows([a],b),this},undeleteRows:function(b,c){c||(c={});var d=this,e={},f=d.hasChanged,g=c.notify!==!1,h="row.undeleted";b||(b=d.data),b.length&&(d.hasChanged=!0,ab.each(b,function(a,b){if(b=d._findRow(b)){var f=b.Id,h=d.changes[f];h&&"__deleted"in h&&delete h.__deleted,"__deleted"in b&&delete b.__deleted,f in d.registeredItemsByRow&&ab.each(d.registeredItemsByRow[f],function(){c.initiatorId&&this._GUID===c.initiatorId||this.handleUnmarkRowForDeletion&&this.handleUnmarkRowForDeletion(b)}),g&&(e[f]={__deleted:!1,__notdeleted:!0})}}),g&&(d.notifyEditorsOfChange({hadPriorChanges:f,changes:e}),ab.each(e,function(b){a.events.publish(h,[{event:h,modelId:d.id,rowId:b,row:d.getRowById(b),initiatorId:c?c.initiatorId:null,modelHadPriorChanges:f}])})))},undeleteRow:function(a,b){return this.undeleteRows([a],b)},removeRowById:function(a){return a||"0"===a?this.abandonRow(this.getRowById(a)):void 0},validateRequiredFields:function(){var a=[];return ab.each(this.registeredLists,function(){a=a.concat(this.validateRequiredFields())}),a},isNewId:function(a){return this.getService().isNewId(a)},getNewId:function(){return this.getService().getNewId()},save:function(a){return L([this],a)},cancel:function(a){return M([this],a),this},notifyEditorsOfChange:function(a){this.registeredEditors&&ab.each(this.registeredEditors,function(){this.handleChange&&this.handleChange(a)})},getConditionCookieName:function(a){return e(this,a)},setCondition:function(a,b,d){var e=!1;a.inactive=!1,f(a.operator)&&typeof b!==cb&&(b instanceof Array?(e=!0,a.values=b):a.values=c(b)&&-1!=b.indexOf(";")?b.split(";"):[b]),e||(a.value=b),d&&a.name&&this.getPersonalizationService().setCondition({name:a.name,value:b})},deactivateCondition:function(a,b){a.inactive=!0,a.value=a.originalValue,f(a.operator)&&(a.originalValue?a.values=-1!=a.originalValue.indexOf(";")?a.originalValue.split(";"):[a.originalValue]:a.values&&a.values.length||(a.values=[])),b&&a.name&&this.getPersonalizationService().setCondition({name:a.name,value:"-off-"})},activateCondition:function(a,b){a.inactive=!1,b&&a.name&&this.getPersonalizationService().setCondition({name:a.name,value:"-on-"})},resetCondition:function(a,b){a.inactive=a.originalInactive,a.value=a.originalValue,f(a.operator)&&(a.originalValue?a.values=-1!=a.originalValue.indexOf(";")?a.originalValue.split(";"):[a.originalValue]:a.values&&a.values.length||(a.values=[])),b&&a.name&&this.getPersonalizationService().resetCondition({name:a.name})},getConditionValueResult:function(c){var d,e,f=c.noValueBehavior||(-1!==ab.inArray(c.type,["param","multiple"])?"":"deactivate"),g=this,h={},i=b().startsWith(c.state,"filterable")&&c.name,j=c.value;if("userinfo"===c.type)e=b().getUserInfoPropValue(c.userInfoType);else if("modelmerge"===c.type){var k=G(c.model),l=k.getFirstRow();l&&(e=k.getFieldValue(l,c.mergeField,!0))}else if("blank"===c.type)e=null;else if("param"===c.type){var m=a.page.params,n=c.valueParamName;c.value&&c.value in m?(e=m[c.value],c.valueParamName=c.value):n&&n in m&&(e=m[n])}else e=c.value;return i&&"undefined"!=typeof j&&j!==e&&(e=j),d=e||e===!1||0===e||null===e,d?h.value=c.value=e:c.values&&c.values.length?h.values=c.values:"noquery"===f?(g&&(g.doQuery=!1),h.status="noquery"):"deactivate"===f?(c.originalInactive&&(c.originalInactive=c.inactive),c.inactive=!0,h.value=c.value=null,h.status="deactivate"):h.value=c.value="",h},getConditionValue:function(a){return this.getConditionValueResult(a).value},registerEditor:function(a){p(a,this.registeredEditors)},unregisterEditor:function(a){q(a,this.registeredEditors)},registerList:function(a){p(a,this.registeredLists)},unregisterList:function(a){q(a,this.registeredLists)},registerItem:function(a){p(a,this.registeredItems);var b=this.registeredItemsByRow;b&&a.row&&a.row.Id&&(a.row.Id in b||(b[a.row.Id]={}),b[a.row.Id][a._GUID]=a)},unregisterItem:function(a){q(a,this.registeredItems);
var b=this.registeredItemsByRow,c=a?a.row:0,e=c?c.Id:0,f=b[a.row.Id];b&&f&&a._GUID in f&&(delete f[a._GUID],d(f)||delete b[e])},registerField:function(a,b){p(a,this.registeredFields);var c=this.registeredFieldsByRowThenField,d=b?b:a.id;if(c&&a.row&&d&&a.row.Id){a.row.Id in c||(c[a.row.Id]={});var e=c[a.row.Id];d in e||(e[d]={}),e[d][a._GUID]=a}},unregisterField:function(a,b){if("string"==typeof a&&(a=this.registeredFields[a]),a){q(a,this.registeredFields);var c,e,f=this.registeredFieldsByRowThenField,g=[],h=a._GUID;f&&a.row&&a.row.Id&&(c=f[a.row.Id],c&&(b&&b.length&&ab.each(b,function(){g.push(this)}),a.id&&g.push(a.id),ab.each(g,function(a,b){e=c[b],e&&h in e&&(delete e[h],d(e)||delete c[b])}),d(c)||delete f[a.row.Id]))}},mergeRow:function(a,c,d){return b().merge("row",c,d,this,a)},getRowMergeResult:function(a,c,d){return b().getMergeResult("row",c,d,this,a)},mergeModel:function(a,c){return b().merge("model",a,c,this)},getMergeResult:function(a,c){return b().getMergeResult("model",a,c,this)},getOrderObject:function(){var a=this,b=(a.orderByClause||"").split(","),c=[],d={};return ab.each(b,function(){var b=ab.trim(this);if(b){var e,f,g,h,i=b.split(" "),j=i[0],k={suffix:i.length>1?i.slice(1).join(" "):"ASC NULLS LAST"};-1!==j.indexOf("(")?(h=j.split("("),g=h[0],e=h[1].split(")")[0],k.fieldId=e,g&&(k.fieldFunction=g),ab.each(a.fields,function(){return this.name&&this.id===e&&this["function"]===g?(f=this.name,!1):void 0}),f&&(k.fieldName=f)):a.isAggregate?(e=j,ab.each(a.fields,function(){return this.name&&this.id===e?(f=this.name,!1):void 0}),k.fieldId=e,f&&(k.fieldName=f)):(k.fieldId=j,f=j),c.push(k),d[f]=k}}),new Z(c,d)},toggleOrdering:function(a,d){var e,f,g=this,h=g.getOrderObject(),j="",k=c(a),l=k?a:a.id,m=k?a:a.name?a.name:l,n=k?null:a["function"],o=g.getField(m);return o.displaytype===bb&&(l=b().getFieldReference(l,o),m=i(l,n)),e=h.map[m],e?(f=ab.inArray(e,h.list),-1!=f&&h.list.splice(f,1),m in h.map&&delete h.map[m],ab.each(h.list,function(a,b){j+=i(b.fieldId,b.fieldFunction)+" "+b.suffix+","}),-1!=e.suffix.indexOf("ASC")?(j=i(l,n)+" DESC NULLS LAST,"+j,e.suffix="DESC NULLS LAST"):e=!1):(j=i(l,n)+" ASC NULLS LAST,"+(g.orderByClause||""),e={fieldId:l,fieldName:m,suffix:"ASC NULLS LAST"},n&&(e.fieldFunction=n)),j=j.replace(/,+$/,""),g.orderByClause=j,g.updateData(d),g.getPersonalizationService().setOrderBy({newValue:j}),e},createSearchSubConditions:function(a,c,d,e){return b().createSearchSubConditions(this,a,c,d,e)},buildSearchCondition:function(a,b,c,d){b=b?ab.trim(b):!1,d||(d={}),a||(a="__default_searchbox");var e=this,f=d.affectCookies||!1,g=b&&b.length>(d.useSOSLSearch?1:0),h=e.getConditionByName(a,!1),i=this.getAdapter().prop("canFieldsBeIndividuallySearched")!==!1;return g?(i?(h||(h=new T,h.name=a,h.type=d.useSOSLSearch?"search":"group",e.addCondition(h)),e.activateCondition(h,f),d.useSOSLSearch?(h.fieldfunction=d.SOSLFields,h.value=d.tokenize?ab.map(b.split(d.delemiter||" "),function(a){return'"'+a+'*"'}).join(" AND "):'"'+b+'*"'):e.createSearchSubConditions(h,b,c,d)):h&&e.setCondition(h,b,f),h&&"group"===h.type&&(h.value=b)):h&&(e.deactivateCondition(h,f),h.subConditions=[],h.subConditionLogic="",h.value=""),h},prepareSearchConditions:function(a,b,c,d){this.buildSearchCondition(null,b,a.searchFields,d)},isRowMarkedForDeletion:function(a){var b,c;return a?(b=u(a),c=this.getRowById(b),c&&a.__deleted===!0):!1},getRowChanges:function(a){a=this._findRow(a);var b;return a&&(b=this.changes?this.changes[a.Id]:null),b},getRowOriginals:function(a){a=this._findRow(a);var b;return a&&(b=this.originals?this.originals[a.Id]:null),b},isRowChanged:function(a){a=this._findRow(a);var b,c;return a?(b=u(a),c=this.getRowById(b),c&&b in this.changes):!1},doesRowHaveUnsavedChanges:function(a){return this.isRowChanged(a)},isRowNew:function(a){a=this._findRow(a);var b,c,d=this;return a?(b=u(a),c=this.getRowById(b),c&&d.isNewId(b)):!1},isNewRow:function(a){return this.isRowNew(a)},isRowUnsavedClone:function(a){return a=this._findRow(a),v(a,this)},cancelRowChanges:function(a,b,e){if(e||(e={}),!a)throw"Row is required.";var f=this,g=a.Id,h=f.originals[g],i=f.changes[g],j={},k="updateRow";return i&&(!b&&i?b=Object.keys(i):b&&c(b)&&(b=[b]),ab.each(b,function(a,b){return"Id"===b||"Id15"===b?!0:void(h&&b in h?j[b]=h[b]:f.isNewId(g)&&(j[b]=""))}),d(j)&&(f[k](a,j,{initiatorId:e.initiatorId}),d(i)||delete f.changes[g],d(h)||delete f.originals[g],d(f.changes)||(f.hasChanged=!1))),f},getPersonalizationService:function(){var b="_personalizationService",c=this[b];return c||(c=this[b]=a.personalization.createModelService({id:this.id})),c},notifyEditorsOfDataRefresh:function(a){S([this],a)},exportData:function(c){c||(c={});var d=this,e=d.isAggregate,f=new Date,g=c.fileName||d.id+"-export-"+f.getTime(),h=c.additionalConditions||!1,i=c.rows||d.data,j=(c.fields||d.fields).slice(0),k=i.length,l=j.length,m=c.useAPINamesForHeaders||!1,n=c.doNotAppendRowIdColumn||!1,o=!e&&!n,p="skuidExportForm"+ ++jb,q="skuidExportData"+jb,r="skuidExportFileName"+jb,s='<form name="'+p+'Name" id="'+p+'" action="'+(a.page.runningOnForceSite?a.page.currentSiteUrl:"/")+'apex/ExportData" method="POST" ><input type="text" name="dummyText" value="dummy"><input type="hidden" name="inputdata" id="'+q+'" value=""><input type="hidden" name="pgName" id="'+r+'" value="'+g+'"><input type="submit" id="submit'+p+'" name="submitBtn'+p+'"></form>',t=ab(s),u="";if(ab("body").append(t),l>0&&k>0){var v={},w=[];ab.each(j,function(a,b){b.name?v[b.name]=b:b.id&&(v[b.id]=b)}),o&&"Id"in v&&(o=!1),ab.each(j,function(a,c){if(c.displaytype&&c.displaytype===bb){var e=c.name?c.name:c.id,f=b().getFieldReference(e,c);if(!(f in v)&&f in d.fieldsMap){var g=d.getField(f);m||(g.label=c.label+": "+g.label),w.push({atIndex:a+1,id:f,field:g})}}}),w.length&&ab.each(w,function(a,b){j.splice(b.atIndex,0,b.field),l++}),o&&(j.push("Id"in d.fieldsMap?d.fieldsMap.Id:{id:"Id",name:"Id",label:"Id"}),l++),ab.each(j,function(a,c){var d=m?c.name?c.name:c.id:c.label;u+=b().escapeCSVCell(d)+(l-1>a?",":"\r\n")}),ab.each(i,function(a,c){var e=!0;h&&h.length&&(e=b().doesRowMeetConditions(c,h)),e&&ab.each(j,function(a,e){var f,g=e.name?e.name:e.id,h=e.template,i=e.type===db;i&&h&&(h="{{#"+g+".records}}"+e.template+",{{/"+g+".records}}"),f=d.getFieldValue(c,g,!0),i||!f&&0!==f&&f!==!1?d.getField(g)&&!i||!h?f="":(f=d.mergeRow(c,h).text(),i&&f&&(f=f.substring(0,f.length-1))):f=""+f,u+=""===f?f:b().escapeCSVCell(f),u+=l-1>a?",":"\r\n"})})}t.children("#"+q).val(u),t.submit(),t.remove()},getSOQL:function(){return this.soql},getDependentConditions:function(){var b=this,c={};return ab.each(a.model.list(),function(a,d){b!==d&&ab.each(d.conditions,function(a,e){"modelmerge"===e.type&&e.model===b.id&&(c[d.id]||(c[d.id]=[]),c[d.id].push(e))})}),c},getConditionByName:function(a,b){var c,d,e,f,g=this,h=[],i=Array.prototype.push,j=g.conditions,k=g.havings;if(j&&j.length&&i.apply(h,j),k&&k.length&&i.apply(h,k),h.length)for(e=0;e<h.length;e++){if(c=h[e],c.name===a)return c;if(b&&c.subConditions&&c.subConditions.length)for(f=0;f<c.subConditions.length;f++)if(d=c.subConditions[f],d.name===a)return d}return!1},hasCondition:function(a){return this.getConditionByName(a,!0)!==!1},addCondition:function(a,b){var c,d,e=this;return!a||a instanceof T||(a=new T(a)),b&&"or"==b.toLowerCase()||(b="AND"),e.conditions.push(a),c="("+e.conditions.length+")",e.conditionLogic&&""!==e.conditionLogic?(d="and"===b.toLowerCase()&&-1===e.conditionLogic.toLowerCase().indexOf("or"),e.conditionLogic=(d?"":"(")+e.conditionLogic+(d?"":")")+b+c):e.conditionLogic=c,a},initialize:function(){return r(this),this},register:function(a){var b,c=this,d=c.keyPrefix;return hb[a?a:c.id]=c,d&&(b=ib[d],b||(b=ib[d]=[]),-1===ab.inArray(b,c)&&b.push(c)),c},unregister:function(){var a,b=this,c=ib[b.keyPrefix];return delete hb[b.id],c&&(a=ab.inArray(c,b),-1!==a&&(c.splice(a,1),c.length||delete ib[b.keyPrefix])),b},on:function(a,b){var c=this.events;return a&&b?(a in c||(c[a]=[]),c[a].push(b),!0):!1},off:function(a){var b=this.events;a&&b&&a in b&&delete b[a]},trigger:function(a){var b=this.events;b&&a&&a in b&&b[a].length&&ab.each(b[a],function(a,b){b&&b()})},evaluateFormulaField:function(a,d){return c(d)&&(d=this.getField(d)),b().evaluateFormula({formula:d.formula,outputType:d.displaytype,model:this,row:a})},evaluateFormulaFields:function(a){a||(a={});var b,c,e=this,f={},g=a.updatedRows||e.getRows(),h=a.preventTrackChanges;g.length&&(b={_ignoreMetadata:!0},h&&(b.notify=!1),c={},e.fields&&ab.each(e.fields,function(a,b){b.calculated&&b.uiOnly&&(f[b.id]=b,ab.each(g,function(a,d){var f=c[d.Id],g=e.evaluateFormulaField(d,b);e.getFieldValue(d,b.id,!0)!==g&&(f||(f=c[d.Id]={}),f[b.id]=g)}))}),d(c)&&(e.updateRows(c,b),h&&(ab.each(c,function(a){var b=e.changes[a],c=e.originals[a];b&&(ab.each(b,function(a){a in f&&delete b[a]}),d(b)||delete e.changes[a]),c&&(ab.each(c,function(a){a in f&&delete c[a]}),d(c)||delete e.originals[a])}),d(e.changes)||(e.hasChanged=!1))))}},ab.extend(_,{Condition:T,Field:U,Model:W,cancel:M,getConditionCookieName:e,getModel:G,getModelsByKeyPrefix:H,getModelsByName:F,getModelsList:E,getMoreData:Q,getNewId:t,initializeModel:r,isNewId:s,list:E,load:N,map:F,onAllModelsLoaded:I,registerModel:w,save:L,sync:P,unregisterModel:x,updateData:O}),a.$M=G}(skuid),function(a){function b(){return"ontouchstart"in window||"onmsgesturechange"in window}function c(a,b){var c=this,d=[];c.options=k.extend({showHeader:!0,showMessages:!0,showErrorsInline:!0,showErrorsOnHover:!1},b),c._GUID=m.generateGUID(),c.models=[],c.modelsById={},c.lists=[],a&&(c.element=a.addClass("nx-editor"),c.options.showHeader&&(c.header=k("<div>").addClass("nx-editor-header"),c.submitwrapper=k("<div>").addClass("nx-header-"+(c.options.buttonPosition||"right")).appendTo(c.header),c.status=k('<div class="nx-status">').appendTo(c.header).hide(),c.statustext=k('<div class="nx-status-text"></div>').appendTo(c.status),d.push(c.header)),c.options.showMessages&&(c.messages=k('<div class="nx-messages">'),d.push(c.messages)),c.contents=k("<div>").addClass(c.options.customContentClass?c.options.customContentClass:"nx-editor-contents"),d.push(c.contents),c.element.append(d))}function d(a,b,c){var d=this;d._GUID=m.generateGUID(),d.list=a,d.row=b,d.defaultMode=c.mode||"read",d.mode=d.defaultMode,d.deleted=!1,d.selected=c.selected||!1,d.element=!1,d.fields=[],a&&a.model&&a.model.registerItem(d)}function e(a,b,c,d){var e=this;e._GUID=m.generateGUID(),e.row=a,e.model=b,e.editor=c,e.options=d||{},e.id=d.fieldId,e.name=d.fieldName,e.context=d.fieldContext,e.id&&(e.metadata=e.model.getField(e.name?e.name:e.id,e.context));var f=e.metadata;e.options.label?e.label=e.options.label:f&&(e.label=f.label),e.required=e.options.required||f&&f.required?!0:!1,e.mode=d.mode||"read",e.element=k("<div>").addClass("nx-field").attr("data-uid",e._GUID),d.additionalClass&&e.element.addClass(d.additionalClass),e.element.data("object",e),e.editable=(!f||b.isNewId(a.Id)&&f.createable||f.editable)&&e.options.editable!==!1&&"readonly"!==e.mode,e.options.register&&e.model.registerField(e);var g=d.controllingFields;if(f&&("PICKLIST"===f.displaytype||"MULTIPICKLIST"===f.displaytype)){var h=f.controllingField,i=e.model.getField("RecordTypeId");g||(d.controllingFields=g=[]),i&&g.push(i.id),h&&g.push(h)}g&&g.length&&k.each(g,function(){var a=this;-1!==a.indexOf(".")&&(a=a.split(".")[0]),e.model.registerField(e,a)})}function f(a){a=a||{};var b=this,d=a.grandparent,e=a.parent,f=a.model,g=a.element,h="nx-queue";b.model=f,d.css({overflow:"hidden","overflow-x":"hidden","overflow-y":"hidden"}),e.css({position:"relative","padding-left":"0px","padding-right":"0px",height:"100%"}),b.element=g.addClass(h).data("object",b).appendTo(e);var i=a.title?m.mergeAsText("model",a.title,{createFields:!0,registerFields:!1},f):"";b.header=k("<div>").addClass(h+"-header").attr({"aria-controls":g.prop("id")}),b.headerInner=k("<div>").addClass(h+"-header-inner").appendTo(b.header),b.titleBar=k("<div>").addClass(h+"-titlebar").appendTo(b.headerInner),(a.showSearchBox===!0||a.filtersXML&&a.filtersXML.children&&a.filtersXML.children().length>0)&&(b.titleIcon=k("<div>").addClass("ui-icon ui-icon-gear "+h+"-titleicon").on("click",function(){b.settingsBar.toggle(),b.element.css("border-top",b.header.height()+2+"px solid white")}).appendTo(b.titleBar)),b.titleText=k("<div>").text(i).addClass(h+"-titletext").appendTo(b.titleBar),b.settingsBar=k("<div>").addClass(h+"-settings").hide().appendTo(b.headerInner),e.append(b.element,b.header),b.editor=new c(b.element,{showSaveCancel:!1,buttonPosition:"block"});var j={};j.render=function(c){c.element.addClass(h+"-item");var d=k("<div>").addClass(h+"-item-inner").appendTo(c.element);a.tagRenderer&&a.tagRenderer(b.model,b.list,c,d)},b.views={standard:j},b.list=new r(b.editor,b.model,{views:b.views,listFilters:a.filtersXML,conditions:a.editorConditions,context:a.context,showSearchBox:a.showSearchBox,useSOSLSearch:a.useSOSLSearch,SOSLFields:a.SOSLFields,searchMethod:a.searchMethod||"server",searchConditionName:a.searchConditionName,tokenizeSearch:"undefined"!=typeof a.tokenizeSearch?a.tokenizeSearch:!0,searchPlaceholderText:a.searchPlaceholderText,delayFilterExecution:a.delayFilterExecution,personalizationService:a.personalizationService}),b.model.registerList(b.list),b.list.render(),b.list.attach();var l=this.list.editor.header;l.detach().appendTo(b.settingsBar),b.element.on("click.skuid","."+h+"-item",function(b){var c=k(this).data("object");a.tagClickAction&&a.tagClickAction(c),b.stopPropagation()})}function g(a,b){b||(b={});var c=b.mode||"edit",d=k("<div>").addClass("nx-editor-contents nx-basicfieldeditor-section-body");return k.each(a,function(a,e){var f=k("<div>").addClass("nx-basicfieldeditor-item"),g=k("<div>").addClass("nx-basicfieldeditor-item-label").text(e.metadata.label).appendTo(f);e.mode=c,e.editable=e.metadata.editable,e.editor=b.editor,e.wrapperElement=f,e.labelElement=g,e.render(),f.append(e.element),d.append(f)}),d}function h(b,c){var d,e,f=c.model,g=b.attr("id"),h=b.attr("name"),i=b.attr("type"),j=b.attr("valuehalign"),l={additionalClass:c.layoutclass,allowHTML:"true"===b.attr("allowhtml"),editable:"true"!==b.attr("readonly"),fieldId:g,fieldName:h,maxDisplayCharacters:b.attr("maxdisplaycharacters"),displayRows:b.attr("displayrows"),maxSelected:b.attr("maxselected"),mode:c.mode||"read",register:!0,renderAs:b.attr("renderAs"),type:i},n=f.getField(h?h:g);if(g&&!n)return!1;if(n&&(d=n.displaytype),e="ARRAY"===d,"CUSTOM"===i&&(l.snippet=b.attr("snippet")),j&&(l.valueHorizontalAlignment="right"),"MULTIPICKLIST"===d?l.maxSelected=b.attr("maxselected"):-1!==k.inArray(d,["PICKLIST","REFERENCE"])?l.addNoneOption="true"===b.attr("addnoneoption"):-1!==k.inArray(d,["DOUBLE","CURRENCY","PERCENT"])?l.decimalPlaces=b.attr("decimalplaces"):m.startsWith(d,"DATE")&&(l.showMonthPicker="true"===b.attr("monthpicker"),l.showYearPicker="true"===b.attr("yearpicker"),l.showYearPicker&&(l.yearPickerRange=(b.attr("yearpickermin")||"c-10")+":"+(b.attr("yearpickermax")||"c+10")),"DATETIME"===d&&(l.minuteIncrement=parseInt(b.attr("minuteincrement")||"5",10))),"REFERENCE"===d){l.optionsource=b.attr("optionsource"),l.optionmodel=b.attr("optionmodel"),l.template=b.attr("displaytemplate"),l.searchTemplate=b.attr("searchtemplate"),l.tokenizeSearch=b.attr("tokenizesearch"),l.delimiter=b.attr("delimiter");var o=[],p=t(b.children("filters")),q=b.children("searchfields").first(),r=q.children();p&&p.length&&(l.filters=p,k.each(p,function(){"dependent"===this.type&&o.push(this.depfield)}),o.length&&(l.controllingFields=o)),l.useSOSLSearch="true"===q.attr("usesosl"),l.SOSLFields=q.attr("soslfields"),r.length&&(l.searchFields=[],l.returnFields=[],r.each(function(){var b,c,d=k(this),e=d.attr("return"),f=d.attr("show"),g=d.attr("query"),h=d.attr("field"),i=!1,j=!1;"true"===g&&l.searchFields.push({id:h,searchOperator:d.attr("operator")}),"undefined"!=typeof e?"true"===e&&(i=!0,"true"===f&&(j=!0)):"true"===f&&(i=!0,j=!0),i&&(b={id:h,showInSearchDialog:j},c=d.children("label").first(),c&&c.length&&(b.label=a.utils.getXML(c[0])),l.returnFields.push(b))}))}return b.children("enableconditions")&&(l.enableConditionsXML=b.children("enableconditions")),"true"===b.attr("required")&&(l.required=!0),l}function i(a,b,c){a&&(a.css("opacity",1).show(),b.text(c))}function j(a,b,c,d){a&&(b.text(c),0===d?a.hide():a.animate({opacity:"0"},d||500,function(){a.hide()}))}var k=a.$,l=a.ui={},m=a.utils,n=a.$L,o=m.encodeHTML,p=m.decodeHTML,q="_uniqueMessages";c.prototype={id:function(){return this._GUID},registerModel:function(a){if(!a)return this;var b=this,c=b.modelsById,d=!a.hasChanged;return c[a.id]||(b.models.push(a),c[a.id]=a,a.registerEditor(b),b.options.showSaveCancel&&!b.submitbuttons&&(b.savebutton=k("<div>").addClass("sk-button-save").text(n("save")).skooButton({icon:"sk-icon-save",disabled:d}),b.cancelbutton=k("<div>").addClass("nx-button-secondary sk-button-cancel").text(n("cancel")).skooButton({icon:"sk-icon-cancel",disabled:d}),b.savebutton.on("click.skuid",function(){k(this).removeClass("ui-state-hover"),b.submitbuttons&&b.submitbuttons.filter(".ui-button").button("disable"),b.save()}),b.cancelbutton.on("click.skuid",function(){k(this).removeClass("ui-state-hover"),b.submitbuttons&&b.submitbuttons.filter(".ui-button").button("disable"),b.cancel()}),b.submitbuttons=b.savebutton.add(b.cancelbutton),b.submitwrapper.append(b.savebutton,b.cancelbutton))),b},registerList:function(a){this.lists.push(a),this.registerModel(a.model)},unregister:function(){var a=this;return a.lists&&a.lists.length&&k.each(a.lists,function(){this.unregister&&this.unregister()}),a.models&&a.models.length&&k.each(a.models,function(){this.unregisterEditor(a)}),a},hasModelWithChanges:function(){var a=this,b=!1;return k.each(a.models,function(){return this.hasChanged?(b=!0,!0):void 0}),b},handleChange:function(){var a=this;a.submitbuttons&&a.submitbuttons.filter(".ui-button").button("enable"),a.lists.length&&k.each(a.lists,function(a,b){b.disableFiltersAndSearch().disableLoadMore()})},clearMessages:function(){this.messages&&this.messages.empty(),this[q]={}},clearInlineErrors:function(){var a=this;a.element&&a.element.find(".nx-error-inline").remove().end().find(".nx-field-error").removeClass("nx-field-error nx-field-error-icon")},handleMessages:function(a,b){var c=this,d="nx-dupcounter",e=c[q];return e||(e=c[q]={}),c.messages?b&&b.initiatorId&&c._GUID!==b.initiatorId?!1:void k.each(a,function(a,b){var f,g,h,i,j="nx-message",l=b.message;"ERROR"===b.severity||"FATAL"===b.severity?j="nx-error":"WARNING"===b.severity&&(j="nx-warning");try{f=e[j],f||(f=e[j]={}),g=f[l],g?g.count++:g=f[l]={count:1}}catch(m){}g.element?i=g.element:(i=g.element=k("<div>").addClass(j),i.append("DUPLICATE_VALUE"===b.status?l:k("<div>").text(p(l))),i.on("click.skuid",function(){k(this).remove()}),c.messages.append(i)),g.count>1&&(h=i.children("."+d),h.length?h.text(g.count):i.prepend('<div class="'+d+'" style="">'+g.count+"</div>"))}):!1},handleCancel:function(){var a=this,b=!1,c={};k.each(a.models,function(a,d){d.hasChanged&&(b=!0,c[d.id]=!0)}),b===!1&&(a.clearMessages(),a.submitbuttons&&a.submitbuttons.filter(".ui-button").button("disable")),a.lists.length&&k.each(a.lists,function(a,b){!b.model||b.model.id in c||b.enableFiltersAndSearch().enableLoadMore()})},handleSave:function(a){var b=!1,c={},d=this;k.each(d.models,function(a,d){d.hasChanged&&(b=!0,c[d.id]=!0)}),a?d.hideStatus(n("saved")):d.hideStatus("",0),d.clearMessages(),a&&!b&&d.submitbuttons&&d.submitbuttons.filter(".ui-button").button("disable"),!a&&b&&d.submitbuttons&&d.submitbuttons.filter(".ui-button").button("enable"),d.lists.length&&k.each(d.lists,function(a,b){!b.model||b.model.id in c||b.enableFiltersAndSearch().enableLoadMore()})},cancel:function(){a.model.cancel(this.models,{initiatorId:this._GUID})},save:function(b){b=b||{};var c="rollbackOnAnyError";!(c in b)&&c in this.options&&(b[c]=this.options[c]),this.setStatus(n("saving")),b.initiatorId=this._GUID,a.model.save(this.models,b)},setStatus:function(b){a.ui.setStatus(this.status,this.statustext,b)},hideStatus:function(b,c){a.ui.hideStatus(this.status,this.statustext,b,c)},createConditionsFromXml:function(b,c){if(b){var d,e=this.conditions,f=0;if(e||(e=this.conditions=[]),d=c?c.createConditionsFromXml(b):a.component.Component.prototype.call(this,b),d&&d.length)for(;f<d.length;f++)e.push(d[f]);else d=[];return d}},addConditions:function(a){var b=this;a&&a.length&&(b.conditions||(b.conditions=[]),k.each(a,function(a,c){b.conditions.push(c)}))},getConditions:function(){return this.conditions}};var r=function(b,c,d){var e=this;e._GUID=m.generateGUID(),e.editor=b,e.model=c,e.options=d||{},e.views=d.views,e.mode=d.mode,e.personalizationService=d.personalizationService||d.component&&d.component.getPersonalizationService();var f=e.personalizationService&&e.personalizationService.getSettings()._List||{};e.conditions=d.conditions,e.context=d.context,e.visibleItems=[],e.currentView=!1;var g;if(e.views&&(g=Object.keys(e.views)),g&&(e.currentView=g[0]),g&&g.length>1){var h=f.lastViewId;k.each(e.views,function(a){return a===h?(e.currentView=a,!1):void 0}),e.editor.header.append(e.makeViewSwitcher())}if(e.element=!1,e.contents=!1,e.conditionsBar=k("<div>").addClass("left"===e.editor.options.buttonPosition?"nx-conditioncontainer-left":"nx-conditioncontainer"),e.searchBox=!1,e.searchFields=d.searchFields||[],e.searchSubFields=d.searchSubFields||{},e.searchFieldsMap={},e.searchSubFieldsMap={},e.filters=[],e.searchFields&&e.searchFields.length){var i=e.searchFields;e.searchFields=[],k.each(i,function(a,b){e.addSearchField(b)})}if(e.searchSubFields&&a.utils.size(e.searchSubFields)>=1){var j=e.searchSubFields;e.searchSubFields={},k.each(j,function(a,b){k.each(b,function(b,c){e.addSearchSubField(a,c)})})}e.customFilter=d.customFilter||!1,e.customFilterValue=d.customFilterValue||"",e.searchMethod=d.searchMethod||"server",e.searchConditionName=d.searchConditionName,e.searchPlaceholderText=d.searchPlaceholderText||null;var l=d.requiredFields;e.requiredFields=l&&m.size(l)?l:{},e.footer=k("<div>").addClass("nx-list-footer"),e.footerleft=k("<div>").addClass("nx-list-footer-left").appendTo(e.footer),e.footercenter=k("<div>").addClass("nx-list-footer-center").appendTo(e.footer),e.footerright=k("<div>").addClass("nx-list-footer-right").appendTo(e.footer),e.currentPage=0;var o=d.pageSize;o&&("all"!=o?(d.pageSize=parseInt(d.pageSize,10),e.currentPageSize=f.pageSize||d.pageSize):e.currentPageSize="all"),e.editor.registerList(e),e.makeConditionsBar(),e.editor&&e.editor.header&&(e.editor.header["left"===e.editor.options.buttonPosition?"prepend":"append"](e.conditionsBar),e.options.showSearchBox&&e.searchBox===!1&&(e.searchBox=e.makeSearchBox(),e.searchBox&&e.editor.submitwrapper.append(e.searchBox)),e.options.delayFilterExecution&&(e.applyFiltersBtn=k("<div>").addClass("sk-button-applyfilter").text(n("apply")).skooButton({icon:"sk-icon-search-go",disabled:!1,hoverText:n("apply")}).hide().on("click",function(){e.applyFiltersAndSearch()}),e.cancelFiltersBtn=k("<div>").addClass("sk-button-cancelfilter").text(n("cancel")).skooButton({icon:"sk-icon-cancel",disabled:!1,hoverText:n("cancel")}).hide().on("click",function(){e.cancelFiltersAndSearch()}),e.editor.submitwrapper.append(e.applyFiltersBtn,e.cancelFiltersBtn))),e.renderedItems={}},s=function(a,b){return a.footerleft.find(".nx-list-loadmore").toggleClass("unavailable",b),a};r.prototype={id:function(){return this._GUID},unregister:function(){var a=this;return a.model&&a.model.unregisterList(a),a.renderedItems&&k.each(a.renderedItems,function(){this.unregister&&this.unregister()}),a},getSelectedItems:function(){var a=[];return k.each(this.renderedItems,function(b,c){c.selected&&a.push(c)}),a},unSelectAll:function(){k.each(this.renderedItems,function(a,b){b.selected&&(b.selected=!1)})},addSearchField:function(a,b){var c=this;if(a){var d,e=c.model.getField(a.id),f=e.displaytype;f in l.searchableDisplayTypes&&e.filterable&&(e.id in c.searchFieldsMap||(d=k.extend({},e),b&&(d.searchOperator=b),c.searchFields.push(d),c.searchFieldsMap[e.id]=d))}},addSearchSubField:function(a,b){var c=this;if("object"==typeof b&&(b=b.id),a&&b){var d=c.model.getField(b,a),e=d.displaytype;if(e in l.searchableDisplayTypes&&d.filterable){var f=c.searchSubFieldsMap[a],g=c.searchSubFields[a];f||(f=c.searchSubFieldsMap[a]={},g=c.searchSubFields[a]=[]),d.id in f||(f[d.id]=1,g.push(d))}}},addRequiredField:function(a){this.requiredFields[a.id]=a},removeRequiredField:function(a){delete this.requiredFields[a.id]},validateRequiredFields:function(){var a=this,b=[],c=a.model,d=a.requiredFields;return k.each(c.changes,function(e,f){if(!f.__deleted){var g={severity:"ERROR",status:"REQUIRED_FIELD_MISSING",fields:[],model:c},h=c.getRowById(e),i="",j=!1;h&&h.Id in a.renderedItems&&k.each(d,function(a,b){var d=c.getFieldValue(h,a,!0),f=(""===d||null===d)&&"BOOLEAN"!==b.displaytype;f&&(i&&(i+=", "),i+="["+b.label+"]",g.fields.push({id:b.id,label:b.label}),g.rowId=e,j=!0)}),j&&(g.message=n("required_fields_have_no_value")+" "+i,b.push(g))}}),b},getView:function(a){return a||(a=this.currentView),this.views[a]},callViewOperation:function(a,b){b||(b=this.getView()),b&&a&&a in b&&b[a](this)},setUp:function(a){this.callViewOperation("setUp",a)},beforeRender:function(a){this.callViewOperation("beforeRender",a)},renderComplete:function(a){this.callViewOperation("renderComplete",a)},tearDown:function(a){this.callViewOperation("tearDown",a)},getAllRows:function(){var a,b,c=this,d=c.context;return c.conditions?a=m.filterRowsByConditions(c.model.data,c.conditions,d):(a=[],c.model.data&&c.model.data.length&&k.each(c.model.data,function(b,c){a.push(c)})),c.customFilter&&c.customFilterValue&&(b=[],k.each(a,function(){c.customFilter(c.customFilterValue,this)&&b.push(this)}),a=b),a},render:function(b){b=b||{};var c,d,e=this,f=e.options,g=[],h=b.previousView||!1,i=h&&h!==e.currentView,j=e.getView(),l=!e.element||b.doNotCache||j.alwaysFullRender,m=b.changedRows,o=this.options.showLoadMore!==!1,p="deleted",q=e.model.getConditionByName(e.searchConditionName||"__default_searchbox");if(e.searchbox&&q&&("group"===q.type||"search"===q.type))if(b.initiatorId&&b.initiatorId===e._GUID);else{var r;if(q.value&&"search"===q.type)if(e.options.tokenizeSearch){r="";var s=q.value.split(" AND ");k.each(s,function(a,b){r+=b.substring(1,b.length-2)+" "}),r.substring(0,r.length-1)}else r=q.value.substring(1,q.value.length-2);else r=q.value;r&&!q.inactive?(e.searchbox.val(r),e.searchbox.data("curval",r)):(e.searchbox.val(""),e.searchbox.data("curval",""))}j.alwaysFullRender&&(b.doNotCache=!0),i&&(h=e.getView(h),h&&e.tearDown(h)),b.resetPagination&&(e.currentPage=0),d=e.getAllRows();var t=d.length,u=e.currentPageSize,v=0,w=t;if(e.footer&&(e.footerleft.empty(),e.footercenter.empty(),e.footerright.empty()),(!e.element||i)&&(e.element&&e.element.remove(),e.element=k("<"+(j.nodeType||"div")+">").addClass("nx-list"),c=e.contents=k("<"+(j.contentsNodeType||"div")+">").addClass("nx-list-contents").appendTo(e.element),e.setUp(j)),u&&"all"!=u&&t>u){e.currentPage<0&&(e.currentPage=0);var x=Math.ceil(t/u);e.currentPage>x-1&&(e.currentPage=x-1),v=u*e.currentPage,w=u*(e.currentPage-0+1),e.currentPage==x-1&&(w=t),d=d.slice(v,w);var y=k("<div>").addClass("nx-buttonset"),z=k("<div>").addClass("first").text(n("first")).button(),A=k("<div>").addClass("prev").text(n("previous")).button(),B=k("<div>").addClass("next").text(n("next")).button(),C=k("<div>").addClass("last").text(n("last")).button(),D=e.currentPage<x-3?e.currentPage-2:x-5,E=e.currentPage>2?e.currentPage+2:4;y.append(z,A);for(var F=D;E>=F;F++)if(F>=0&&x>F){var G=k("<div>").text(F-0+1).attr("data-pn",F).button();F===e.currentPage&&G.addClass("nx-button-selected"),y.append(G)}y.append(B,C).buttonset(),y.children().filter('[data-pn="'+e.currentPage+'"]').button("disable"),0===e.currentPage?(z.button("disable"),A.button("disable")):e.currentPage==x-1&&(C.button("disable"),B.button("disable")),this.footerright.append(y),y.on("click",".ui-button",function(){var a=k(this);a.is(".first")?e.goToPage(0):a.is(".prev")?e.prevPage():a.is(".next")?e.nextPage():e.goToPage(a.is(".last")?x-1:parseInt(a.data("pn"),10))})}if(u&&"all"!=u&&t){var H=[5,10,25,50];-1==H.indexOf(f.pageSize)&&H.push(f.pageSize),-1==H.indexOf(e.currentPageSize)&&H.push(e.currentPageSize);var I=function(a,b){return a-b};H.sort(I);var J=k("<select>");J.append(k.map(H,function(a){return k('<option value="'+a+'">'+a+"</option>")})),J.children().filter('[value="'+u+'"]').attr("selected","selected"),J.change(function(){var a=parseInt(k(this).val(),10);e.personalizationService&&e.personalizationService.updateSettings({_List:{pageSize:a}}),e.currentPageSize=a,e.render()});var K=k("<span>");K.append("<span>"+n("show")+" </span>",J,"<span> "+a.label.merge(n("objects_per_page"),e.model.labelPlural)+"</span>"),this.footerleft.append(K)}var L=n("pagination_limit_reached"),M=e.model.debug===L,N=e.model.canRetrieveMoreRows===!0;if(t){var O=t+"";N&&(O+="+"),this.footercenter.append("<span>"+a.label.merge(n("showing_rows"),v+1,w,O)+(M?" ("+L+")":"")+"</span>")}if(N&&!M&&o){var P=k('<div class="nx-list-loadmore">').text(n("load_more")).on("click.skuid",function(){k(this).is(".unavailable")||(e.blockUI({message:n("loading")}),e.model.loadNextOffsetPage(function(){e.unblockUI()}))});this.footerleft.append(P)}t||this.footercenter.append("<span>"+a.label.merge(n("no_objects_to_display"),e.model.labelPlural)+"</span>").css("line-height","25px"),b.doNotCache&&(k.each(e.renderedItems,function(a,b){b&&b.destroy()}),e.renderedItems={},e.makeConditionsBar()),e.beforeRender(j),e.visibleItems=[],b.destroyDeletedRows===!0&&k.each(e.renderedItems,function(a,b){!b||a in e.model.dataMap&&!(b.row&&"__deleted"in b.row)||(b.destroy(),delete e.renderedItems[a])}),k.each(d,function(){var a=this,c=a.Id,d=e.renderedItems[c];d&&!b.doNotCache?(b.resetItemModes===!0&&d.resetMode(),b.refreshFields!==!1&&(m&&m[c]?d.refreshFields(m[c]):d.refreshFields())):d=e.newItem(this,b),d&&("__notdeleted"in a&&d.element.removeClass(p),d.element[("__deleted"in a?"add":"remove")+"Class"](p)),g.push(d.element),e.visibleItems.push(d)}),j.noAutoAppend||(e.contents.children().detach(),e.contents.append(g)),l&&e.attach(),e.renderComplete(j)},showRow:function(a){var b=this,c=!0;return b.conditions&&b.conditions.length&&(c=m.doesRowMeetConditions(a,b.conditions)),c},handleNewRow:function(a,b){var c=this,d={};if(b&&k.extend(d,b),a.Id&&!(a.Id in c.renderedItems)&&c.showRow(a)){var e=c.newItem(a,d);if(c.contents.prepend(e.element),c.render({resetPagination:!0,refreshFields:!1}),e&&"edit"===e.mode){var f=e.element.find(".nx-field > :input:visible:not(.nx-skootable-rowselect):not(.hasDatepicker):not(select)").first();f&&f.focus()}}},handleRowDeletion:function(a){a&&a in this.renderedItems&&this.renderedItems[a].destroy()},newItem:function(a,b){if(a.Id){var c=new d(this,a,{mode:b&&b.editModeForNewItems?"edit":this.mode,selected:b&&b.selected});return c.render(),this.renderedItems[a.Id]=c,c}},attach:function(){this.editor.contents.append(this.element,this.footer)},makeViewSwitcher:function(){var a=this,b=[];k.each(a.views,function(c,d){b.push({value:c,label:d.label||c,icon:d.icon,isSelected:a.currentView===c})});var c=k("<div>").actionSelect({items:b,onItemSelect:function(b){var c=a.currentView;a.currentView=b.value,a.render({doNotCache:!0,previousView:c}),a.personalizationService&&a.personalizationService.updateSettings({_List:{lastViewId:b.value}})}});return c.addClass("nx-viewswitcher")},makeSearchBox:function(){var a=this;if("client"===a.searchMethod&&(a.customFilter=function(b,c){var d=!1,e=b.toLowerCase(),f=function(b,c){var f,g=b.searchOperator,h=a.model.getFieldValue(c,b.id,!0);null!==h&&(f=h.toLowerCase(),d="="===g?f===e:"starts with"===g?m.startsWith(f,e):m.contains(f,e))};return k.each(a.searchFields,function(a,b){return f(b,c),!d}),!d&&a.searchSubFields&&k.each(a.searchSubFields,function(a,b){var e=c[a];e&&e.totalSize&&b.length&&k.each(e.records,function(a,c){return k.each(b,function(a,b){return f(b,c),!d
}),!d})}),d}),a.searchFields||"custom"===a.searchMethod){var b="placeholder"in document.createElement("input"),c=k('<input type="text" class="searchbox" />'),d=a.searchPlaceholderText?m.mergeAsText("model",a.searchPlaceholderText,{createFields:!0,registerFields:!1},a.model):n("search")+" "+a.model.labelPlural;return a.customFilterValue&&c.val(a.customFilterValue),a.searchbox=c,b?c.attr("placeholder",d):(c.addClass("unchanged").val(d),c.focus(function(){c.hasClass("unchanged")&&c.val("").removeClass("unchanged")}).blur(function(){""===c.val()&&c.val(d).addClass("unchanged")})),a.options.delayFilterExecution&&c.on("keyup",function(b){13===b.which&&a.applyFiltersAndSearch()}),m.delayInputCallback(c,function(b,d){a.options.delayFilterExecution&&"undefined"==typeof c.data("originalValue")&&c.data("originalValue",d),"client"===a.searchMethod||"custom"===a.searchMethod?(a.customFilterValue=b,a.render()):a.options.delayFilterExecution?a.showFilterActions():(a.setSearchCondition(b),"remove"!==a.options.emptySearchBehavior||b?a.updateData({message:n("searching"),failmessage:n("error_performing_requested_search"),showerror:!0}):a.model.emptyData())},{dataPropertyName:"curval"}),c}return!1},setSearchCondition:function(a){var b=this;b.model.buildSearchCondition(b.searchConditionName,a,b.searchFields,{tokenize:b.options.tokenizeSearch,useSOSLSearch:b.options.useSOSLSearch,SOSLFields:b.options.SOSLFields})},showFilterActions:function(){return this.applyFiltersBtn.show("fast"),this.cancelFiltersBtn.show("fast"),this.editor.options.showSaveCancel&&this.editor.submitbuttons.hide("fast"),this},hideFilterActions:function(){return this.applyFiltersBtn.hide("fast"),this.cancelFiltersBtn.hide("fast"),this.editor.options.showSaveCancel&&this.editor.submitbuttons.show("fast"),this},applyFiltersAndSearch:function(){var a,b=this,c=b.searchBox;return c&&(a=c.is(".unchanged")?"":c.val(),c.data("originalValue",a),b.setSearchCondition(a)),b.filters&&k.each(b.filters,function(){var a=this.activateFilter;a&&a()}),"remove"!==b.options.emptySearchBehavior||a?b.updateData({message:n("searching"),failmessage:n("error_performing_requested_search"),showerror:!0,successcallback:function(){b.hideFilterActions()}}):(b.model.emptyData(),b.hideFilterActions()),b},cancelFiltersAndSearch:function(){var a=this,b=a.searchBox;return b&&b.val(b.data("originalValue")),a.filters&&k.each(a.filters,function(){this.restoreOriginalValue()}),a.hideFilterActions(),a},updateData:function(a){var b=this;return b.blockUI({message:a.message}),b.model.updateData(!1,{initiatorId:b._GUID}).always(function(){b.unblockUI()}).done(function(){b.editor.clearMessages(),a.successcallback&&a.successcallback()}).fail(function(){b.editor.clearMessages(),b.editor.handleMessages([{message:a.failmessage+(a.showerror&&status?": "+status:""),severity:"ERROR"}])}),b},makeConditionsBar:function(){this.makeFiltersBar()},enableFiltersAndSearch:function(){var a=this;return a.conditionsBar&&a.conditionsBar.find(".nx-conditiontoken").removeClass("unavailable").children("select").multiselect("enable").end().children("input").prop("disabled",!1),"server"===a.searchMethod&&a.searchBox&&a.searchBox.prop("disabled",!1),a},disableFiltersAndSearch:function(){var a=this;return a.conditionsBar&&a.conditionsBar.find(".nx-conditiontoken").addClass("unavailable").children("select").multiselect("disable").end().children("input").prop("disabled",!0),"server"===a.searchMethod&&a.searchBox&&a.searchBox.prop("disabled",!0),a},enableLoadMore:function(){return s(this,!1)},disableLoadMore:function(){return s(this,!0)},blockUI:function(a){var b=this;a=a||{};var c={message:a.message};b.options.blockUICSS&&(c.css=b.options.blockUICSS),b.options.blockOverlayCSS&&(c.overlayCSS=b.options.blockOverlayCSS),b.editor.element.block(c)},unblockUI:function(a){var b=this;a=a||{};var c={};a.failmessage?(b.options.blockUICSS&&(c.css=b.options.blockUICSS),b.options.blockOverlayCSS&&(c.overlayCSS=b.options.blockOverlayCSS),c.timeout=a.timeout||4e3,c.message=a.failmessage,b.editor.element.block(c)):b.editor.element.unblock()},makeFiltersBar:function(){var a,b=this,c=b.options.listFilters;return b.filters=[],c?(a=b.conditionsBar,a.empty(),k.each(c.children(),function(){var c=new l.Filter({xml:k(this),list:b});b.filters.push(c),c&&c.element&&a.append(c.element)}),a):!1},nextPage:function(){this.currentPage++,this.render({refreshFields:!1})},prevPage:function(){this.currentPage--,this.render({refreshFields:!1})},goToPage:function(a){this.currentPage=a,this.render({refreshFields:!1})}},d.prototype={id:function(){return this._GUID},render:function(){var a,b=this,c=b.list,d=c?c.views:!1,e=c.currentView;return c&&d&&e&&(a=d[e],b.element&&b.element.remove(),b.element=k("<"+(a.itemNodeType||"div")+">").addClass("nx-item").data("object",b),a.render(b)),b},refreshFields:function(a){var b=this;return k.each(b.fields,function(){(b.mode!==this.mode||!a||this.id in a)&&(this.mode=b.mode,this.render())}),b},resetMode:function(){return this.mode!==this.defaultMode&&(this.mode=this.defaultMode),this},toggleEdit:function(){return"readonly"!==this.mode&&(this.mode="read"==this.mode?"edit":"read",this.refreshFields()),this},toggleDelete:function(a){var b=this;return b.deleted?b.unMarkForDelete(a):b.markForDelete(a),b},handleUnmarkRowForDeletion:function(a){return!this.row||this.row!==a&&this.row.Id!=a.Id||this.unMarkForDelete(!1),this},handleMarkRowForDeletion:function(a){return!this.row||this.row!==a&&this.row.Id!=a.Id||this.markForDelete(!1),this},unMarkForDelete:function(a){var b=this;return b.element.removeClass("deleted"),b.deleted=!1,a&&b.list.model.undeleteRow(this.row),b},markForDelete:function(a){var b=this;return b.element.addClass("deleted"),b.deleted=!0,a&&b.list.model.deleteRow(b.row),b},registerField:function(a){this.fields.push(a)},unregister:function(){var a=this;return a.list&&a.list.model&&a.list.model.unregisterItem(this),a.fields&&a.fields.length&&k.each(a.fields,function(){this.destroy()}),a},destroy:function(){this.element&&this.element.remove(),this.unregister()}},e.prototype={uid:function(){return this._GUID},register:function(a){return this.model&&this.model.registerField(this,a),this},unregister:function(){var a=this,b=a.options;a.model&&a.model.unregisterField(a,b?b.controllingFields:!1)},calculateReferenceText:function(){return m.calculateReferenceText({model:this.model,row:this.row,template:this.options.template,fieldMetadata:this.metadata})},calculateReferenceMerges:function(a){return a||(a={}),m.calculateReferenceMerges(k.extend(a,{model:this.model,row:this.row,template:this.options.template,fieldMetadata:this.metadata}))},getValidPicklistEntries:function(){var a,b,c,d,e,f=this,g=f.model,h=g.objectName,i=f.item,j=f.metadata,l=j.controllingField,n=j.picklistEntries,o=function(a,b){var c=new sforce.Base64Binary(""),d=c.decode(b),e=d.charCodeAt(a>>3);return 0!==(e&128>>a%8)},p=i&&i.ValidRecordTypeIds?i.ValidRecordTypeIds:[],q=g.getFieldValue(f.row,"RecordTypeId",!0);return q&&-1===k.inArray(q,p)&&p.push(q),p.length&&(b=m.getPicklistEntriesValidForRecordTypes(h,f.id,p)),l&&(d=g.getFieldValue(f.row,l,!0),a=g.getField(l),a&&(b&&b.length?(c={},k.each(b,function(){c[this.value]=1}),b.length=0):b=[],"BOOLEAN"===a.displaytype?e=d?1:0:k.each(a.picklistEntries,function(a,b){b.value===d&&(e=a)}),(e||0===e)&&k.each(n,function(a,d){o(e,d.validFor)&&(!c||d.value in c)&&b.push(d)}))),b?b:n},addOrReplaceConditionsForLookupFiltersToModel:function(b){var c=this,d=[],e=c.options&&c.options.filters?c.options.filters:!1;return b||(b=c.model),e&&e.length&&k.each(e,function(e,f){var g,h,i=c.id+"_"+f.field+"_"+e,j=b.getConditionByName(i);if(j||(j=new a.model.Condition,j.name=i,b.addCondition(j)),j.field=f.field,j.operator=f.operator||"=",j.encloseValueInQuotes=f.encloseValueInQuotes,g=m.isMultiValueOperator(j.operator),"dependent"===f.type)h=c.model.getFieldValue(c.row,f.depfield,!0),"undefined"!=typeof h&&(g?j.values=h&&-1!=h.indexOf(";")?h.split(";"):[h]:j.value=h),j.type="fieldvalue";else if("param"===f.type)h=a.page.params[f.mergeField],"undefined"!=typeof h&&(g?j.values=h&&-1!=h.indexOf(";")?h.split(";"):[h]:j.value=h),j.type="fieldvalue";else if("modelmerge"===f.type){var l=a.model.getModel(f.mergeModel);l&&(g?(j.values=[],k.each(l.data,function(){j.values.push(l.getFieldValue(this,f.mergeField,!0))})):j.value=l.getFieldValue(l.getFirstRow(),f.mergeField,!0),j.type="modelmerge",j.model=f.mergeModel,j.noValueBehavior=f.noValueBehavior)}else j.type=f.type,f.values?j.values=f.values:j.value=f.value,f.mergeField&&(j.mergeField=f.mergeField,j.originalValue=null);d.push(j)}),d},_getUpdateRowOptions:function(){return"edit"===this.mode?{initiatorId:this._GUID}:{}},_toggleModified:function(){var a=this,b=a.element,c=a.model,d=a.row,e=d.Id,f=a.name?a.name:a.id,g=f?c.getFieldValue(d,f,!0):null,h=c.originals[e];return b.removeClass("nx-modified"),(h&&f&&f in h&&h[f]!==g||c.isNewId(e)&&!c.isAggregate)&&b.addClass("nx-modified"),a},render:function(){var a,b,c,d=this,e=d.element,f=d.options,g=d.model,h=d.row,i=d.name?d.name:d.id,j=i?g.getFieldValue(h,i,!0):null,n=f.enableConditionsXML,o="skuid__originalBGColor";if(e.empty(),d._toggleModified(),d.editable||(d.mode="readonly"),"edit"===d.mode&&d.required?e.addClass("required"):e.removeClass("required"),f&&"right"===f.valueHorizontalAlignment&&e.addClass("halignright"),d.metadata&&(c=d.metadata.displaytype),f.type&&f.type in l.fieldRenderers?a=l.fieldRenderers[f.type]:c&&c in l.fieldRenderers&&(a=l.fieldRenderers[c]),b=d.mode,a||(a=l.fieldRenderers.TEXT),!a||b in a||(b="read",b in a||(a=l.fieldRenderers.TEXT)),a[b](d,j),n&&n.length&&n.children().length){var p,q=n.attr("message"),r="skuid__originalTooltip",s=f.valueHorizontalAlignment||"left";m.conditionallyDo(function(){d.element.removeClass("disabled").find(":input").removeAttr("disabled").end().find("input, textarea").each(function(){var a=k(this),b=a.data(o);b&&a.animate({"background-color":b})}).end().find(".ui-button").button("enable").end().find(".ui-multiselect").animate({opacity:"1.0"},function(){k(this).css("opacity","")}).siblings("select").multiselect("enable"),d._toggleModified(),d.labelElement.animate({color:"rgba(0,0,0,1)"}),q&&(p=d.element.data(r),p&&"function"!=typeof p&&p!==q?(d.element.skootip(p),d.element.removeData(r)):d.element.tooltip("instance")&&d.element.tooltip("destroy"))},function(){d.element.removeClass("nx-modified").addClass("disabled").find(":input").attr("disabled","disabled").end().find(".ui-button").button("disable").end().find(".ui-multiselect").animate({opacity:"0.4"}).siblings("select").multiselect("disable"),d.labelElement.animate({color:"rgba(0,0,0,0.3)"});var a=function(){d.element.find("input, textarea").each(function(){var a=k(this);a.data(o)||a.data(o,a.css("background-color")),a.animate({"background-color":"#eee"})})};if(d.element.closest(".nx-page").length?a():k("body").one("pageload",a),q){if(d.element.tooltip("instance")){var b=d.element.tooltip("option","content");b&&"function"!=typeof b&&b!==q&&d.element.data(r,b)}d.element.skootip(q,{position:{my:s+" bottom",at:s+" top-10"},open:function(a,b){var c=k("<div>").addClass("sk-hastooltip").css(s,"0px");b.tooltip.append(c)}})}},n,e,{row:h,model:g})}},destroy:function(){this.unregister(),this.element&&k(this.element).remove()},handleUpdate:function(a,b){this.handleChange(a,b)},handleChange:function(a,b){var c=this,d=c.model,e=c.row,f=c.id,g=c.options,h=g.controllingFields;if(h&&h.length&&b&&-1!==k.inArray(b,h)){var i=!1,j=d.getFieldValue(e,f,!0),l=c.metadata&&-1!==k.inArray(c.metadata.displaytype,["PICKLIST","MULTIPICKLIST"])?c.getValidPicklistEntries():!1;l&&k.each(l,function(a,b){return j===b.value?(i=!0,!1):void 0}),i||d.updateRow(e,f,"",{initiatorId:c.uid()})}c.render()},handleMessage:function(b){var c=b.message;this.editor&&this.editor.options&&this.editor.options.showErrorsInline&&("REQUIRED_FIELD_MISSING"===b.status&&(c="This Field is Required"),this.errorElement||(this.errorElement=k("<div>")),this.editor.options.showErrorsOnHover?(this.errorElement.skootip(a.utils.decodeHTML(c)),this.errorElement.addClass("sk-icon sk-icon-error sk-icon-inline-error nx-field-error-icon"),this.element.append(this.errorElement)):(this.errorElement.addClass("nx-error-inline").text(a.utils.decodeHTML(c)),this.element.prepend(this.errorElement),this.element.addClass("nx-field-error")))}};var t=function(a){if(a&&a.length){var b=[];return a.children().each(function(){var a=k(this),c="false"!==a.attr("enclosevalueinquotes"),d={field:a.attr("field"),type:a.attr("type"),operator:a.attr("operator"),value:a.attr("value"),depfield:a.attr("depfield"),encloseValueInQuotes:c};if("multiple"==d.type){d.values=[];var e=a.children("values");e.length&&e.first().children("value").each(function(){var a=m.getXML(this);a.length>8?(a=m.decodeXML(a.substring(7,a.length-8)),d.values.push(m.adjustValueBasedOnQuotedness(a,c))):d.values.push("")})}else"userinfo"==d.type?d.mergeField=a.attr("userinfotype"):"param"===d.type?d.mergeField=a.attr("value"):"modelmerge"===d.type&&k.extend(d,{mergeField:a.attr("mergefield"),mergeModel:a.attr("model"),noValueBehavior:a.attr("novaluebehavior")});b.push(d)}),b}};f.prototype={unregister:function(){this.editor.unregister()},addSearchField:function(a,b){this.list.addSearchField(a,b)}};var u=function(a,b,c){if(a){var d,e=function(){sforce.console.openPrimaryTab(null,a,!0,p(b))},f=k.Deferred(),g=function(a,b,e){var f={tabsProcessed:0};a&&(f.numTabs=a.length,f.numTabs?k.each(a,function(a,h){sforce.console.getPageInfo(h,function(a){if("resolved"!==e.state())if(a.success){var i=JSON.parse(a.pageInfo);i&&c&&c(i)?(d={id:h},b&&(d.parentTabId=b),e.resolve()):b?sforce.console.getSubtabIds(h,function(a){if(a.success&&a.ids&&a.ids.length){var b=k.Deferred();g(a.ids,!1,b),k.when(b).then(function(){++f.tabsProcessed===f.numTabs&&e.resolve()})}else++f.tabsProcessed===f.numTabs&&e.resolve()}):++f.tabsProcessed===f.numTabs&&e.resolve()}else++f.tabsProcessed===f.numTabs&&e.resolve()})}):e.resolve())};sforce.console.getPrimaryTabIds(function(a){g(a.ids,null,f)}),k.when(f).then(function(){if(d){var a=d.parentTabId?d.parentTabId:d.id;sforce.console.focusPrimaryTabById(a,function(a){a.success?d.parentTabId&&sforce.console.focusSubtabById(d.id,function(){}):e()})}else e()})}},v=function(a,b){u(a,b,function(b){return b&&m.endsWith(b.url,a)})},w=function(a,b){u("/"+a,b,function(b){return b&&(b.objectId===a||a&&18===a.length&&b.objectId===a.substring(0,15))})},x=function(b,c){var d=a.model.getModel(p(c));w(b,d.getNameFieldValueForRow(d.getRowById(b)))},y=function(b,c,d){var e=a.model.getModel(p(c)),f=e?e.registeredFields[p(b)]:null;f&&"REFERENCE"===f.metadata.displaytype&&w(d,d||0===d?o(f.calculateReferenceText()):"")},z={ID:1,STRING:1,TEXT:1,EMAIL:1,PICKLIST:1,MULTIPICKLIST:1,COMBOBOX:1,PHONE:1,URL:1,REFERENCE:1,TEXTAREA:1};k.extend(l,{Editor:c,List:r,Item:d,Field:e,Queue:f,createFieldSet:g,getFieldOptionsFromXML:h,setStatus:i,hideStatus:j,searchableDisplayTypes:z,openConsoleTabForField:y,openConsoleTabForNameField:x,openConsoleTabForUrl:v,openConsoleTabForRow:w,isTouchDevice:b,_createLookupFiltersFromXML:t})}(skuid),function(a){function b(a,b){a.element.html('<div class="nx-fieldtext">'+b+(a.editable&&"readonly"!==a.mode?'<div class="focusbox" tabindex="0"/>':"")+"</div>")}function c(a){var b,c=a.model,d=a.row,e=c.getFieldValue(d,a.id),f=c.objectName,g=c.getNameFieldValueForRow(d);window.sforce&&sforce.interaction&&window.sendCTIMessage&&(b=window.sendCTIMessage),b&&b("/CLICK_TO_DIAL?DN="+encodeURIComponent(e)+(d.Id?"&ID="+d.Id:"")+"&ENTITY_NAME="+f+"&OBJECT_NAME="+encodeURIComponent(g))}function d(a,b){var c=a.metadata;return c&&c.displaytype&&-1!=l.inArray(c.displaytype,y)?b:u(b)}function e(){return window.sforce&&sforce.one?sforce.one:!1}function f(){return window.sforce&&sforce.console&&sforce.console.isInConsole()?sforce.console:!1}function g(){if(!x){if(sforce&&sforce._consoleApiUrl)return a.load.js(sforce._consoleApiUrl).always(function(){x=!0});x=!0}return x?w:void 0}function h(b,c,d){var e=!1,f=[],g=function(b,c,e){var f=l("<div>").addClass("nx-radiowrapper"),g=a.utils.generateGUID(),h=l('<input type="radio" name="'+d.buttonSetName+'">').addClass("nx-radio").prop("id",g).prop("checked",e).prop("disabled","read"===d.mode||"readonly"===d.mode).val(b),i=l("<label>").prop("for",g).addClass("nx-radiolabel").html(u(c)).appendTo(f);return f.append(h,i),f};if(d.makeNoneOption&&f.push(g("",d.noneLabel||t("select_option_none"),!b)),l.each(c,function(a,c){if(c.value){var d=c.value==b&&""!==c.label;d&&!e&&(e=!0),f.push(g(c.value,c.label,d))}}),!e&&(b||"0"===b||"false"===b)){var h=g(b,b,!0);d.makeNoneOption?f.splice(1,0,h):f.unshift(h)}return f}function i(a){a||(a={});var b,c=a.value,d=n.userLocale,e=a.decimalPlaces||0,f=a.decimalsSeparator||d.decimalsSeparator,g=a.thousandsSeparator||d.thousandsSeparator,h=a.prefix||"",i=a.suffix||"";return c||0===c||(c=""),b=""===c?c:h+l.number(c,e,f,g)+i,a.wrapInElement?l("<div>").text(b):b}var j,k,l=a.$,m=a.ui,n=a.utils,o=a.time,p=o.parseSFDate,q=o.parseSFDateTime,r=o.getSFDate,s=o.getSFDateTime,t=a.label.read,u=n.encodeHTML,v=n.startsWith,w=l.Deferred().resolve(),x=!1,y=["BOOLEAN","CURRENCY","DATE","DATETIME","DOUBLE","ID","INTEGER","PERCENT","TIME"],z=new RegExp("[^0-9]+","g");j={AUTOCOMPLETE:{edit:function(a){a=a||{},a.minLength||0===a.minLength||(a.minLength=2);var b,c=l("<input>"),d=function(){b&&(b.removeClass("ui-icon ui-icon-search"),b.addClass("nx-spinner-small"))},e=function(){b&&(b.removeClass("nx-spinner-small"),b.addClass("ui-icon ui-icon-search"))},f=function(){return"function"==typeof a.source?function(b,c){a.source(b,c,d,e)}:a.source};return c.autocomplete({minLength:a.minLength,source:f(),select:a.onChange,focus:a.onFocus,close:a.onClose,appendTo:a.appendTo}).val(a.value),a.menuRenderer&&(c.data("ui-autocomplete")._renderMenu=a.menuRenderer),a.optionRenderer&&(c.data("ui-autocomplete")._renderItem=a.optionRenderer),c.on("keyup",function(b){""===l(this).val()&&9!==b.keyCode&&a.onClear&&a.onClear()}),c.focus(function(){c.autocomplete("widget").css("z-index",parseInt(c.closest(".ui-front").css("z-index"),10)+1)}),c.blur(function(){a.onBlur&&a.onBlur()}),a.parentElem&&(b=l("<div>").addClass("ui-icon ui-icon-search nx-field-reference-search").css({cursor:"pointer"}),a.parentElem.append(b),a.parentElem.is(c)&&c.css("padding-right","22px")),c}},BOOLEAN:{edit:function(a){var b=l('<input type="checkbox">').prop("checked",a.value).change(function(){a.onChange&&a.onChange(l(this).is(":checked")),b.focus()});return b}},CURRENCY:{read:function(b){b||(b={});var c,d,e=n.userLocale,f=n.userInfo.defaultCurrency,g=b.value,h=b.decimalPlaces||0,i=b.decimalsSeparator,j=b.thousandsSeparator,k=b.valueCurrencyCode;return"undefined"==typeof i&&(i=e.decimalsSeparator),"undefined"==typeof j&&(j=e.thousandsSeparator),g||0===g||(g=""),d=""!==g?l.number(g,h,i,j):g,""!==g&&(n.isMultiCurrencyOrganization?(d=k+" "+d,k&&k!=f&&(c=n.convertCurrency(g,k,f),c&&c!=g&&(d+=" ("+f+" "+l.number(c,h,i,j)+")"))):d=a.currency.getSymbol(f)+d),b.wrapInElement?l("<div>").text(d):d}},DOUBLE:{read:i},DATE:{edit:function(a){a=a||{};var b,c=!1;if("SELECTBOXES"===a.renderas);else{b=l("<input>"),b.datepicker({onSelect:function(d,f){var g,h=1,i=f.selectedMonth-0+h+"",j=f.selectedDay+"";1===i.length&&(i="0"+i),1===j.length&&(j="0"+j),g=f.selectedYear+"-"+i+"-"+j,e=b.val(),a.onChange&&a.onChange(g),c=!0,b.focus(),setTimeout(function(){c=!1},200)},beforeShow:function(){return c?!1:void 0},changeMonth:a.showMonthPicker,changeYear:a.showYearPicker,yearRange:a.yearPickerRange}).click(function(){b.datepicker("show")});var d=a.value&&p(a.value);d&&b.datepicker("setDate",d),b.datepicker("widget").click(function(a){a.stopPropagation()});var e=b.val();b.bind("change keyup",function(){var c=l(this).val();if(c!=e){e=c;var d;d=""!==c?r(b.datepicker("getDate")):"",a.onChange&&a.onChange(d)}})}return b}},DATETIME:{edit:function(a){var b,c=l("<div>"),d=l("<input>"),e=!1;a.value&&(b=q(a.value),c.data("usedate",b)),d.datepicker({onSelect:function(b,f){var g,h,i,j=new Date;j.setHours(0,0,0,0),g=o.getLocalDateTime(c.data("usedate")||j),g.setFullYear(f.selectedYear,f.selectedMonth,f.selectedDay),h=o.getRealJSDateTimeFromLocal(g),i=s(h),a.onChange&&a.onChange(i),c.data("usedate",h),e=!0,d.focus(),setTimeout(function(){e=!1},200)},beforeShow:function(){return e?!1:void 0},changeMonth:a.showMonthPicker,changeYear:a.showYearPicker,yearRange:a.yearPickerRange}).click(function(){d.datepicker("show")}),a.value&&b&&d.datepicker("setDate",b),d.datepicker("widget").click(function(a){a.stopPropagation()});var f,g,h,i,j,k=d.val(),m=l("<div>").addClass("nx-dt-timewrapper");d.bind("change keyup",function(){if(l(this).val()!=k){k=l(this).val();var b;if(""!==l(this).val()){var e,f,g=d.datepicker("getDate")||new Date;g.setHours(0,0,0,0),e=o.getLocalDateTime(c.data("usedate")||g),e.setFullYear(g.getFullYear(),g.getMonth(),g.getDate()),f=o.getRealJSDateTimeFromLocal(e),b=s(f),c.data("usedate",f)}else b="",c.data("usedate",null);a.onChange&&a.onChange(b)}}).addClass("nx-dt-dateinput"),f=new Date,f.setHours(0,0,0,0),g=o.getLocalDateTime(b||f);var p,r,t=n.userLocale,u=t.timeFormat,v=o.amPm,w=function(a){var b=p+1<u.length&&u.charAt(p+1)===a;return b&&p++,b},x=!1,y=function(){var b,d=o.getLocalDateTime(c.data("usedate")||new Date);d.setHours((parseInt(h.val(),10)+(j&&"pm"===j.val()?12:0))%24),d.setMinutes(i.val()),b=o.getRealJSDateTimeFromLocal(d),c.data("usedate",b),a.onChange&&a.onChange(s(b))},z=function(a){m.append(l("<span>"+a+"</span>"))},A=function(a,b,c,d){a.append(l("<option "+(c?"selected ":"")+'value="'+b+'">'+(d&&10>b?"0"+b:b)+"</option>"))};for(p=0;p<u.length;p++)if(r=u.charAt(p),x)"'"!==r||w("'")?z(r):x=!1;else{var B,C;switch(r){case"a":if(!j){j=l("<select>");var D=g&&g.getHours()>=12;j.append(l("<option "+(D?"":"selected ")+'value="am">'+v[0]+"</option>")),j.append(l("<option "+(D?"selected ":"")+'value="pm">'+v[1]+"</option>")),j.appendTo(m).on("change",y)}break;case"h":case"K":case"k":case"H":if(!h){h=l("<select>"),C=w(r);for(var E,F="h"===r||"K"===r?12:24,G=0;F>G;G++)E="h"===r&&0===G?12:"k"===r?G-0+1:G,B=!1,g?B=G===(F>12?g.getHours():g.getHours()%12):8===G&&(B=!0),h.append(l("<option "+(B?"selected ":"")+'value="'+G+'">'+(C&&10>E?"0"+E:E)+"</option>"));h.appendTo(m).on("change",y)}break;case"m":if(!i){i=l("<select>"),C=w("m");var H,I=a.minuteIncrement||5,J=g?g.getMinutes():0,K=g&&J%I===0;for(H=0;60>H;H+=I)B=H===J,!K&&H>J&&(A(i,J,!0,C),K=!0),A(i,H,B,C);i.appendTo(m).on("change",y)}break;case"'":w("'")?z("'"):x=!0;break;default:z(u.charAt(p))}}return t&&t.showTimeBeforeDate?c.append(m,d):c.append(d,m),c}},INTEGER:{read:function(a){return a||(a={}),l.extend(a,{decimalPlaces:0}),i(a)}},MULTIPICKLIST:{edit:function(a){a.valueDelimiter||(a.valueDelimiter=";");var b,c=a.value,d=a.checkboxSetName,e=a.entries,f=a.maxSelected,g=a.valueDelimiter,h=a.selectedList||3,i=a.selectedText||t("number_selected"),j=a.noneSelectedText||t("none_selected"),k=!1;c||(c="");var m,n=c.split(g),o=f&&n.length>=f,p=a.element||l("<div>"),q=c;if("CHECKBOXES"===a.renderas)p.addClass("nx-fieldtext").css("padding","0px"),b=function(){if(!k){k=!0;var b,c=p.find('input[type="checkbox"]'),d=c.filter(function(){return l(this).prop("checked")}).map(function(){return this.value}).get();if(f)if(d.length>=f){b=[];var e=0;c.each(function(){var a=l(this);if(a.prop("checked")){if(e++<f)return b.push(a.val()),!0;a.prop("checked",!1)}a.prop("disabled",!0)})}else c.each(function(){l(this).prop("disabled")&&l(this).prop("disabled",!1)});m=(f&&b?b:d).join(g),a.onChange&&a.onChange(m,q),q=m,k=!1}},l.each(e,function(a,b){if(b.value){var c="";-1!==l.inArray(b.value,n)&&""!==b.value&&(c='checked="yes"');var e=l("<div>").addClass("nx-checkboxwrapper"),f=l("<input "+c+' type="checkbox">').val(b.value).prop("id","mscb_"+d+"_"+b.value).addClass("nx-checkbox").appendTo(e),g=l("<div>").addClass("nx-checkboxlabel").appendTo(e);o&&!c&&f.prop("disabled",!0),g.append(l("<label>").html(u(b.label)).prop("for","mscb_"+d+"_"+b.value)),p.append(e)}}),p.off(),p.on("change","input",function(){b()});else{var r=l('<select multiple="multiple">').appendTo(p);l.each(e,function(a,b){var c,d="";-1!==l.inArray(b.value,n)&&""!==b.label&&(d='selected="selected"'),c=l("<option "+d+">").attr("value",b.value).text(b.label),r.append(c)}),b=function(){if(!k){k=!0;var b,c=r.multiselect("getChecked").map(function(){return this.value}).get();if(f){var d=r.multiselect("widget").find('input[type="checkbox"]');if(c.length>=f){b=[];var e=0;d.each(function(){var a=l(this);if(a.prop("checked")){if(e++<f)return b.push(a.val()),!0;this.click()}a.prop("disabled",!0).closest("label").addClass("ui-state-disabled")})}else r.multiselect("widget").find("input:disabled").each(function(){l(this).prop("disabled",!1).closest("label").removeClass("ui-state-disabled")})}m=(f&&b?b:c).join(g),a.onChange&&a.onChange(m,q),q=m,k=!1}},r.multiselect({selectedText:i,noneSelectedText:j,checkAllText:t("check_all"),uncheckAllText:t("uncheck_all"),selectedList:h,position:a.position,autoOpen:!1,close:function(){l(this).parent().find("button.ui-multiselect").removeAttr("tabindex").focus(),a.onClose&&a.onClose.call(this)},click:function(a,c){b(a,c)},open:function(){o&&r.multiselect("widget").find("input:not(:checked)").each(function(){l(this).prop("disabled",!0).closest("label").addClass("ui-state-disabled")}),l(this).parent().find("button.ui-multiselect").attr("tabindex","-1")},create:function(){a.onCreate&&a.onCreate.call(this)}}).on("multiselectcheckall multiselectuncheckall",function(a,c){b(a,c)});var s=r.data("echMultiselect")||r.data("ech-multiselect");s&&s.menu&&s.menu.on("focusin",function(a){a.stopPropagation()}),e.length>5&&r.multiselectfilter({label:"",placeholder:t("enter_keywords")})}return p}},PERCENT:{read:function(a){return a||(a={}),l.extend(a,{suffix:"%"}),i(a)}},PICKLIST:{edit:function(a){var b;if("RADIO_BUTTONS"===a.renderas){b=l("<div>").addClass("nx-fieldtext").css("padding","0px");var c=h(a.value,a.entries,{makeNoneOption:!a.required||a.addNoneOption,mode:a.mode,buttonSetName:a.buttonSetName,noneLabel:a.noneLabel});l.each(c,function(){b.append(this)}),b.off("change.skuid"),b.on("change.skuid","input",function(){a.onChange&&a.onChange(b.find("input:checked").first().val())})}else{b=l("<select>"),(!a.required||a.addNoneOption)&&b.append(l("<option>").attr("value","").text(a.noneLabel||t("select_option_none")));var d=!1,e=a.value||""===a.value,f={},g=a.defaultValue,i=!1;a.entries&&l.each(a.entries,function(a,c){var d=c.value,e=l("<option>").attr("value",d).text(c.label);c.disabled===!0&&e.prop("disabled",!0),f[d]=e,b.append(e)}),e&&a.value in f&&(d=!0),e&&d?b.val(a.value):"undefined"!=typeof g&&g in f&&(b.val(g),i=!0);var j=b.val();b.on("change.skuid",function(){a.onChange&&a.onChange(b.val(),j),j=b.val()}),!a.required||e&&d||(i=!0),i&&a.onChange&&b.val()&&a.onChange(b.val())}return b}},TEXT:{edit:function(a){var b=a.inputType,c=a.inputMode,d=a.maxLength,e=a.onChange,f=l("<input "+(b?' type="'+b+'"':"")+(c?' inputmode="'+c+'"':"")+(d?' maxlength="'+d+'"':"")+">").val(a.value);return n.delayInputCallback(f,function(a,b){e&&e(a,b)}),f}},TEXTAREA:{edit:function(a){var b=a.onChange,c=a.displayRows,d=l("<div>"),e=l("<textarea>").val(a.value).appendTo(d);return c?e.attr("rows",c).css({height:"100%"}):e.flexText(),l.support.leadingWhitespace||e.addClass("ie8-textarea"),n.delayInputCallback(e,function(a,c){b&&b(a,c)}),d}},RICHTEXT:{edit:function(b){function c(){function c(){if(!d){h.off("click.sk-richtext focus.sk-richtext"),d=a.CKEDITOR.inline(h[0],g);var c=2,e=function(a){b.onChange&&b.onChange(a,c)};d.on("change",function(){e(d.getData())}),d.on("mode",function(){c=2===c?!1:!c}),d.on("key",function(){c&&e(d.getData())}),b.onCreated&&b.onCreated(d),b.afterInit&&b.afterInit({ckInstance:d})}}var f=b.config||{};f instanceof Array&&(f=l.extend.apply(this,l.map(f,function(a){return"function"==typeof a&&(a=a()),a})));var g={allowedContent:!0,disallowedContent:"style script iframe",toolbar:"FieldEditor"};"function"==typeof f?f(g):g=l.extend(g,f);var h=l('<div contenteditable="true" class="nx-richtext-input">').on("click.sk-richtext focus.sk-richtext",c);b.value&&h.html(b.value),e.empty().append(h),b.initialize._initializeWhenReady===!0?(c(),b.initialize=function(){}):b.initialize=c}b||(b={});var d,e=l("<div>").append(l('<div class="nx-spinner">'));return b.initialize=function(){b.initialize._initializeWhenReady=!0},a.utils.loadRichTextApi(c),e}},COLOR:{read:function(a){a||(a={});var b=a.color||a.value;return l('<div class="sk-colorpicker"><div class="sk-colorpicker-wrapper"><div class="nx-field">'+b+'</div><div><div class="sk-colorpicker-preview-wrapper sk-transparency-background"><div class="sk-colorpicker-preview" style="background-color:'+b+'; cursor:default"></div></div></div></div></div>')},edit:function(a){function b(a){f.trigger("sk-colorselected",[a])}function c(a){"undefined"==typeof a&&(a=d),f.trigger("sk-colorpreview",[a])}a||(a={});var d=a.color||a.value||"#000000",e=a.onChange,f=l('<div class="sk-colorpicker"><div class="sk-colorpicker-wrapper"><div class="nx-field"><input></div><div><div class="sk-colorpicker-preview-wrapper sk-transparency-background"><div class="sk-colorpicker-preview"></div></div></div></div></div>'),g=f.find("input").val(d),h=f.find(".sk-colorpicker-preview").css({"background-color":d}),i={black:"#000000",white:"#ffffff",red:"#ff0000",orange:"#ffa500",yellow:"#ffff00",green:"#008000",blue:"#0000ff",purple:"#800080",violet:"#ee82ee",rebeccapurple:"#663399"},j=a.colorSwatches||["transparent","rgba(0%,0%,0%,0.5)","	","red","orange","yellow","green","blue","purple","violet","#663399","\n","\n","white","black","	","#c0504d","#f79646","#eeece1","#9bbb59","#1f497d","#4f81bd","#4bacc6","#8064a2","\n","#f2f2f2","#7f7f7f","	","#f2dcdb","#fdeada","#ddd9c3","#ebf1dd","#c6d9f0","#dbe5f1","#dbeef3","#e5e0ec","\n","#d8d8d8","#595959","	","#e5b9b7","#fbd5b5","#c4bd97","#d7e3bc","#8db3e2","#b8cce4","#b7dde8","#ccc1d9","\n","#bfbfbf","#3f3f3f","	","#d99694","#fac08f","#938953","#c3d69b","#548dd4","#95b3d7","#92cddc","#b2a2c7","\n","#a5a5a5","#262626","	","#953734","#e36c09","#494429","#76923c","#17365d","#366092","#31859b","#5f497a","\n","#7f7f7f","#0c0c0c","	","#632423","#974806","#1d1b10","#4f6128","#0f243e","#244061","#205867","#3f3151"];n.delayInputCallback(g,function(a){b(a)}),f.on("sk-colorpreview",function(a,b){h.css({"background-color":b||d})}),f.on("sk-colorselected",function(a,b){if(b!==d){var c=d;d=b,g.val()!==d&&g.val(d),h.css({"background-color":d}),e&&e(d,c)}});var k=a.popup=function(){function a(){u||(u=h().appendTo(document.body),k(),l(window).on("resize.sk-colorpicker scroll.sk-colorpicker",k),l(document.body).on("mousedown.sk-colorpicker",function(a){var b=a.clientX,c=a.clientY,d=u.offset(),f=d.left-l(window).scrollLeft(),g=d.top-l(window).scrollTop(),h=f+u.outerWidth(),i=g+u.outerHeight();(f>b||b>h||g>c||c>i)&&e()}).on("keyup.sk-colorpicker",function(a){27===a.keyCode&&e()}))}function e(){u&&(f.trigger("sk-popup-hide"),l(window).off("resize.sk-colorpicker scroll.sk-colorpicker"),l(document.body).off("mousedown.sk-colorpicker keyup.sk-colorpicker"),u.fadeOut(function(){u.remove(),u=null,c()}))}function h(){var a=l('<div class="sk-colorpicker-popup ui-widget ui-widget-content ui-corner-all"><div class="sk-colorpicker-popup-contents"><div class="sk-colorpicker-popup-panel sk-swatch-panel"></div><div class="sk-colorpicker-popup-panel sk-gradient-panel"></div></div></div>').on("click",function(a){a.stopPropagation()}),b=a.find(".sk-swatch-panel"),c=a.find(".sk-gradient-panel");return m({colors:j,panel:b}),n({panel:c}),a}function k(){u&&u.position({my:"left top",at:"left bottom",of:g,collision:"fit flip"})}function m(a){for(var d,f,g,h=a.colors.slice(0),i=a.panel,j=function(a){return function(){c(a)}},k=function(){return function(){c()}},m=function(a){return function(){b(a)}},n=function(a){return function(){b(a),e()}},o=l("<div>").addClass("sk-colorpicker-table").appendTo(i),p=0;h.length>0;){for(f=l("<div>").addClass("sk-colorpicker-row sk-row-"+p).appendTo(o),d=0;h.length>0;d++){var q,r=h.shift();
if("\n"===r)break;g=l("<div>").addClass("sk-colorpicker-cell sk-cell-"+d).appendTo(f),"	"!==r&&(g.addClass("sk-transparency-background"),q=r,l("<div>").css({"background-color":q}).addClass("sk-colorpicker-swatch").on("mouseover",j(q)).on("mouseout",k()).on("click",m(q)).on("dblclick",n(q)).appendTo(g))}p++}}function n(a){function g(a){var b="hsl("+a.hue+",100%,50%)",c={"background-color":b};n.css(c),x.find(".layer1").css(c),y.find(".layer1").css(c),z.find(".layer2").css({"background-image":"linear-gradient(to bottom, "+b+", rgba(204, 154, 129, 0))"})}function h(a){m=!0,w.slider("value")!==k.hue&&w.slider("value",360-k.hue),x.slider("value")!==k.sat&&x.slider("value",k.sat),y.slider("value")!==k.lum&&y.slider("value",k.lum),z.slider("value")!==k.alpha&&z.slider("value",k.alpha),m=!1,i({supressEventNotification:a})}function i(a){if(!m){var c=Math.round(360-w.slider("value")),d=Math.round(x.slider("value")),e=Math.round(y.slider("value")),f=z.slider("value");k.hue!==c&&(k.hue=c),k.sat!==d&&(k.sat=d),k.lum!==e&&(k.lum=e),k.alpha!==f&&(k.alpha=f),g(k),a.supressEventNotification!==!0&&b(s(q(k.hue/360,k.sat/100,k.lum/100),{alpha:k.alpha}))}}var j=a.panel,k=p(r(t(d))),m=!1,n=l('<div class="sk-colorpicker-gradient"><div class="sk-colorpicker-gradient-layer1"><div class="sk-colorpicker-gradient-layer2"></div></div></div>').appendTo(j).on("mousemove",function(a){c(o(k,a.offsetX,a.offsetY))}).on("mouseout",function(){c()}).on("click",function(a){b(o(k,a.offsetX,a.offsetY)),h()}).on("dblclick",function(a){b(o(k,a.offsetX,a.offsetY)),e()}),u=l('<div class="sk-colorpicker-hsl"><div class="sk-hsl-preview"></div><div class="sk-colorpicker-slider sk-hsl-h"></div><div class="sk-colorpicker-slider sk-hsl-s"></div><div class="sk-colorpicker-slider sk-hsl-l"></div><div class="sk-colorpicker-slider sk-alpha"></div></div>').appendTo(j),v=u.find(".sk-hsl-preview").css("background-color",d),w=u.find(".sk-hsl-h").slider({orientation:"vertical",min:0,max:360,step:1,slide:i,change:i}),x=u.find(".sk-hsl-s").slider({orientation:"vertical",min:0,max:100,step:1,slide:i,change:i}).append(l('<div class="layer1"><div class="layer2"></div></div>')),y=u.find(".sk-hsl-l").slider({orientation:"vertical",min:0,max:100,step:1,slide:i,change:i}).append(l('<div class="layer1"><div class="layer2_1"></div><div class="layer2_2"></div></div>')),z=u.find(".sk-alpha").slider({orientation:"vertical",min:0,max:1,step:.01,slide:i,change:i}).append(l('<div class="layer1 sk-transparency-background"><div class="layer2"></div></div>'));l.each(new Array(6),function(a){w.append(l('<div class="layer1_'+(a+1)+'">'))}),h(!0),f.on("sk-colorselected.gradientbox",function(a,b){v.css("background-color",b),k=p(r(t(b),k)),h(!0)}).on("sk-popup-hide",function(){f.off("sk-colorselected.gradientbox")})}function o(a,b,c){var d=a.hue/360,e=b/150,f=(1-.5*(b/150))*((150-c)/150),g=s(q(d,e,f),{alpha:a.aplha});return a.sat=Math.round(100*e),a.lum=Math.round(100*f),g}function p(a){return{hue:Math.round(360*a[0]),sat:Math.round(100*a[1]),lum:Math.round(100*a[2]),alpha:l.isNumeric(a[3])?a[3]:1}}function q(a,b,c){function d(a,b,c){return 0>c&&(c+=1),c>1&&(c-=1),1/6>c?a+6*(b-a)*c:.5>c?b:2/3>c?a+(b-a)*(2/3-c)*6:a}var e,f,g;if(0===b)e=f=g=c;else{var h=.5>c?c*(1+b):c+b-c*b,i=2*c-h;e=d(i,h,a+1/3),f=d(i,h,a),g=d(i,h,a-1/3)}return[Math.min(255,Math.max(0,Math.round(255*e))),Math.min(255,Math.max(0,Math.round(255*f))),Math.min(255,Math.max(0,Math.round(255*g)))]}function r(a,b,c,d){var e=1;a instanceof Array&&(d=b,e=a[3],c=a[2],b=a[1],a=a[0]),d||(d={hue:0,sat:0}),a/=255,b/=255,c/=255;var f,g,h=Math.max(a,b,c),i=Math.min(a,b,c),j=(h+i)/2;if(h==i)f=g=0;else{var k=h-i;switch(g=j>.5?k/(2-h-i):k/(h+i),h){case a:f=(b-c)/k+(c>b?6:0);break;case b:f=(c-a)/k+2;break;case c:f=(a-b)/k+4}f/=6}return 0===g&&(f=d.hue/360),(0===j||1===j)&&(g=d.sat/100),[f,g,j,e]}function s(a,b){var c=a[0],d=a[1],e=a[2],f=a[3];return l.isNumeric(f)||(f=l.isNumeric(b.alpha)?b.alpha:1),1>f||b.ignoreAlpha===!0?"rgba("+c+","+d+","+e+","+f+")":"#"+("0"+c.toString(16)).slice(-2)+("0"+d.toString(16)).slice(-2)+("0"+e.toString(16)).slice(-2)}function t(a){var b,c,d,e;if(a in i&&(a=i[a]),/^\s*#/.test(a))return a=(/[a-f0-9]{6}/.exec(a)||[""])[0],b=parseInt(a.slice(0,2),16)||0,c=parseInt(a.slice(2,4),16)||0,d=parseInt(a.slice(4,6),16)||0,[b,c,d,1];if(/^\s*rgb/i.test(a)){for(var f,g=[],h=/(\d*\.)?\d+%?/g;f=(h.exec(a)||[""])[0];)g.push(parseFloat(-1===f.indexOf("%")?f:2.55*f.replace("%","")));return b=Math.round(g[0]),c=Math.round(g[1]),d=Math.round(g[2]),e=l.isNumeric(g[3])?g[3]:1,[b,c,d,e]}return[0,0,0,1]}var u=null;return{show:a,hide:e}}();return h.on("click",k.show),f}}},k={TEXT:{read:function(a,c){g().done(function(){c||0===c||(c=""),n.isString(c)||(c=""+c);var d,g,h,i,j=a.options.maxDisplayCharacters,k=a.metadata,m=k&&"URL"===k.displaytype,o=a.row,p=e(),q=f(),r=["FirstName","LastName","Company"],s=!1;m&&(!c||n.contains(c,"//")||v(c,"/")||(c="http://"+c),j||(j=40)),g=c,j&&(j-=0),!isNaN(j)&&j>0&&j<c.length&&(c=c.substring(0,j)+"..."),!a.model.isSingleRow()&&n.userInfo.isAuthenticated&&(k&&k.nameField||-1!==l.inArray(a.id,r))&&!a.model.isNewId(o.Id)&&-1===a.id.indexOf(".")?(g=c,c='<a href="',c+=p?'#" onclick="sforce.one.navigateToSObject(\''+o.Id+"');":q?'#" onclick="skuid.ui.openConsoleTabForNameField(\''+o.Id+"','"+u(a.model.id)+"');":n.getSafeRelativeUrl("/"+o.Id),c+='">'+u(g)+"</a>",s=!0):m&&(h=c&&v(c,"/"),i=u(g),c=p?'<a href="#" onclick="sforce.one.navigateToURL(\''+i+"');\">"+u(c)+"</a>":q&&h?'<a href="#" onclick="skuid.ui.openConsoleTabForUrl(\''+i+"','"+i+"');\">"+u(c)+"</a>":'<a href="'+i+'"'+(q?' target="blank"':"")+">"+u(c)+"</a>",s=!0),d=(k?k.htmlFormatted:!1)?n.removeScriptTags(c):n.nl2br(s?c:u(c)),b(a,d)})},readonly:function(a,b){k.TEXT.read(a,b)},edit:function(a,b,c){b||0===b||(b="");var d={inputType:c,value:b,onChange:function(b){a.model.updateRow(a.row,a.id,b,a._getUpdateRowOptions())}};a.element.append(j.TEXT.edit(d),l("<div>").addClass("sk-focusbar"))}},TEXTAREA:{read:function(a,b){a._ckInstance&&(a._ckInstance.destroy(),delete a._ckInstance),k.TEXT.read(a,b)},readonly:function(a,b){k.TEXTAREA.read(a,b)},edit:function(a,b){var c=a.options||{};if(b||0===b||(b=""),a.metadata.htmlFormatted)a.disableBlur=!0,a.element.append(j.RICHTEXT.edit({value:b,config:[{uiColor:"#DDDDDD"},c.ckEditorConfig||{}],onChange:function(b){a.model.updateRow(a.row,a.id,b,a._getUpdateRowOptions())},afterInit:function(b){a._ckInstance=b.ckInstance}}));else{var d=c.displayRows;a.element.append(j.TEXTAREA.edit({value:b,displayRows:d,onChange:function(b){a.model.updateRow(a.row,a.id,b,a._getUpdateRowOptions())}}))}}},DOUBLE:{read:function(a,c,d,e){var f,g=a.metadata,h=a.options.decimalPlaces;h||"0"===h?f=parseInt(h,10):g&&g.scale&&(f=g.scale),f&&n.isNumber(f)||(f=0),b(a,j.DOUBLE.read({value:c,decimalPlaces:f,prefix:d,suffix:e}))},readonly:function(a,b){k.DOUBLE.read(a,b)},edit:function(a,b){b||0===b||(b="");var c=n.userLocale,d=l('<input inputmode="numeric">').val(""!==b?l.number(b,a.metadata&&a.metadata.scale?a.metadata.scale:0,c.decimalsSeparator,c.thousandsSeparator):b);n.delayInputCallback(d,function(b){var d=b.split(c.decimalsSeparator),e="-"===d[0].charAt(0);b=(e?"-":"")+d[0].replace(z,""),d.length>1&&(b+=c.decimalsSeparator+d[1].replace(z,"")),b=b.replace(c.decimalsSeparator,".");var f=a.metadata.displaytype;b&&(b="INTEGER"===f?parseInt(b,10):parseFloat(b)),a.model.updateRow(a.row,a.id,b,a._getUpdateRowOptions())}),a.element.append(d)}},INTEGER:{read:function(a,c){b(a,j.INTEGER.read({value:c}))},readonly:function(a,b){k.INTEGER.read(a,b)},edit:function(a,b){k.DOUBLE.edit(a,b)}},PERCENT:{read:function(a,b){k.DOUBLE.read(a,b,"","%")},readonly:function(a,b){k.PERCENT.read(a,b)},edit:function(a,b){k.DOUBLE.edit(a,b)}},CURRENCY:{read:function(a,c){var d,e,f=a.metadata,g=a.options?a.options.decimalPlaces:null,h=a.row;g||"0"===g||0===g?d=parseInt(g,10):f&&f.scale&&(d=f.scale),d&&n.isNumber(d)||(d=0),""!==c&&h&&n.isMultiCurrencyOrganization&&(e=n.getRowCurrency({row:h,model:a.model,field:a.id})),b(a,j.CURRENCY.read({value:c,decimalPlaces:d,valueCurrencyCode:e}))},readonly:function(a,b){k.CURRENCY.read(a,b)},edit:function(a,b){k.DOUBLE.edit(a,b)}},BOOLEAN:{read:function(a,b){var c=l("<div>").addClass("nx-fieldtext").css("padding","0px"),d=l('<input type="checkbox">').prop({checked:b,disabled:"true"});c.append(d),a.editable&&"readonly"!==a.mode&&c.append('<div class="focusbox" tabindex="0"/>'),a.element.append(c)},readonly:function(a,b){k.BOOLEAN.read(a,b)},edit:function(a,b){"true"===b&&(b=!0),a.element.append(j.BOOLEAN.edit({value:b,onChange:function(b){a.model.updateRow(a.row,a.id,b,{initiatorId:a._GUID})}}))}},DATE:{read:function(a,c){b(a,o.makeFormattedDate(c))},readonly:function(a,b){k.DATE.read(a,b)},edit:function(a,b){var c=a.options;a.element.append(j.DATE.edit({value:b,renderas:c.type,showMonthPicker:c.showMonthPicker,showYearPicker:c.showYearPicker,yearPickerRange:c.yearPickerRange,onChange:function(b){a.model.updateRow(a.row,a.id,b,a._getUpdateRowOptions())}}))}},DATETIME:{read:function(a,c){b(a,o.makeFormattedLongDateTime(c))},readonly:function(a,b){k.DATETIME.read(a,b)},edit:function(a,b){var c=a.options;a.element.append(j.DATETIME.edit({value:b,showMonthPicker:c.showMonthPicker,showYearPicker:c.showYearPicker,yearPickerRange:c.yearPickerRange,minuteIncrement:c.minuteIncrement,onChange:function(b){a.model.updateRow(a.row,a.id,b,a._getUpdateRowOptions())}}))}},EMAIL:{read:function(a,c){c||0===c||(c=""),""!==c&&(c=u(c),c='<a href="mailto:'+c+'">'+c+"</a>"),b(a,c)},edit:function(a,b){k.TEXT.edit(a,b,"email")},readonly:function(a,b){k.EMAIL.read(a,b)}},LOCATION:{read:function(a,c){var d,e,f,g,h=".",i="DECIMAL",j="",k=a.options.type||a.metadata.type||i;c&&(e=c.latitude,f=c.longitude,k===i?(g=function(a){var b=(a+"").split(h);return l.number(a,b.length>1?b[1].length:1,h,"")+""},e=g(e),f=g(f),e&&(j+=e),j+=" ",f&&(j+=f)):(d="&#39;",g=function(a,b){var c=0>a,e=Math.abs(a),f=Math.floor(e),g=60*(e-f),h=Math.floor(g),i=Math.round(60*(g-h));return f+"&deg;"+h+d+i+d+d+(b?c?"S":"N":c?"W":"E")},e=g(e,!0),f=g(f),e&&(j+=e),j+=" ",f&&(j+=f))),b(a,j)},edit:function(b,c){var d,e,f=b.row,g=b.model,h=b.id,i=h.substring(0,h.length-1),j=i+"Latitude__s",k=i+"Longitude__s";c&&(d=c.latitude,e=c.longitude);var l=new a.ui.Field(f,g,null,{fieldId:j}),m=new a.ui.Field(f,g,null,{fieldId:k});l.render(),m.render(),b.element.append(l.element,m.element)},readonly:function(a,b){k.LOCATION.read(a,b)}},PHONE:{read:function(a,d){if(window.sforce&&d&&m.showClick2Dial){k.TEXT.read(a,d);var e=m.click2Dial;e||(e=c),a.element.css("white-space","nowrap").append(l('<div class="sk-click2dial-wrapper">').append(l('<span class="ui-icon sk-icon sk-icon-phone inline">').attr("title","Click to dial")).on("click.skuid",function(){e(a)}).css("cursor","pointer")),a.element.children().css({display:"inline-block"})}else{var f;d||"0"===d?f=d.replace(/\D+/g,""):(d="",f=!1),""!==d&&(d=u(d),(f||"0"===f)&&(d='<a href="tel:'+f+'">'+d+"</a>")),b(a,d)}},edit:function(a,b){k.TEXT.edit(a,b,"tel")},readonly:function(a,b){k.PHONE.read(a,b)}},PICKLIST:{read:function(a,c){var d=a.getValidPicklistEntries();if("RADIO_BUTTONS"===a.options.type){var e=l("<div>").addClass("nx-fieldtext").css("padding","0px"),f=h(c,d,{makeNoneOption:!a.required||a.options.addNoneOption,mode:a.mode,buttonSetName:a.id+"_"+a._GUID});l.each(f,function(){e.append(this)}),a.editable&&"readonly"!==a.mode&&e.append('<div class="focusbox" tabindex="0"/>'),a.element.append(e)}else l.each(d,function(){return this.value==c?(this.label&&(c=this.label),!1):void 0}),b(a,c?u(c):"")},readonly:function(a,b){k.PICKLIST.read(a,b)},edit:function(a,b){a.element.append(j.PICKLIST.edit({addNoneOption:a.options.addNoneOption,buttonSetName:a.id+"_"+a._GUID,entries:a.getValidPicklistEntries(),mode:a.mode,noneLabel:a.options.noneLabel,onChange:function(b){a.model.updateRow(a.row,a.id,b,{initiatorId:a._GUID})},renderas:a.options.type,required:a.required,value:b}))}},MULTIPICKLIST:{read:function(a,b,c){c||(c=";");var d=l("<div>").addClass("nx-fieldtext"),e=a.getValidPicklistEntries(),f=b?b:"",g=f.split(c);if("CHECKBOXES"===a.options.type)d.css("padding","0px"),l.each(e,function(a,b){if(b.value){var c="";-1!==l.inArray(b.value,g)&&""!==b.value&&(c='checked="yes"');var e=l("<div>").addClass("nx-checkboxwrapper");e.append(l("<input "+c+' type="checkbox" value="'+b.value+'">').addClass("nx-checkbox").prop("disabled",!0)),e.append(l("<div>"+u(b.label)+"</div>").addClass("nx-checkboxlabel")),d.append(e)}});else if(f){var h={},i=[];l.each(e,function(a,b){h[b.value]=b.label}),l.each(g,function(){i.push(h[this]||this)}),d.html(u(i.join(", ")))}else d.html("");a.editable&&"readonly"!==a.mode&&d.append('<div class="focusbox" tabindex="0"/>'),a.element.append(d)},readonly:function(a,b,c){k.MULTIPICKLIST.read(a,b,c)},edit:function(a,b,c){"CHECKBOXES"!==a.options.type&&(a.disableBlur=!0),a.element.append(j.MULTIPICKLIST.edit({value:b,defaultValue:a.metadata.defaultValue,entries:a.getValidPicklistEntries(),renderas:a.options.type,onChange:function(b){a.model.updateRow(a.row,a.id,b,{initiatorId:a._GUID})},valueDelimiter:c,checkboxSetName:a.id+"_"+a._GUID,maxSelected:a.options.maxSelected}))}},ARRAY:{read:function(a,b,c){c||(c={});var d,e,f=l("<div>").addClass("nx-fieldtext").appendTo(a.element),g=a.model.getFieldValue(a.row,a.id,!0),h=a.options.delimiter,i=c.dataPath||a.metadata.dataPath;h||(h=""),g&&(d=g,i&&(d=n.getObjectProperty(d,i)),e=d.length,l.each(d,function(b){var c=a.model.mergeRow(this,a.options.template,{allowHTML:a.options&&a.options.allowHTML,registerFields:!1});c.css("display","inline"),f.append(c),b+1!==e&&f.append("<span>"+h+"</span>")})),a.element.append(f)},readonly:function(a,b){k.ARRAY.read(a,b)}},CHILDREL:{read:function(a,b){k.ARRAY.read(a,b,{dataPath:a.metadata.dataPath||"records"})},readonly:function(a,b){k.CHILDREL.read(a,b)}},COMBO:{read:function(a){var b=l("<div>").addClass("nx-fieldtext").appendTo(a.element),c=a.options;b.append(a.model.mergeRow(a.row,c.template,{allowHTML:c&&c.allowHTML,registerFields:!1})),a.editable&&"readonly"!==a.mode&&b.append('<div class="focusbox" tabindex="0"/>'),a.element.append(b).off("dblclick.skuid mouseenter.skuid mouseleave.skuid").css("cursor","auto")},readonly:function(a,b){k.COMBO.read(a,b)},edit:function(a,b){k.COMBO.read(a,b);var c,d=a.options,e=a.element,f=e.find(".focusbox").prop("tabindex","-1"),g=l('<input type="text">').addClass("nx-visuallyhidden");f.before(g),c=function(){var b,c,h,i="custompopup"===d.editModeBehavior,j=[{text:t("done"),icons:{primary:"sk-icon-save sk-icon"},click:function(){l(this).dialog("close")}}],k=function(){l(this).click().find(":input").first().focus()},o=function(){var a=e.find("input"),b=e.find(".focusbox");a.length&&a[0]===g[0]&&a.attr("preventaction","true"),b.length&&b[0]===f[0]&&b.attr("preventaction","true")},p=function(){var a=e.find("input"),b=e.find(".focusbox");a.length?a[0]!==g[0]&&a.attr("preventaction","true").focus():b[0]!==f[0]&&b.attr("preventaction","true").focus(),setTimeout(function(){a.removeAttr("preventaction"),b.removeAttr("preventaction")},100)};i?h=n.createPopupFromPopupXML(d.editModePopupXML,a,{open:k,close:p,beforeClose:o,buttons:j,modal:!0,resizable:!0}):(b=a.model.getRowMergeResult(a.row,d.template),c=b.fields,h=l('<div title="'+d.label+'" class="nx-editor"/>'),h.append(m.createFieldSet(c,{editor:a.editor})),h.dialog({resizable:!0,modal:!0,width:450,open:k,beforeClose:o,close:function(){p(),h.dialog("destroy").remove()},buttons:j})),a.editor.editModePopup=h},g.on("focus.skuid",function(){var a=l(this);a.attr("preventaction")?a.removeAttr("preventaction"):c()}),e.on("mouseenter.skuid mouseleave.skuid","> .nx-fieldtext",function(a){"mouseenter"===a.type?l(this).append(l("<div>").addClass("nx-edithover sk-icon-edit sk-icon inline").click(function(a){c(),a.stopPropagation()})):l(this).find("div.nx-edithover").remove()}).on("dblclick.skuid",c).css("cursor","pointer")}},CUSTOM:{read:function(b,c){var e=a.snippet.get(b.options.snippet);e&&e(b,d(b,c))},readonly:function(a,b){k.CUSTOM.read(a,b)},edit:function(a,b){k.CUSTOM.read(a,b)}},FILE:{read:function(a){var b=l("<div>").addClass("nx-fieldtext").css({padding:"0px","min-height":"26px"}).appendTo(a.element);new n.FileComponent(b,{model:a.model,row:a.row,displayAs:"filename",storeAs:"field",idField:a.id,deleteable:!1,editable:!1,_GUID:a._GUID})},readonly:function(a,b){k.FILE.read(a,b)},edit:function(a){var b=l("<div>").addClass("nx-fieldtext").appendTo(a.element);a.model.isNewId(a.row.Id)?(b.css({"font-size":"8pt",color:"#aaa"}),b.text("Save record before uploading files.")):(b.attr("id",n.generateGUID()).css("padding","0px"),new n.FileComponent(b,{model:a.model,row:a.row,displayAs:"filename",storeAs:"field",idField:a.id,deleteable:!0,editable:!0,_GUID:a._GUID}))}},REFERENCE:{read:function(a,c){var d,h,i,j=c||0===c?u(a.calculateReferenceText()):"";g().done(function(){return"skuid__Image__c"===a.metadata.ref?(k.FILE.read(a,c),!1):(d='<a href="',h=e(),i=f(),d+=h?'#" onclick="sforce.one.navigateToSObject(\''+c+"');":i?'#" onclick="skuid.ui.openConsoleTabForField(\''+u(a._GUID)+"','"+u(a.model.id)+"','"+c+"');":n.getSafeRelativeUrl("/"+c),d+='" tabindex="-1">'+j+"</a>",void b(a,d))})},readonly:function(a,b){k.REFERENCE.read(a,b)},edit:function(b,c){if("skuid__Image__c"===b.metadata.ref)return k.FILE.edit(b,c),!1;c||0===c||(c="");var d,e,f,g=b.element,h=b.options,i=l("<input>").val(c),j=b.metadata.ref,o=b.metadata.referenceTo,p=-1!=j.indexOf(","),q=0,r=0,s=function(a){var c=n.extractFieldsFromTemplate(h.searchTemplate||h.template),d=b.calculateReferenceMerges({targetObject:a});e=l("<div>").append(d.merges).text(),f=[],l.each(c,function(a,c){f.push({id:b.metadata.rel&&-1!=c.indexOf(b.metadata.rel)?c.slice(b.metadata.rel.length+1):c})})};if(g.data("recordId",c),p){var w;b.element.addClass("nx-polymorphic"),d=l("<select>").on("change",function(){w=d.val(),g.data("selectedSObject",d.find('option[value="'+w+'"]').attr("data-sobject")),g.data("selectedSObjectPrefix",w),g.data("recordId",""),g.data("recordLabel",""),s(w),b.model.updateRow(b.row,b.id,"",{initiatorId:b._GUID});var a=d.next();a.val(""),g.data("recordId",""),g.data("recordLabel",""),"REFPICK"===h.type&&B("",D),l.support.leadingWhitespace?a.focus():setTimeout(function(){a.focus()},400)});var x={},y=[];if(l.each(o,function(a,b){x[b.label+"_"+b.objectName]=b}),l.each(Object.keys(x).sort(),function(a,b){y.push(x[b])}),l.each(y,function(a,c){d["User"===c.objectName&&n.endsWith(b.id,"OwnerId")?"prepend":"append"](l("<option>").attr({value:c.keyPrefix,"data-sobject":c.objectName}).text(c.label))}),g.data("recordId")&&"undefined"!=g.data("recordId")){var z=g.data("recordId").substring(0,3);z&&3===z.length&&g.data("selectedSObjectPrefix",z)}g.data("selectedSObjectPrefix")&&d.val(g.data("selectedSObjectPrefix"));var A=d.find('option[value="'+d.val()+'"]');0===A.length&&(A=d.find("option").first()),g.data("selectedSObject",A.attr("data-sobject"))}else g.data("selectedSObject",j);s(g.data("selectedSObject")),g.data("recordLabel",""===g.data("recordId")?"":e);var B=function(c,d){var e,i=g.data("selectedSObject"),j=b.model.service.getNameField(i),k=b.options.searchFields,n=b.options.returnFields;if(k&&k.length||(f&&f.length?(k=[],l.each(f,function(a,b){k.push(b)})):k=[{id:j,displaytype:"STRING",filterable:!0}]),n&&n.length||(n=[],l.each(f,function(a,b){n.push(b)})),b.model){var o;o=b.metadata&&b.metadata.rel?b.metadata.rel+".":"",l.each(k,function(a,c){var d=c.id,e=b.model.getField(o+c.id);e&&(l.extend(c,e),c.id=d)})}var p,s;for(p=k.length-1;p>=0;p--)s=k[p],s.displaytype in m.searchableDisplayTypes||k.splice(p,1);if(h.optionsource){if("model"===h.optionsource){if(e=a.model.getModel(h.optionmodel),!e)return;var t=b.addOrReplaceConditionsForLookupFiltersToModel(e);"REFPICK"===h.type?t&&t.length?e.updateData(function(){d(e)}):d(e):(e.buildSearchCondition("__default_searchbox",c,k,{tokenize:"true"===h.tokenizeSearch,useSOSLSearch:h.useSOSLSearch,SOSLFields:h.SOSLFields,delimiter:h.delimiter,searchOperator:"contains"}),e.updateData(function(){d(e)}))}}else{e=new a.model.Model({service:b.model.service}),e.id="_TempModel_"+(new Date).getTime(),e.fields=n.slice(),e.objectName=i,e.doQuery=!0,e.recordsLimit=50,e.orderByClause=j,e.initialize(),e.calloutIterator=q++,e.lastSuccessfulCallout=function(){return r};var u=!1;l.each(n,function(a,b){return b.id==j?(u=!0,!1):void 0}),u||e.fields.push({id:j}),"OwnerId"===b.id&&"Group"===i&&e.addCondition({field:"Type",value:"Queue",inactive:!1}),h.order&&(e.orderByClause=h.order),"recordtype"==i.toLowerCase()&&(e.rTypeFor=b.model.objectName,e.addCondition({field:"SObjectType",value:e.rTypeFor,inactive:!1,type:"fieldvalue"})),b.addOrReplaceConditionsForLookupFiltersToModel(e),c&&e.buildSearchCondition("__default_searchbox",c,k,{tokenize:"true"===h.tokenizeSearch,useSOSLSearch:h.useSOSLSearch,SOSLFields:h.SOSLFields,delimiter:h.delimiter,searchOperator:"contains"}),e.load(function(){r=e.lastSuccessfulCallout,d(e)})}},C=function(a,c){if(a||0===a||""===a){g.data("recordId",a);var d=n.getNameField(g.data("selectedSObject")),e=c.getRowById(a);if(e){var f=c.getRowMergeResult(e,h.searchTemplate||h.template||"{{"+d+"}}",{registerFields:!1}),i=f.merges.text();g.data("recordLabel",i)}e&&d&&"Name"!==d&&"Id"!==d&&!("Name"in e)&&d in e&&(e.Name=e[d]);var j={},k=a;b.metadata&&e&&-1===l.inArray(b.metadata.displaytype,["REFERENCE","ID"])&&e.__templabel&&(k=e.__templabel),j[b.id]=k,k&&(j[b.metadata.rel]=e),b.model.updateRow(b.row,j,{initiatorId:b._GUID})}},D=function(a){i.empty(),b.element.hasClass("disabled")||i.prop("disabled",!1);var d=!1;b.required&&a.data.length&&!h.addNoneOption||(d=!c,i.append(l("<option>").val("").text(t("select_option_none")).prop("selected",!c)));var e=n.getNameField(g.data("selectedSObject")),f=h.searchTemplate||h.template||"{{"+e+"}}";l.each(a.data,function(b,e){d||(d=c===e.Id);var g=a.mergeRow(e,f,{registerFields:!1}).text();i.append(l("<option>").val(e.Id).text(g).prop("selected",c===e.Id))}),d||!c&&0!==c||i.append(l("<option>").val(c).text(g.data("recordLabel")).prop("selected",!0)),b.required&&!c&&0!==c&&C(i.val(),a),i.off("change.skuid").on("change.skuid",function(){C(l(this).val(),a)})};if("REFPICK"===h.type)i=l("<select>").prop("disabled",!0),i.append(c?l('<option value="">').text(e):l('<option value="">').text(t("select_option_none"))),B("",D);else{i=a.ui.renderers.AUTOCOMPLETE.edit({minLength:2,source:function(a,b,c,d){c(),B(a.term,function(a){g.data("tempmodel",a);var c=n.getNameField(g.data("selectedSObject")),e=h.searchTemplate||h.template||"{{"+c+"}}",f=-1!==e.indexOf("Name}}");l.each(a.data,function(){f&&!this.Name&&c in this&&(this.Name=this[c]),this.__templabel=g.data("tempmodel").mergeRow(this,e,{registerFields:!1}).text()}),b(a.data),d()})},onFocus:function(a,b){return i.val(b.item.__templabel),!1},onChange:function(a,c){C(c.item.Id,g.data("tempmodel"));var d=b.element.find(".nx-error-inline");return b.render(),d&&b.element.prepend(d),b.element.find("input").focus(),!1},onClose:function(){g.find(":input").focus()},onBlur:function(){setTimeout(function(){i.val(g.data("recordLabel"))},200)},onClear:function(){""!==b.model.getFieldValue(b.row,b.id)&&(b.model.updateRow(b.row,b.id,"",{initiatorId:b._GUID}),g.data("recordId",""),g.data("recordLabel",""))},optionRenderer:function(a,b){return l("<li></li>").data("ui-autocomplete-item",b).html("<a>"+u(b.__templabel)+"</a>").appendTo(a)},value:g.data("recordLabel")||c,parentElem:g});var E=g.find(".ui-icon-search");E.on("click.skuid",function(){if(!b.element.hasClass("disabled")){var c,d,e,f,j,k,m,o=function(){c.dialog("close").remove(),j.unregister&&j.unregister(),v(k.id,"_TempModel_")&&k.unregister()};a.snippet.registerSnippet("skuid.__referencepopupselect",function(a){var c,d;a.row?c=a.row:a.component&&a.component.row?c=a.component.row:a.item&&(c=a.item.row),a.model?d=a.model:a.component&&a.component.list&&(d=a.component.list.model),C(c.Id,d),b.render(),b.element.find("input").focus(),o()}),f=g.data("selectedSObject"),b.options&&"model"===b.options.optionsource?(m=a.$M(b.options.optionmodel),m&&m.objectName===f&&m.label&&(f=m.label)):b.metadata&&b.metadata.referenceTo&&b.metadata.referenceTo.length&&l.each(b.metadata.referenceTo,function(){return this.objectName===f?(this.label?f=this.label:l.each(a.model.list(),function(){return this.objectName===f&&this.label?(f=this.label,!1):void 0}),!1):void 0}),c=l("<div>").attr("title",t("select")+" "+f),e=l("<div>").css("min-height","300px"),c.append(e),B(i.data("uiAutocomplete").term,function(c){a.$M(c.id)||c.register(),k=c,l.each(k.fields,function(){this.nameField&&(this.nameField=!1)});var d,g=h.tokenizeSearch?' tokenizesearch="true"':"",i=b.options.returnFields,m=[],o=b.options.searchFields,p="";i&&i.length?l.each(i,function(a,b){b.showInSearchDialog&&m.push(b)}):m.push({id:n.getNameField(c.objectName)}),o&&o.length||h.useSOSLSearch?(p+="<searchfields"+(h.useSOSLSearch?' usesosl="true"':"")+(h.SOSLFields?' soslfields="'+h.SOSLFields+'"':"")+">",o&&o.length&&l.each(o,function(){p+='<searchfield field="'+this.id+'"/>'}),p+="</searchfields>"):p="",a.mobile?(d='<mobiledeck model="'+c.id+'"'+g+' pagesize="5" mode="readonly" searchbox="true" showsavecancel="false" createrecords="false" precision="1" minwidth="300"><components>',l.each(m,function(a,b){d+='<mobilefield id="'+b.id+'"',d+=b.label?">"+b.label+"</mobilefield>":"/>"}),d+='</components><cardinteractions><interaction type="tap"><actions><action type="custom" snippet="skuid.__referencepopupselect"/></actions></interaction></cardinteractions>'+p+"</mobiledeck>"):(d='<skootable model="'+c.id+'"'+g+' pagesize="5" mode="readonly" searchbox="true" showsavecancel="false" createrecords="false"><fields>',l.each(m,function(a,b){d+='<field id="'+b.id+'" allowordering="true"',d+=b.label?">"+b.label+"</field>":"/>"}),d+='</fields><rowactions><action type="custom" label="'+t("select")+" "+f+'" icon="sk-icon-add-reference" snippet="skuid.__referencepopupselect"/></rowactions>'+p+"</skootable>"),j=a.component.factory({xmlDefinition:d}),e.append(j.element),e.find(".searchbox").focus().select()}),d=[{icons:{primary:"ui-button-icon-primary ui-icon sk-icon-remove-reference sk-icon inline"},text:"Clear Value",click:function(){b.model.updateRow(b.row,b.id,"",{initiatorId:b._GUID}),g.data("recordId",""),g.data("recordLabel",""),o(),i.val("")}},{icons:{primary:"ui-button-icon-primary ui-icon sk-icon-cancel sk-icon inline"},text:t("cancel"),click:function(){o()}}],c.dialog({close:function(){o()},modal:!0,resizable:!0,width:"90%",buttons:d}),l(".ui-dialog").addClass("sk-dialog-autocomplete"),l(".ui-widget-overlay").addClass("sk-overlay-autocomplete")}})}if(g.addClass("editable"),d){var F=l("<label>").addClass("nx-basicfieldeditor-item-select-label");F.append(d),g.append(F,i)}else g.append(i)}},ID:{read:function(a,b){k.TEXT.read(a,b)},readonly:function(a,b){k.ID.read(a,b)},edit:function(a,b){a.model.isNewId(b)&&(b=""),a.metadata.ref=a.model.objectName,k.REFERENCE.edit(a,b)}},STRING:{read:function(a,b){k.TEXT.read(a,b)},readonly:function(a,b){k.TEXT.readonly(a,b)},edit:function(a,b){k.TEXT.edit(a,b)}},ANYTYPE:{read:function(a,b){k[n.getDisplayTypeOfEntity(b)][a.mode](a,b)},readonly:function(a,b){k.ANYTYPE.read(a,b)},edit:function(a,b){k.ANYTYPE.read(a,b)}}},m.renderers=j,m.fieldRenderers=k,m.click2Dial=c}(skuid),function(a){function b(m){m||(m={});var n,o,p,q,r,s,t,u=m.xml,v=m.list,w=v.model,x=m.element||c("<div>"),y=this,z=u.attr("condition"),A=y.type=u.attr("type"),B=!1,C=[],D=v?v.options.delayFilterExecution:!1,E=u.attr("labelmode");E||"daterange"!==A||(E="auto"),y.affectCookies="false"!==u.attr("affectcookies"),y.isReferenceFilter=!1,y.element=x.addClass("nx-conditiontoken"),y.list=v,y.model=v.model,y.filterCondition,y.affectedConditions={},z&&(y.filterCondition=w.getConditionByName(z,!0),!n&&y.filterCondition&&(n=w.getField(y.filterCondition.field))),y.filterCondition&&(y.affectedConditions[z]=y.filterCondition),u.find("effect").each(function(){var a=c(this),b=a.attr("condition"),d=w.getConditionByName(b,!0);d&&(y.affectedConditions[b]=d)});var F=function(a){var b=y.filterCondition;return b&&!b.inactive?y.isMultiselect?c.inArray(a,b.values)>-1:a===b.value:!1};if("select"===A||"multiselect"===A){y.isMultiselect="multiselect"===A;var G,H,I="auto"===u.attr("conditionsource");if(I){if(G=u.attr("conditionfield"),!G)return;if(n=w.getField(G),y.isReferenceFilter=!1,"REFERENCE"!==n.displaytype||e.endsWith(n.id,"RecordTypeId")||(y.isReferenceFilter=!0),z="__autofilter__"+G,y.filterCondition=H=w.getConditionByName(z,!0),H){if(H&&y.isReferenceFilter&&H.inactive!==!0){var J,K=[],L=y.isMultiselect&&H.values,M={};L?c.each(H.values,function(a,b){K.push(b)}):H.value&&K.push(H.value),K.length&&(c.each(K,function(a,b){var d,f,g=b.substring(0,3),h=M[g],i=w.getField(H.field),j=i.referenceTo;h||(c.each(j,function(a,b){return b.keyPrefix===g?(d=b,f=b.objectName,!1):void 0}),h=M[g]={objectType:f,fields:[e.getNameField(f)],records:[]}),h.records.push(b)}),J=a.data.get(M),J.isComplete?(c.each(K,function(a,b){var c=b.substring(0,3),d=J.data[c],e=d?d[b]:!1,f=M[c].fields[0];C.push({label:e?e.record[f]:"Invalid record",value:b,isSelected:!0})}),L||(B=!0)):(c.each(K,function(a,b){C.push({label:"Loading...",value:b,isSelected:!0})}),L||(B=!0),c.when(J.promise).done(function(){x.empty(),new b({element:x,xml:u,list:v})})))}}else{y.filterCondition=H=new a.model.Condition;var N=u.attr("conditionoperator");N||(N=y.isMultiselect?"MULTIPICKLIST"===n.displaytype?"includes":"in":"="),H.operator=N,H.field=G,H.inactive=!0,H.name=z,H.encloseValueInQuotes=!0,H.originalValue="",H.value="",H.originalInactive=!0,w.addCondition(H)}y.affectedConditions[z]=H}var O;("true"===u.attr("createfilteroffoption")||I)&&(O=e.mergeAsText("global",u.attr("filteroffoptionlabel")||"",{createFields:!0,registerFields:!1}),y.isMultiselect||y.isReferenceFilter||(this.filterCondition&&this.filterCondition.value===this.filterCondition.originalValue&&(B=!0),this.filterCondition||(B=!0),C.push({label:O,value:"__reset",affectDefaultCondition:!0,isSelected:B})));var P=u.children("sources").first();if(!I||P.length&&P.children().length||(P.length||(P=l("<sources/>")),P.append(l('<source type="metadata"/>'))),P.children().each(function(){var b,d=c(this),f=d.attr("effectsbehavior"),g={};if(("defaultandothers"===f||"justothers"===f)&&(b=d.children("effects").children(),b.length&&(g.effects=b)),"manual"===d.attr("type"))d.children("options").children().each(function(){var a,b,d=c(this);if("simple"===d.attr("type")&&y.filterCondition){var f=d.attr("value");"undefined"==typeof f&&(f=""),b=F(f),a={label:e.mergeAsText("global",d.attr("label")||f||"",{createFields:!0,registerFields:!1}),value:e.mergeAsText("global",f||"",{createFields:!1,registerFields:!1}),isSelected:b,affectDefaultCondition:!0,source:g},b&&(B=!0)}else if("complex"===d.attr("type")){var h=d.children("effects").children();b=y.isSelectedFromEffects(h),a={label:e.mergeAsText("global",d.attr("label")||"",{createFields:!0,registerFields:!1}),effects:h,value:"",isSelected:b,source:g},b&&(B=!0)}a&&C.push(a)});else{var h="justothers"!==d.attr("effectsbehavior");if("model"===d.attr("type")){var i=a.$M(d.attr("model")),j=d.children("labeltemplate").text(),k=d.children("valuetemplate").text();i&&(g.model=i,c.each(i.data,function(a,b){var c=e.mergeAsText("row",j||"{{{"+e.getNameField(i.objectName)+"}}}",{createFields:!0,registerFields:!1},i,b),d=e.mergeAsText("row",k||"{{{Id}}}",{createFields:!1,registerFields:!1},i,b),f=F(d);C.push({label:c,value:d,isSelected:f,affectDefaultCondition:h,source:g,row:b}),f&&(B=!0)}))}else if("metadata"===d.attr("type")){if(y.filterCondition){var l=n,m=e.mergeAsText("model",d.attr("prefix")||"",{createFields:!0,registerFields:!1},w),o=e.mergeAsText("model",d.attr("suffix")||"",{createFields:!0,registerFields:!1},w),p={};if(c.each(C,function(a,b){p[b.value]=b}),l){var q=w.recordTypeInfos;l.picklistEntries&&l.picklistEntries.length?c.each(l.picklistEntries,function(a,b){var c=b.value,d=F(c),e=b.label?b.label:c;
p[c]||C.push({label:m+e+o,value:c,isSelected:d,affectDefaultCondition:h,source:g}),d&&(B=!0)}):q&&q.length&&e.endsWith(l.id,"RecordTypeId")&&c.each(q,function(a,b){var c=b.recordTypeId;if(b.isAvailable&&(1===q.length||!e.endsWith(c,"AAA"))){var d=F(c);p[c]||C.push({label:m+b.name+o,value:c,isSelected:d,affectDefaultCondition:h,source:g}),d&&(B=!0)}})}}}else if("custom"===d.attr("type")){var r=d.attr("snippet");if(r){var s=a.snippet.get(r);s&&c.each(s({list:y,model:w}),function(a,b){var d=c("<div>").append(b.label?w.mergeModel(b.label):""),e=F(b.value);C.push({label:d.text(),value:b.value,isSelected:e,affectDefaultCondition:h,source:g}),e&&(B=!0)})}}}}),B||y.isMultiselect||y.isReferenceFilter||C.push({label:" - - - - ",value:"",isSelected:!0}),y.activateFilter=function(){y.isMultiselect||y.isReferenceFilter?(y.resetAffectedConditions(),y.isReferenceFilter?(c.each(y.affectedConditions,function(){this.values=[]}),C=c.map(x.actionAutocomplete("getSelectedItems"),function(a){return a.isSelected=!0,a.affectDefaultCondition=!0,a})):y.setOriginalValue(x.val()),C.length&&c.each(C,function(){this.isSelected?y.applyFilterForItem(this):y.unApplyFilterForItem(this)})):y.selectedItem&&(y.resetAffectedConditions(),y.applyFilterForItem(y.selectedItem),y.setOriginalValue(y.selectedItem))},y.isMultiselect&&!y.isReferenceFilter){var Q=!1,R=c.map(C,function(a){return a.isSelected?(Q=!0,a.value):void 0}).join(";"),S=function(){var a=x.data("multiselect-newvalues"),b=x.data("multiselect-oldvalues");if(w.hasChanged===!1){var d={};a&&c.each(a.split(";"),function(){d[this]=1}),c.each(C,function(a,b){b.isSelected=b.value in d}),D?(b||(b="__reset"),y.setOriginalValue(b),y.list.showFilterActions()):(y.activateFilter(),y.executeFilter())}},T=function(){y.restoreOriginalValue()};y.setOriginalValue(Q?R:"__reset"),a.ui.renderers.MULTIPICKLIST.edit({position:{my:"right top",at:"right bottom"},element:x.addClass("nx-actionselect"),entries:C,value:R,selectedText:n?n.label+": "+k("number_selected"):null,selectedList:3,noneSelectedText:O,onChange:function(a,b){x.data({"multiselect-newvalues":a,"multiselect-oldvalues":b}),D&&S()},onClose:function(){0!==w.isProcessing||D||T()},onCreate:function(){var a=c(this),b=a.multiselect("widget");D||b.append(c("<div>").addClass("ui-widget-footer ui-multiselect-footer ui-helper-clearfix").append(c("<div>").text(k("apply")).addClass("sk-timefilter-button").css("cursor","pointer").on("click",function(){S(),a.multiselect("close")}),c("<div>").text(k("cancel")).addClass("sk-timefilter-button-grey").css("cursor","pointer").on("click",function(){T(),a.multiselect("close")})))}}),x.find(".ui-multiselect").append('<div class="nx-actionselect-arrow"><div class="ui-icon ui-icon-triangle-1-s"/></div>')}else{var U=function(a){if(w.hasChanged===!1){var b=y.selectedItem;y.selectedItem=a,D?(y.isReferenceFilter?(c.each(y.affectedConditions,function(){this.values=[]}),y.setOriginalValue(c.map(C,function(a){return a.value}).join(";")),C=c.map(x.list.items,function(a){return a.isSelected=!0,a.affectDefaultCondition=!0,a})):y.setOriginalValue(b),y.list.showFilterActions()):(y.activateFilter(),y.executeFilter())}},V=parseInt(u.attr("autocompthreshold"),10);if(n&&y.isReferenceFilter)x.actionAutocomplete({refField:n,model:w,items:C,onItemSelect:U,isMultiselect:y.isMultiselect,defaultOptionLabel:O});else if(C.length<(V?V:25)){var W=u.attr("maxheight");x.actionSelect({items:C,onItemSelect:U,maxHeight:W})}else x.actionAutocomplete({model:w,items:C,onItemSelect:U})}}else if("toggle"===A){var X=u.children("effects").children(),Y=y.isSelectedFromEffects(X);Y||x.addClass("disabled"),y.activateFilter=function(){if(w.hasChanged===!1&&y.selectedItem){var a=x.is(".disabled");y.resetAffectedConditions(),a?y.unApplyFilterForItem(y.selectedItem):y.applyFilterForItem(y.selectedItem),y.setOriginalValue(a)}},x.actionSelect({items:[{label:e.mergeAsText("model",u.attr("label")||"",{createFields:!0,registerFields:!1},w),effects:X,value:"",isSelected:Y}],onItemSelect:function(a){var b=x.is(".disabled");x.toggleClass("disabled"),y.selectedItem=a,D?(y.setOriginalValue(b),y.list.showFilterActions()):(y.activateFilter(),y.executeFilter())}})}else if("daterange"===A){var Z,$,_,ab=u.attr("startcondition"),bb=u.attr("endcondition");if(ab&&bb&&"auto"!==u.attr("conditionsource"))Z=w.getConditionByName(ab,!0),$=w.getConditionByName(bb,!0);else if(_=u.attr("conditionfield"),ab="__autofilter__start__"+_,bb="__autofilter__end__"+_,Z=w.getConditionByName(ab,!0),$=w.getConditionByName(bb,!0),!Z||!$){if(!_)return!1;Z=new a.model.Condition,Z.operator="gte",Z.field=_,Z.inactive=!0,Z.name=ab,Z.encloseValueInQuotes=!1,$=new a.model.Condition,$.operator="lte",$.field=_,$.inactive=!0,$.name=bb,$.encloseValueInQuotes=!1,w.addCondition(Z),w.addCondition($)}if(o=w.getField(Z.field),p=w.getField($.field),!o||!p)return!1;var cb,db,eb=o.displaytype,fb=p.displaytype;Z.inactive?cb="":"DATETIME"===eb?(s=h(Z.value),s=a.time.getLocalDateTime(s),cb=i(s)):(s=g(Z.value),cb=Z.value),$.inactive?db="":"DATETIME"===fb?(t=h($.value),t.setDate(t.getDate()-1),t=a.time.getLocalDateTime(t),db=i(t)):(t=g($.value),db=$.value);var gb=function(){hb.datepicker("getDate")||ib.datepicker("getDate")?sb.css("display","block"):sb.css("display","none")},hb=d.renderers.DATE.edit({value:cb,onChange:gb}).addClass("sk-timefilter-input"),ib=d.renderers.DATE.edit({value:db,onChange:gb}).addClass("sk-timefilter-input");x.addClass("nx-actionselect nx-conditiontoken");var jb,kb,lb=c("<div>"),mb=c("<div>").addClass("nx-actionselect-text").append(lb),nb=c("<div>").addClass("nx-actionselect-arrow").append(c("<div>").addClass("ui-icon ui-icon-triangle-1-s")),ob=c("<div>").addClass("nx-actionselect-dropdown sk-timefilter-body").hide(),pb=c("<div>").text(k("start_date")).addClass("sk-timefilter-label"),qb=c("<div>").text(k("end_date")).addClass("sk-timefilter-label"),rb=c("<div>"),sb=c("<div>").addClass("sk-timefilter-clearfilter-button").text("Clear Filter");sb.click(function(){hb.datepicker("setDate",null),ib.datepicker("setDate",null),gb()}),D?(kb=c("<div>").text(k("done")).addClass("sk-timefilter-button"),rb.append(kb)):(jb=c("<div>").text(k("cancel")).addClass("sk-timefilter-button-grey"),kb=c("<div>").text(k("apply")).addClass("sk-timefilter-button"),rb.append(kb,jb)),y.updateDisplayValue=function(b,c){var d,e=f.makeFormattedDateFromLocal,g=a.label.merge;return d=b&&c?e(b)+" - "+e(c):b&&!c?g(k("after_this"),e(b)):!b&&c?g(k("before_this"),e(c)):k("all_time"),lb.text(d),b instanceof Date&&hb.datepicker("setDate",b),c instanceof Date&&ib.datepicker("setDate",c),gb(),y},y.updateDisplayValue(s,t),jb&&jb.click(function(){ob.hide("fast")}),y.activateFilter=function(){var b,c,d=hb.datepicker("getDate"),e=ib.datepicker("getDate");if(d&&(b=i(d)),e&&(c=i(e)),b?("DATETIME"===eb&&(b=j(a.time.getRealJSDateTimeFromLocal(g(b)))),w.setCondition(Z,b,y.affectCookies)):w.deactivateCondition(Z,y.affectCookies),c){if("DATETIME"===fb){var f=a.time.getRealJSDateTimeFromLocal(g(c));f.setDate(f.getDate()-0+1),c=j(f)}w.setCondition($,c,y.affectCookies)}else w.deactivateCondition($,y.affectCookies);y.setOriginalValue({start:d,end:e})},kb.click(function(){var a=hb.datepicker("getDate"),b=ib.datepicker("getDate");D?y.list.showFilterActions():(y.activateFilter(),y.executeFilter()),y.updateDisplayValue(a,b),ob.hide("fast")}),ob.append(pb,hb,qb,ib,sb,rb),x.addClass("nx-actionselect-haslabel").append(mb,nb,ob),mb.add(nb).click(function(){x.hasClass("unavailable")||(ob.is(":visible")?ob.toggle("fast"):(ob.css("min-width",Math.max(x.width(),180)+"px"),ob.show("fast")))})}"toggle"===A||"auto"!==E&&"manual"!==E||(r=c("<div>").addClass("nx-actionselect-label"),"auto"===E?"daterange"===A?q=o.label:n&&(q=n.label):"manual"===E&&(q=u.attr("label"),q&&(q=e.mergeAsTextInContext(q,{model:w}))),q&&(r.text(q),x.addClass("nx-actionselect-haslabel").prepend(r))),y.selectedItem||y.isMultiselect||(n&&y.isReferenceFilter?y.selectedItem=x.actionAutocomplete("getSelectedItem"):"daterange"===A?y.setOriginalValue({start:s,end:t}):y.selectedItem=x.actionSelect("getSelectedItem"))}var c=a.$,d=a.ui,e=a.utils,f=a.time,g=f.parseSFDate,h=f.parseSFDateTime,i=f.getSFDate,j=f.getSFDateTime,k=a.label.read,l=e.makeXMLDoc;b.prototype.setOriginalValue=function(a){"undefined"==typeof this.element.data("originalValue")&&this.element.data("originalValue",a)},b.prototype.restoreOriginalValue=function(){var a=this,b=a.element,d=b.data("originalValue");if(a.isMultiselect&&!a.isReferenceFilter){if(b=b.find("select"),"__reset"===d)b.val("");else if(d){var e=d.split(";");c.each(b.children("option"),function(a,b){c(b).prop("selected",c.inArray(b.value,e)>-1)})}b.data("echMultiselect")&&b.multiselect("refresh")}else"undefined"!=typeof d&&("toggle"===a.type?b.toggleClass("disabled",d):"daterange"===a.type?a.updateDisplayValue(d.start,d.end):a.isReferenceFilter?b.actionAutocomplete("resetItem",d):d&&"undefined"!=typeof d.value&&(a.element.is(".nx-actionautocomplete")?b.actionAutocomplete("resetItem",d.value):b.actionSelect("selectItem",d,{triggerHandlers:!1})))},b.prototype.isSelectedFromEffects=function(a){var b=this,d=!1;return a.each(function(){var a=c(this),f=b.affectedConditions[a.attr("condition")];if(f)if("deactivate"===a.attr("action")){if(!f.inactive)return d=!1,!1}else if("set"===a.attr("action")){var g=e.mergeAsText("global",a.attr("value")||"",{createFields:!0,registerFields:!1});if(g!==f.value||f.inactive)return d=!1,!1}else if("activate"===a.attr("action")&&f.inactive)return d=!1,!1;d=!0}),d},b.prototype.resetAffectedConditions=function(){var a=this;c.each(a.affectedConditions,function(){a.model.resetCondition(this,a.affectCookies)})},b.prototype.applyFilterForItem=function(a){var b,d=this,f=d.model,g=[],h=a.effects,i=a.source,j=i&&i.effects,k=a.affectDefaultCondition;if(h&&h.length&&c.each(h,function(){g.push(this)}),j&&j.length&&c.each(j,function(){g.push(this)}),b=g&&g.length,b&&c.each(g,function(){var b=c(this),g=d.affectedConditions[b.attr("condition")];if(g)if("deactivate"===b.attr("action"))f.deactivateCondition(g,d.affectCookies);else if("set"===b.attr("action")){var h,j={};a.row&&(j.row=a.row),i&&i.model&&(j.model=i.model),b.attr("value")?h=b.attr("value"):a.value&&(h=a.value),h=e.mergeAsTextInContext(h,j,{createFields:!1,registerFields:!1}),f.setCondition(g,h,d.affectCookies)}else"activate"===b.attr("action")&&f.activateCondition(g,d.affectCookies)}),k&&"undefined"!=typeof a.value&&d.filterCondition)if("__reset"===a.value)f.resetCondition(d.filterCondition,d.affectCookies);else{var l,m=e.mergeAsText("global",a.value||"",{createFields:!1,registerFields:!1}),n=d.filterCondition.operator;d.isMultiselect?(l=d.filterCondition.values,l?(e.isString(l)&&(l=l.split(";")),-1===c.inArray(m,l)&&l.push(m)):l||(l=[m]),e.isMultiValueOperator(n)||("="===n?n="in":"!="===n&&(n="not in"),d.filterCondition.operator=n)):l=m,f.setCondition(d.filterCondition,l,d.affectCookies)}},b.prototype.unApplyFilterForItem=function(a){var b,d=this,f=d.model,g=[],h=a.effects,i=a.source,j=i&&i.effects,k=a.affectDefaultCondition;if(h&&h.length&&c.each(h,function(){g.push(this)}),j&&j.length&&c.each(j,function(){g.push(this)}),b=g&&g.length,b&&c.each(g,function(){var a=c(this),b=d.affectedConditions[a.attr("condition")];b&&("deactivate"===a.attr("action")?f.activateCondition(b,d.affectCookies):f.deactivateCondition(b,d.affectCookies))}),k&&"undefined"!=typeof a.value&&d.filterCondition)if("__reset"===a.value){var l=e.mergeAsText("global",a.value||"",{createFields:!1,registerFields:!1});f.setCondition(d.filterCondition,l,d.affectCookies)}else if(d.isMultiselect){var m=d.filterCondition.values,n=c.inArray(a.value,m);n>-1&&m.splice(n,1)}else f.resetCondition(d.filterCondition,d.affectCookies)},b.prototype.executeFilter=function(){var a,b=this,c=b.list,d=c.searchBox;d&&(a=d.val()),"remove"!==c.options.emptySearchBehavior||a?c.updateData({message:k("applying_filter"),failmessage:k("filter_could_not_be_applied"),showerror:!0}):c.model.abandonAllRows()},d.Filter=b}(skuid),function(a){var b=a.$,c=a.utils,d=a.$M,e=a.hotkeys={},f=a.actions={},g=a.interactions={},h={},i={},j={swipe:"drag",swipeleft:"dragleft",swiperight:"dragright",swipeup:"dragup",swipedown:"dragdown"},k=f.register=function(a){b.extend(h,a)},l=c.getContextToUse,m=function(a,c,e,f){var g=c.attr("model"),h=g?d(g):null,i=l(e,f),j=i.row,k=i.list,m=k?b.map(k.getSelectedItems(),function(a){return a.row}):!1;j&&h&&h.getRowById(j.Id)?h[a]([j]):m&&m.length&&h&&k&&k.model===h?h[a](m):h&&h.data.length&&h[a](h.data)},n=c.isPromise;g.register=function(a){b.each(a,function(){i[this]=1})},g.processInteractionsNode=function(a,c,d){a.children().each(function(){g.processInteractionNode(b(this),c,d)})},g.processInteractionNode=function(a,c,d){if(!a||!a.children)return!1;var e=a.attr("type"),g=a.children("actions").first();return e in i==!1?!1:void(d&&d.selector?c.element.on(e,d.selector,function(a){var d=b(this),e=d&&d.data?d.data("component"):null;e||(e=c),f.runActionsNode(g,e),a&&a.gesture&&a.gesture.preventDefault()}):(c.element.on(e,function(a){f.runActionsNode(g,c),a&&a.gesture&&a.gesture.preventDefault()}),j[e]&&c.element.on(j[e],function(a){a.gesture.stopPropagation(),a.gesture.preventDefault()})))},f.runActionsNode=function(c,d,e){var g,h=b.Deferred(),i="true"===c.attr("continuesequenceonerror"),j=c.children(),k=j.length,l=0,m=function(c){if(l===k)return a.mobile&&a.mobile.processResponsiveElements(),void h.resolve(c);g=j.eq(l++);var e=f.runActionNode(g,d,c),i=function(a){var b=g.children("onerroractions").children();b.length?(j=b,k=b.length,l=0,g=null,m(a)):o(a)};if(e===!1)i(c);else if(e&&(e.deferred&&n(e.deferred)||n(e))){var p=e.deferred?e.deferred:e;b.when(p).then(function(a){m(b.extend(c,a))},function(a){i(b.extend(c,a))})}else m(e?b.extend(c,e):c)},o=function(b){i?m(b):(a.mobile&&a.mobile.processResponsiveElements(),h.reject(b))};return k?m(e):h.resolve(),d&&d.xmlDefinition&&d.xmlDefinition.attr("buttonset")&&(b(".sm-buttonset-"+d.xmlDefinition.attr("buttonset")).removeClass("sm-active"),d.element.addClass("sm-active")),h.promise()},f.runActionNode=function(b,c,d){var e,f,g,i=b.attr("type");if(i){if(i in h?e=h[i]:c&&c.type()&&(f=a.componentType.get(c.type()),g=f.actions,g&&i in g&&(e=g[i])),e)return e(b,c,d);var j=d.model,k=j.service.adapter.getServiceActions;if(k)return j.service.adapter.runServiceAction({context:d,actionName:b.attr("functionname"),parameters:b.children("parameters").first()})}},f.registerEditorWithModelsForActionsNode=function(a,c){var e=a.find('action[type="save"], action[type="requeryModel"], action[type="requeryModels"]');e.length&&e.each(function(){var a=b(this),e="requeryModel"===a.attr("type");e?c.registerModel(d(a.attr("model"))):a.children("models").children().each(function(){c.registerModel(d(a.text()))})})},k({blockUI:function(a,d,e){var f={},g=a.attr("message"),h=a.attr("timeout");g&&(f.message=c.mergeInContext(g,l(d,e),{createFields:!0,registerFields:!1,nl2br:!0})),h&&(f.timeout=parseInt(h,10)),b.blockUI(f)},unblockUI:function(){b.unblockUI()},save:function(c,e,f){var g=[],h=c.children("models").first(),i=c.attr("model"),j="true"===c.attr("rollbackonanyerror"),k=b.Deferred(),l=f?f.initiatorId:null,m={rollbackOnAnyError:j};if(l&&(m.initiatorId=l),h.length)b.each(h.children("model"),function(){var a=d(b(this).text());a&&g.push(a)});else if(i&&d(i)){var n=d(i);g.push(n)}return e&&e.button&&e.button.startProcessing(),b.when(a.model.save(g,m)).then(function(a){a.totalsuccess?k.resolve(a):k.reject(a),e&&e.button&&e.button.stopProcessing()},function(a){k.reject(a),e&&e.button&&e.button.stopProcessing()}),k.promise()},cancel:function(c){var e=[],f=c.children("models").first(),g=c.attr("model");f.length?b.each(f.children("model"),function(){var a=d(b(this).text());a&&e.push(a)}):g&&d(g)&&e.push(d(g)),a.model.cancel(e)},markRowsForDeletion:function(a,b,c){m("deleteRows",a,b,c)},unmarkRowsForDeletion:function(a,b,c){m("undeleteRows",a,b,c)},createRow:function(a,e,f){var g=a.attr("model"),h=d(g),i=l(e,f),j=i.model,k=i.row,m=i.list,n=i.editor,o=i.rows,p={},q="append"===a.attr("appendorprepend"),r="edit"===a.attr("defaultmodefornewitems"),s=a.children("defaults").first().children();if(h){var t=function(a,d){var e=[],f={createFields:!1,registerFields:!1},g={row:a,model:d},i=m?m.conditions:null,j=n?n.conditions:null;return n&&j&&j.length&&n.models&&b.inArray(d,n.models)>-1?b.each(j,function(){e.push(this)}):m&&i&&i.length&&m.model===h&&b.each(i,function(){e.push(this)}),s&&s.length&&s.each(function(){var a=b(this),d=a.attr("field"),h=a.attr("value"),i=c.mergeAsTextInContext(h,g,f);e.push({field:d,value:i})}),h.createRow({additionalConditions:e,doAppend:q,editModeForNewItems:r})},u=[];return k?u.push(t(k,j)):o&&o.length?b.each(o,function(a,b){u.push(t(b,j))}):u.push(t(null,j)),u.length&&(1===u.length?p.row=u[0]:p.rows=u),p}},adoptRows:function(a,b,c){var e,f,g=a.attr("sourcemodel"),h=a.attr("targetmodel"),i=l(b,c),j=i.list,k=i.rows,m=i.row;g&&(e=d(g)),h&&(f=d(h)),e&&f&&e.data&&e.data.length&&f.adoptRows(m&&e.getRowById(m.Id)?[m]:k&&k.length&&j&&j.model===e?k:e.data)},updateRow:function(e,f,g){var h,i,j,k,m=e.attr("fieldmodel"),n=e.attr("field"),o=e.attr("value"),p=l(f,g),q=p.list,r=p.rows,s=p.model,t=p.row;m&&(h=d(m)),!s&&q&&(s=q.model),h&&(i=h.getField(n),i&&(j=i.displaytype));var u=function(b,e){var f,g,h,i={};if("REFERENCE"===j){g=c.getReferenceFieldRelationshipName(n);var k,l,m=c.extractFieldsFromTemplate(o);if(m&&1===m.length)if(k=m[0],c.startsWith(k,"$Model.")&&c.contains(k,".data.")){l=k.split(".");var p,q=l[1],r=parseInt(l[3],10),s=k.indexOf("."+l[3]+".")+2+l[3].length,t=k.substring(s,k.length),u=d(q);u&&(p=u.data[r],p&&(h="Id"===t?p:u.getFieldValue(p,c.getReferenceFieldRelationshipName(t),!0)))}else h="Id"===k?b:e.getFieldValue(b,c.getReferenceFieldRelationshipName(k),!0)}return o&&(f=a.utils.mergeAsTextInContext(o,{model:e,row:b},{createFields:!1,registerFields:!1})),"BOOLEAN"!==j&&j||(f&&"false"!==f?"true"===f&&(f=!0):f=!1),i[n]=f,g&&h&&(i[g]=h),i};h&&(t&&h.getRowById(t.Id)?h.updateRow(t,u(t,s)):r&&r.length&&q&&q.model===h?(k={},b.each(r,function(a,b){k[b.Id]=u(b,q.model)}),c.size(k)&&h.updateRows(k)):(k={},b.each(h.data,function(a,b){k[b.Id]=t?u(t,s):u(b,h)}),c.size(k)&&h.updateRows(k)))},requeryModel:function(a,c){var e=a.attr("model"),f=b.Deferred();if(e){var g=d(e);if(g){c&&c.button&&c.button.startProcessing(),g.hasChanged&&g.cancel();var h="loadmore"!==a.attr("behavior")?"updateData":"getMoreData";b.when(g[h]()).then(function(a){f.resolve(a),c&&c.button&&c.button.stopProcessing()},function(a){f.reject(a),c&&c.button&&c.button.stopProcessing()})}}return f.promise()},requeryModels:function(c,e){var f=[],g=c.children("models").first(),h=b.Deferred();g.length&&b.each(g.children("model"),function(){var a=d(b(this).text());a&&f.push(a)}),e&&e.button&&e.button.startProcessing(),b.each(f,function(){this.hasChanged&&this.cancel()});var i="loadmore"!==c.attr("behavior")?"updateData":"getMoreData";return b.when(a.model[i](f)).then(function(a){h.resolve(a),e&&e.button&&e.button.stopProcessing()},function(a){h.reject(a),e&&e.button&&e.button.stopProcessing()}),h.promise()},emptyModelData:function(a){var c=a.children("models").first();c.length&&b.each(c.children("model"),function(){var a=d(b(this).text());a&&a.emptyData()})},abandonRows:function(a,b,c){var e,f=a.attr("model"),g=l(b,c),h=g.list,i=g.rows,j=g.row;f&&(e=d(f)),e&&e.data&&e.data.length&&(j&&e.getRowById(j.Id)?e.abandonRows([j]):i&&i.length&&h&&h.model===e?e.abandonRows(i):e.emptyData())},redirect:function(a,d,e){c.redirect(b.extend(l(d,e),{url:a.attr("url"),window:a.attr("window")}))},custom:function(c,d,e){var f,g,h=a.snippet.get(c.attr("snippet"));if(h){if(f=l(d,e),b.extend(f,{component:d,context:e}),g=h(f),g===!1)return!1;if(g&&"object"==typeof g)return g}},"sfdc-custom-apex":function(d,e,f){var g=d.attr("sfdcactionname"),h=b.Deferred(),i={},j=!0;if(d.children("inputs").children().each(function(){var c=b(this),d=c.attr("name"),k=c.attr("value"),m=c.attr("displaytype"),n=l(e,f);return d?(k=a.utils.mergeAsDataInContext(k,n),"BOOLEAN"===m&&(k="true"===k?!0:!1),i[d]=k,void 0):(h.reject({$CurrentAction:{Error:'Invalid parameter name "'+d+'" for Salesforce Action "'+g+'"'}}),j=!1,!1)}),!j)return h.promise();e&&e.button&&e.button.startProcessing();var k={inputs:c.size(i)?[i]:[]};return b.when(a.sfdc.api.makeRequest({type:"POST",url:"/actions/custom/apex/"+g,data:k,crossDomain:!0,success:function(a){h.resolve({$PreviousAction:{result:a[0].outputValues}})},error:function(a){var b=a.responseJSON;b&&b.length&&h.reject({$CurrentAction:{error:b[0].errors[0]}})}})).always(function(){e&&e.button&&e.button.stopProcessing()}),h.promise()},publish:function(b,c){a.events.publish(b.attr("event"),[c])},setCondition:function(a,e,f){var g=d(a.attr("model"));if(!g)return!1;var h=g.getConditionByName(a.attr("condition"),!0);if(!h)return!1;var i,j,k,m=l(e,f),n=a.attr("value");i=m.model,j=m.row,!i&&e&&e.model&&(i=e.model),i||(i=g),j||(e&&e.row&&(j=e.row),!j&&i&&(j=i.getFirstRow()));var o=b.extend({},m,{row:j,model:i});k=c.mergeAsTextInContext(n,o,{createFields:!1,registerFields:!1}),g.setCondition(h,k)},deactivateCondition:function(a){var b=d(a.attr("model"));if(!b)return!1;var c=b.getConditionByName(a.attr("condition"));c&&b.deactivateCondition(c)},activateCondition:function(a){var b=d(a.attr("model"));if(!b)return!1;var c=b.getConditionByName(a.attr("condition"));c&&b.activateCondition(c)}});var o,p={},q=function(a){var b=a.bindString,c=p[b]||(p[b]={});c[a.componentId]=a},r=function(a){b.each(p,function(b,c){c&&a in c&&delete c[a]})};e.bind=function(a,d,e,f){var g=a.children();g.length&&b(function(){o||(o=b(document)),b.each(g,function(){var a=b(this),g=a.attr("key"),h=a.attr("modifiers"),i="true"===a.attr("ignoretextinputs"),j=(h?h.replace(",","+")+"+":"")+g,k={componentId:d,bindString:j,visibleElement:f,actionFunction:e};q(k),o.on("keydown."+d,null,{keys:j,filterTextInputs:i},function(a){if(f&&f.is(":visible")&&e){var d,g=p[j],h=k;g&&c.size(g)>1&&(d=function(a){var b,c=a.visibleElement,d=-1;return c&&c.length?(b=c&&c.closest&&c.closest(".ui-dialog-content"),b.length?d=b.zIndex():c.closest("body").length||(d=-2)):d=-2,a.zIndex=d,d},d(k),b.each(g,function(a,b){h.componentId!==a&&b!==h&&b.actionFunction&&d(b)>h.zIndex&&(h=b)})),a.preventDefault(),a.stopImmediatePropagation(),h.actionFunction()}})})})},e.unbind=function(a){o||(o=b(document)),o.off("keydown."+a),r(a)}}(skuid),function(a){function b(b){function c(){return p}function g(a){a||(a={});var b=a.itemId,c=h({namespace:a.namespace,type:a.type,id:b}),f={getSettings:function(){return d(i({key:c}))},updateSettings:function(a,b){return j(e.extend(b,{key:c,settings:a}))},deleteSetting:function(a){if("string"==typeof a){var b={};b[a]=null,j({key:c,settings:b,removeNulls:!0})}}};return f}function h(a){a||(a={});var b=[];return a.id&&(a.namespace&&b.push(a.namespace),a.type&&b.push(a.type),b.push(a.id)),b}function i(a){var b=a&&a.key;if(!e.isArray(b)||0===b.length)return{};var c,d,f=l;for(c=0;c<b.length;c++){if(d=b[c],!f[d]){if(a.createNodes!==!0)return{};f[d]={}}f=f[d]}return f}function j(a){var b=i(e.extend(a,{createNodes:!0})),c=a&&a.deferUpdate,f=a.settings;if("object"!=typeof f)return(new e.Deferred).resolve();if(f=d(f),a.deepMerge!==!1?e.extend(!0,b,f):e.extend(b,f),a.removeNulls===!0){var g=function(a){var b,c;c=[];for(b in a)c.push(b);e.each(c,function(b,c){"undefined"==typeof a[c]||null===a[c]?delete a[c]:"object"==typeof a[c]&&g(a[c])})};g(b)}return c===!0?(new e.Deferred).resolve():k()}function k(){if(m&&"pending"===m.state())return n||(n=new e.Deferred),o=!0,n.promise();m=n||new e.Deferred,n=null,void 0===l.m&&(l.m={}),"client"===p&&(l.m.lastModifiedDate=Date.now());var b=JSON.stringify(l);if("server"===p)a.remote().updatePersonalizationSettings(a.page.id,b,function(a,b){b.status?m.resolve():m.reject(b),o===!0&&(o=!1,k())});else{var c=JSON.stringify({m:l.m}),d=JSON.stringify({c:l.c,z:l.z});e.cookie(r,c,{secure:!0,path:"/"}),f.sessionStorage(s,d),m.resolve()}return m.promise()}var l,m,n,o,p,q=b.pageId,r="apex__sk-pf-"+q,s="sk-pf-"+q;return function(a){var b,c;p=a.mode||"server","client"===p?(a.isModelCookieObsolete===!0?(e.removeCookie(r),b={}):b=JSON.parse(e.cookie(r)||"{}"),c=JSON.parse(f.sessionStorage(s)||"{}"),l=e.extend({},b,c)):l=e.extend({},a.pageSettings||{})}(b),{_createService:g,_savePageSettings:k,_getMode:c,_getPageSettings:function(){return d(l)}}}function c(c){c||(c={});var d=c.pageId||c.getParentPage&&c.getParentPage()._pageRecord&&c.getParentPage()._pageRecord.Id||a.page.id;if(h[d])return h[d];c.mode||window.console&&window.console.warn;var e=h[d]=b(c);return e}function d(a){return JSON.parse(JSON.stringify(a))}var e=a.$,f=a.utils,g=a.personalization={},h={};e.extend(g,{getPageSettings:function(a){var b=c(a);return b._getPageSettings()},createService:function(b){var d=c({pageId:b.pageId||a.page.id});return d._createService({namespace:"z",type:b.type,itemId:b.id})},createComponentService:function(a){var b=c(a),d=a&&a.xmlDefinition&&a.xmlDefinition.attr("uniqueid");return b._createService(d?{namespace:"c",type:a._componentType,itemId:d}:{})},createModelService:function(a){var b=c(a),d=b._createService({namespace:"m",type:"sf",itemId:a&&a.id});return d=e.extend(d,{setCondition:function(a){var b,c=a&&a.name,f=a&&a.value;return c?(b={conditions:{}},b.conditions[c]=f,d.updateSettings(b)):(new e.Deferred).reject()},resetCondition:function(a){var b,c=a&&a.name;return c?(b={conditions:{}},b.conditions[c]=null,d.updateSettings(b,{removeNulls:!0})):(new e.Deferred).reject()},setOrderBy:function(a){var b=a.newValue,c={orderBy:b};return d.updateSettings(c)},resetOrderBy:function(){var a={orderBy:null};return d.updateSettings(a,{removeNulls:!0})}})},initializeSettings:function(a){a||(a={}),c(a)}})}(skuid||(window.skuid={})),function(a){var b,c=a.mobile={},d=a.utils,e=a.actions,f=a.interactions,g=a.$;c.mainarea,c.headernavwrapper=g("<div>").addClass("sm-headerwrapper"),c.toppanelarea=g("<div>").addClass("sm-toppanelwrapper"),c.headernavarea=g("<div>").addClass("sm-headerarea"),c.headernavwrapper.append(c.toppanelarea,c.headernavarea),c.popupwrapper=g("<div>").addClass("sm-popupwrapper"),c.popuptitle=g("<div>").addClass("sm-popupcontent-title"),c.popupcontentwrapper=g("<div>").addClass("sm-popupcontent"),c.popupcontent=g("<div>").addClass("sm-popupcontent-body"),c.footernavarea=g("<div>").addClass("sm-footerwrapper"),c.panelarea=g("<div>").addClass("sm-panelwrapper"),c.mainpanel,c.leftpanels=[],c.rightpanels=[],c.toppanel,c.popuppanel,c.panelMap={},c.panels=[],c.windowWidth,c.isAnimating=!1,b=["tap","hold","doubletap","pinch","pinchin","pinchout","swipeleft","swiperight","swipedown","swipeup","swipe","drag"],c.config={validInteractions:b,defaultLeftPanelWidth:300,minSidePanelPercent:.75,resizeWaitTime:100,defaultAnimationSpeed:500},a.interactions.register(b),g(document.body).one("pageload",function(){c.setSizeCaches(),c.panels.length&&c.setMainPanel(c.panels[0]),c.mainarea.removeClass("sm-mainwrapper-hide"),a.events.publish("skuidMobileReady"),document.addEventListener("touchstart",function(){},!0)}),c.registerPanel=function(a){return c.panelMap[a.id()]=a,c.panels.push(a),a},c.handleResize=function(){c.setSizeCaches(),c.processResponsiveElements()},c.setSizeCaches=function(){c.windowWidth=g(window).width()},d.addResizeHandler(c.handleResize,c.config.resizeWaitTime),c.dumbFitAlgorithm=a.responsive.dumbFitAlgorithm,c.processResponsiveElements=function(){c.mainpanel&&(c.processResponsivePanels(),c.processResponsiveArea(c.headernavarea),c.processResponsiveArea(c.footernavarea),c.processResponsiveArea(c.popupcontent),c.processResponsiveArea(c.toppanelarea),c.processResponsiveArea(c.panelarea))},c.processResponsivePanels=function(){if(c.mainpanel){var a=c.mainpanel,b=a.element,d=a.xmlDefinition.attr("minwidth"),e=0,f=0;g.each(c.leftpanels,function(a){var b=this;if(b.closing)return!0;if(b.offset=f+e,b.width=b.preferredwidth||c.config.defaultLeftPanelWidth,b.width>.75*c.windowWidth&&(b.width=.75*c.windowWidth),"push"===b.displaymode||"fit"===b.displaymode)if("push"===b.displaymode&&d&&d>c.windowWidth-b.width-b.offset)if(0===a)f+=b.width;else{var g=c.leftpanels[a-1];"fit"!==g.displaytype&&(b.offset=g.offset,f-=g.width,f+=b.width)}else e+=b.width;b.element.css("width",b.width+"px"),b.element.css("left",b.offset+"px")}),b.css({left:f||"","border-style":"solid","border-left-width":e?e+"px":""})}},c.processResponsiveArea=function(a){c.mainpanel&&(c.processResponsiveGrids(a),c.processResponsiveButtons(a),c.positionPanelWrapper())},c.processResponsiveGrids=function(a){a=a||g(document.body),a.filter(".sm-grid").add(a.find(".sm-grid")).each(function(){c.processGrid(g(this))})},c.processGrid=a.responsive.processGrid,c.processResponsiveButtons=function(a){a=a||g(document.body),a.filter(".sm-button").add(a.find(".sm-button")).each(function(){c.processButton(g(this))})},c.processButton=function(a){var b=a.find(".sm-button-text"),c=a.data("fullwidth");c||(c=a.children().first()[0].scrollWidth+14,a.data("fullwidth",c)),c>a[0].clientWidth?b.addClass("sm-button-text-hidden"):b.removeClass("sm-button-text-hidden")},c.positionPanelWrapper=function(){c.panelarea.css("border-top",c.headernavarea.outerHeight()+"px solid white"),c.panelarea.css("border-bottom",c.footernavarea.outerHeight()+"px solid white")},c.setMainPanel=function(a,b){if(b||(b={}),c.isAnimating)return!1;if("string"==typeof a&&(a=c.panelMap[a]),!a.element)return!1;var d=c.mainpanel;if(a===d)return!1;var e=b.transition;if(c.panelarea.append(a.element),e){if("slideleft"===e||"slideright"===e){c.isAnimating=!0;var f=c.windowWidth,g=("slideleft"===e?"":"-")+f+"px",h=("slideleft"===e?"-":"")+f+"px",i=("slideleft"===e?"-":"")+f+"px",j=("slideleft"===e?"":"-")+f+"px";a.element.css({left:g,right:h}),a.element.removeClass("sm-panel-hidden"),d.element.animate({left:i,right:j},c.config.defaultAnimationSpeed),a.element.animate({left:"0px",right:"0px"},c.config.defaultAnimationSpeed,function(){c.isAnimating=!1,c.setMainPanel(a)})}}else d&&d.element.addClass("sm-panel-hidden").removeClass("sm-panel-primary"),d&&d.element.css({width:"",left:"",right:""}),d&&d.element.detach(),a.element.addClass("sm-panel-primary").removeClass("sm-panel-hidden"),c.mainpanel=a,c.processResponsiveElements()},c.addLeftPanel=function(a,b){if(b||(b={}),c.isAnimating)return!1;if("string"==typeof a&&(a=c.panelMap[a]),!a.element)return!1;var d=c.leftpanels.indexOf(a);if(a===c.mainpanel)return!1;if(-1!==d)return!1;a.position=b.position,a.displaymode=b.displaymode||"push";var e;b.replace===!0&&c.leftpanels.length&&(e=0===a.position||a.position&&"edge"!==a.position?c.leftpanels[a.position]:c.leftpanels[c.leftpanels.length-1],e&&(c.removeLeftPanel(e,{preventProcessing:!0}),b.transition=null)),a.preferredwidth=parseInt(a.xmlDefinition&&a.xmlDefinition.attr("preferredwidth")||c.config.defaultLeftPanelWidth,10),0===a.position||a.position&&"edge"!==a.position?(c.leftpanels.length<a.position&&(a.position=c.leftpanels.length),c.leftpanels.splice(a.position,0,a)):c.leftpanels.push(a),c.panelarea.append(a.element),a.element.addClass("sm-panel-left").removeClass("sm-panel-hidden"),b&&"slide"===b.transition&&(c.addTransition(a.element,"slideright"),a.element.one("animationend webkitAnimationEnd oAnimationEnd MSAnimationEnd",function(){a.element.removeClass("sm-transition-slideright")})),b.preventProcessing||c.processResponsiveElements()},c.removeLeftPanel=function(a,b){if(b&&"slide"===b.transition)return c.addTransition(a.element,"unslideright"),a.closing=!0,a.element.one("animationend webkitAnimationEnd oAnimationEnd MSAnimationEnd",function(){a.element.removeClass("sm-transition-unslideright"),delete b.transition,a.closing=!1,c.removeLeftPanel(a,b)}),void c.processResponsiveElements();if(c.isAnimating)return!1;if("string"==typeof a&&(a=c.panelMap[a]),!a.element)return!1;var d=c.leftpanels.indexOf(a);return-1===d?!1:(b||(b={}),a.element.detach(),a.element.addClass("sm-panel-hidden").removeClass("sm-panel-left sm-panel-left-sliding"),a.element.css({width:"",left:"",right:""}),c.leftpanels.splice(d,1),c.mainpanel.element.removeClass("sm-panel-primary-fit sm-panel-primary-pushed sm-panel-primary-pushing"),b.preventProcessing||c.processResponsiveElements(),void(b.dfd&&b.dfd.resolve()))
},c.setLeftPanel=function(a,b){c.hideLeftPanel({transition:b.transition,preventProcessing:!0,callback:function(){c.addLeftPanel(a,b)}})},c.hideLeftPanel=function(a){var b=[],d=[];g.each(c.leftpanels,function(){b.push(this)}),g.each(b,function(){var b=g.Deferred();d.push(b),c.removeLeftPanel(this,{transition:a.transition||"slide",dfd:b})}),a&&a.preventProcessing||c.processResponsiveElements(),a&&a.callback&&g.when.all(d).then(a.callback)},c.toggleLeftPanel=function(a,b){b||(b={}),"string"==typeof a&&(a=c.panelMap[a]),-1!==c.leftpanels.indexOf(a)?c.removeLeftPanel(a,b):c.addLeftPanel(a,b)},c.setTopPanel=function(a,b){if(b||(b={}),c.isAnimating)return!1;if("string"==typeof a&&(a=c.panelMap[a]),!a.element)return!1;var d=c.toppanel;if(a===d)return!1;if(a===c.mainpanel)return!1;var e=b.transition;d&&(e=null),d&&d.element.addClass("sm-panel-hidden").removeClass("sm-panel-top"),c.toppanelarea.append(a.element),e?"slide"===e&&(c.isAnimating=!0,a.element.addClass("sm-panel-top-sliding").removeClass("sm-panel-hidden").hide(),a.element.slideDown(c.config.defaultAnimationSpeed,function(){c.isAnimating=!1,c.setTopPanel(a)})):(d&&d.element.detach(),a.element.addClass("sm-panel-top").removeClass("sm-panel-hidden sm-panel-top-sliding"),c.toppanel=a)},c.hideTopPanel=function(a){if(a||(a={}),c.isAnimating)return!1;var b=c.toppanel;return b?void(a.transition?"slide"===a.transition&&(c.isAnimating=!0,b.element.addClass("sm-panel-top-sliding"),b.element.slideUp(c.config.defaultAnimationSpeed,function(){c.isAnimating=!1,c.hideTopPanel()})):(b&&b.element.detach(),b&&b.element.addClass("sm-panel-hidden").removeClass("sm-panel-top sm-panel-top-sliding"),c.toppanel=null)):!1},c.toggleTopPanel=function(a,b){b||(b={}),"string"==typeof a&&(a=c.panelMap[a]),a===c.toppanel?c.hideTopPanel(b):c.setTopPanel(a,b)},c.setPopupPanel=function(a,b){if(b||(b={}),c.isAnimating)return!1;if("string"==typeof a&&(a=c.panelMap[a]),a instanceof g&&(a={element:a}),!a.element)return!1;var d=c.popuppanel;if(a===d)return!1;if(a===c.mainpanel)return!1;var e=b.transition;b.title&&(c.popuptitle.empty(),"string"==typeof b.title?c.popuptitle.text(b.title):b.title&&b.title(c.popuptitle)),d&&(e=null),d&&d.element.addClass("sm-panel-hidden").removeClass("sm-panel-popup"),d&&d.element.css({width:"",left:"",right:""}),a.element.addClass("sm-panel-popup").removeClass("sm-panel-hidden"),c.popupcontent.append(a.element),b.noPadding?c.popupcontent.css("padding","0px"):c.popupcontent.css("padding",""),e?c.popupwrapper.removeClass("sm-popupwrapper-hidden").hide().fadeIn(200,function(){c.popuppanel=a}):(d&&d.element.detach(),c.popupwrapper.removeClass("sm-popupwrapper-hidden"),c.popuppanel=a)},c.hidePopupPanel=function(a){if(a||(a={}),c.isAnimating)return!1;var b=c.popuppanel;return b?(b&&b.element.detach(),b&&b.element.addClass("sm-panel-hidden").removeClass("sm-panel-popup"),b&&b.element.css({width:"",left:"",right:""}),c.popuppanel=null,c.popuptitle.empty(),c.popupwrapper.css("display",""),void c.popupwrapper.addClass("sm-popupwrapper-hidden")):!1},c.toggleSetupMenu=function(){c.toggleTopPanel("skuidmobilesetupmenu",{transition:"slide"}),c.processResponsiveArea(c.panelMap.skuidmobilesetupmenu.element)},c.addTransition=function(a,b){a.removeClass(function(a,b){return(b.match(/\bsm-transition-\S+/g)||[]).join(" ")}),a.addClass("sm-transition-"+b)},c.processStylesNode=d.processStylesNode,c.processInteractionsNode=f.processInteractionsNode,c.processInteraction=f.processInteractionNode,c.runActionsNode=e.runActionsNode,c.runAction=e.runActionNode,e.register({setLeftPanel:function(a){c.setLeftPanel(a.attr("panel"),{transition:"slide"})},hideLeftPanel:function(){c.hideLeftPanel({transition:"slide"})},toggleLeftPanel:function(a){c.toggleLeftPanel(a.attr("panel"),{transition:"slide",position:a.attr("position"),replace:"true"===a.attr("replace")})},toggleSetupMenu:function(){c.toggleSetupMenu()},setMainPanel:function(b){a.mobile.setMainPanel(b.attr("panel"))},setPopupPanel:function(a,b,e){c.setPopupPanel(a.attr("panel"),{transition:"slideleft",title:d.mergeAsTextInContext(a.attr("title"),d.getContextToUse(b,e))})},hidePopupPanel:function(){c.hidePopupPanel()}})}(skuid),function(a){function b(a){this.options=a||{},this.element=a.element||c("<div>");var b=c("<div>").addClass("sm-button-inner");this.element.addClass("list"===a.style?"sm-liststyle":"sm-navstyle"),a.icon&&(this.icon=c("<i>").addClass("sm-button-icon fa "+a.icon+" fa-fw fa-1x"),a.iconColor&&this.icon.css("color",a.iconColor)),a.label&&(this.text=c("<div>").addClass("sm-button-text").text(a.label)),a.buttonset&&this.element.addClass("sm-buttonset-"+a.buttonset),this.icon&&b.append(this.icon),this.text&&b.append(this.text),this.element.append(b),a.tooltip&&this.setTooltip(a.tooltip)}var c=a.$;b.prototype={setTooltip:function(a){var b,c,d=this.element;return d&&(c=d.children(".sm-button-inner"),b=a||this.options.tooltip,b?c.skootip(b):c.tooltip("instance")&&c.tooltip("destroy")),this},startProcessing:function(){this.icon&&this.icon.addClass("fa-refresh fa-spin"),this.element.addClass("sm-processing"),this.icon&&this.icon.removeClass(this.options.icon)},stopProcessing:function(){this.icon&&this.icon.addClass(this.options.icon),this.element.removeClass("sm-processing"),this.icon&&this.icon.removeClass("fa-refresh fa-spin")},enable:function(){var a=this;a.element&&(a.element.removeClass("ui-state-disabled"),a.setTooltip())},disable:function(a){var b=this;b.element&&(b.element.addClass("ui-state-disabled"),a&&a.message&&b.setTooltip(a.message))}},a.mobile.ui={Button:b}}(skuid);